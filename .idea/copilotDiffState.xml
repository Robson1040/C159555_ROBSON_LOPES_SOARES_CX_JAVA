<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/docs/DOCUMENTACAO_AUTENTICACAO.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/docs/DOCUMENTACAO_AUTENTICACAO.md" />
              <option name="originalContent" value="# Documentação da API - AutenticacaoResource&#10;&#10;## Visão Geral&#10;&#10;O `AutenticacaoResource` é responsável por gerenciar a autenticação de usuários na API de Investimentos Caixa. Atualmente possui apenas um endpoint para login de usuários.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. POST /entrar&#10;**Realiza login de usuário no sistema**&#10;&#10;#### Descrição&#10;Autentica um usuário através de username e password, retornando um token JWT válido por 1 hora com as informações do usuário autenticado.&#10;&#10;#### Autenticação&#10;- **Token JWT:** NÃO OBRIGATÓRIO&#10;- **Roles permitidas:** `@PermitAll` (acesso público)&#10;&#10;#### Request&#10;&#10;**URL:** `POST /entrar`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Content-Type: application/json&#10;```&#10;&#10;**Body (JSON):**&#10;```json&#10;{&#10;  &quot;username&quot;: &quot;string&quot;,&#10;  &quot;password&quot;: &quot;string&quot;&#10;}&#10;```&#10;&#10;**Campos do Request:**&#10;&#10;| Campo | Tipo | Obrigatório | Validação | Descrição |&#10;|-------|------|-------------|-----------|-----------|&#10;| `username` | string | Sim | `@NotBlank` | Nome de usuário para autenticação |&#10;| `password` | string | Sim | `@NotBlank` | Senha do usuário |&#10;&#10;**Exemplo de Request:**&#10;```json&#10;{&#10;  &quot;username&quot;: &quot;joao123&quot;,&#10;  &quot;password&quot;: &quot;minhasenha123&quot;&#10;}&#10;```&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Login realizado com sucesso&#10;&#10;**Descrição:** Usuário autenticado com sucesso. Retorna token JWT válido.&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;token&quot;: &quot;string&quot;,&#10;  &quot;tipo&quot;: &quot;Bearer&quot;,&#10;  &quot;expira_em&quot;: &quot;2025-11-15T15:30:00&quot;,&#10;  &quot;usuario&quot;: &quot;string&quot;, &#10;  &quot;role&quot;: &quot;string&quot;&#10;}&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `token` | string | Token JWT para autenticação em endpoints protegidos |&#10;| `tipo` | string | Tipo do token (sempre &quot;Bearer&quot;) |&#10;| `expira_em` | datetime | Data e hora de expiração do token (1 hora após criação) |&#10;| `usuario` | string | Username do usuário autenticado |&#10;| `role` | string | Role do usuário (&quot;USER&quot; ou &quot;ADMIN&quot;) |&#10;&#10;**Exemplo de Response 200:**&#10;```json&#10;{&#10;  &quot;token&quot;: &quot;eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhcGktaW52ZXN0aW1lbnRvcy1jYWl4YSIsInN1YiI6ImpvYW8xMjMiLCJncm91cHMiOlsiVVNFUiJdLCJub21lIjoiSm9hbyBTaWx2YSIsImNwZiI6IjEyMzQ1Njc4OTAwIiwidXNlcklkIjoxLCJleHAiOjE3MDE3ODk2MDB9.signature&quot;,&#10;  &quot;tipo&quot;: &quot;Bearer&quot;,&#10;  &quot;expira_em&quot;: &quot;2025-11-15T15:30:00&quot;,&#10;  &quot;usuario&quot;: &quot;joao123&quot;,&#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;##### ❌ 400 - Bad Request&#10;&#10;**Descrição:** Dados de entrada inválidos ou malformados.&#10;&#10;**Possíveis causas:**&#10;- Campos obrigatórios não informados&#10;- JSON malformado&#10;- Validação `@NotBlank` falhou&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;string&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#10;  &quot;errors&quot;: [&quot;string&quot;]&#10;}&#10;```&#10;&#10;**Exemplo de Response 400:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados de entrada inválidos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Username é obrigatório&quot;,&#10;    &quot;Password é obrigatório&quot;&#10;  ]&#10;}&#10;```&#10;&#10;---&#10;&#10;##### ❌ 401 - Unauthorized&#10;&#10;**Descrição:** Credenciais inválidas (username ou password incorretos).&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Credenciais inválidas&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;, &#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;**Exemplo de Response 401:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Credenciais inválidas&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;##### ❌ 500 - Internal Server Error&#10;&#10;**Descrição:** Erro interno do servidor durante o processamento.&#10;&#10;**Possíveis causas:**&#10;- Falha na conexão com banco de dados&#10;- Erro no serviço de geração de token&#10;- Erro não tratado na aplicação&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: {detalhes do erro}&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/entrar&quot;, &#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;**Exemplo de Response 500:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Falha na conexão com o banco de dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Informações Técnicas&#10;&#10;### Token JWT&#10;&#10;O token JWT gerado contém as seguintes informações:&#10;&#10;**Claims padrão:**&#10;- `iss` (issuer): &quot;api-investimentos-caixa&quot;&#10;- `sub` (subject): username do usuário&#10;- `groups`: array com a role do usuário&#10;- `exp` (expiration): timestamp de expiração (1 hora)&#10;&#10;**Claims customizados:**&#10;- `nome`: nome completo do usuário&#10;- `cpf`: CPF do usuário&#10;- `userId`: ID único do usuário no sistema&#10;&#10;**Exemplo de payload decodificado:**&#10;```json&#10;{&#10;  &quot;iss&quot;: &quot;api-investimentos-caixa&quot;,&#10;  &quot;sub&quot;: &quot;joao123&quot;, &#10;  &quot;groups&quot;: [&quot;USER&quot;],&#10;  &quot;nome&quot;: &quot;João Silva&quot;,&#10;  &quot;cpf&quot;: &quot;12345678900&quot;,&#10;  &quot;userId&quot;: 1,&#10;  &quot;exp&quot;: 1701789600&#10;}&#10;```&#10;&#10;### Uso do Token&#10;&#10;Para usar o token em endpoints protegidos, inclua no header:&#10;```&#10;Authorization: Bearer {token}&#10;```&#10;&#10;### Roles Disponíveis&#10;&#10;- **USER**: Usuário comum (pode acessar seus próprios dados)&#10;- **ADMIN**: Administrador (acesso completo ao sistema)&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Login bem-sucedido:**&#10;```bash&#10;curl -X POST http://localhost:9090/entrar \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;username&quot;: &quot;joao123&quot;,&#10;    &quot;password&quot;: &quot;minhasenha123&quot;&#10;  }'&#10;```&#10;&#10;**Login com credenciais inválidas:**&#10;```bash&#10;curl -X POST http://localhost:9090/entrar \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;username&quot;: &quot;usuario_inexistente&quot;, &#10;    &quot;password&quot;: &quot;senha_errada&quot;&#10;  }'&#10;```&#10;&#10;---&#10;&#10;## Considerações de Segurança&#10;&#10;1. **Criptografia de Senhas**: As senhas são criptografadas no banco usando BCrypt&#10;2. **Validação de Token**: Tokens são assinados com chave RSA privada&#10;3. **Expiração**: Tokens expiram em 1 hora para limitar janela de exposição&#10;4. **Não exposição**: Senhas nunca são retornadas nas responses&#10;5. **Rate Limiting**: Considere implementar rate limiting para prevenir ataques de força bruta&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Possíveis&#10;&#10;| Status | Nome | Descrição | Quando Ocorre |&#10;|--------|------|-----------|---------------|&#10;| **200** | OK | Sucesso | Login realizado com sucesso |&#10;| **400** | Bad Request | Dados inválidos | JSON malformado, validações falharam |&#10;| **401** | Unauthorized | Não autorizado | Credenciais inválidas |&#10;| **500** | Internal Server Error | Erro interno | Falha no servidor/banco |&#10;&#10;### Mensagens de Erro por Categoria&#10;&#10;####  Erros de Validação (400)&#10;**Campos obrigatórios:**&#10;- `&quot;Username é obrigatório&quot;`&#10;- `&quot;Password é obrigatório&quot;`&#10;&#10;**Formato JSON:**&#10;- `&quot;Dados da requisição inválidos: formato JSON incorreto&quot;`&#10;- `&quot;Formato JSON inválido&quot;`&#10;&#10;**Mensagem genérica de validação:**&#10;- `&quot;Dados inválidos fornecidos&quot;`&#10;&#10;####  Erros de Autenticação (401)&#10;**Credenciais inválidas:**&#10;- `&quot;Credenciais inválidas&quot;` (username não existe ou senha incorreta)&#10;&#10;####  Erros Internos (500)&#10;**Falhas do sistema:**&#10;- `&quot;Erro interno do servidor: {detalhes específicos do erro}&quot;`&#10;- `&quot;Erro interno do servidor: Falha na conexão com o banco de dados&quot;`&#10;- `&quot;Erro interno do servidor: Falha na geração do token JWT&quot;`&#10;&#10;### Estrutura Completa das Respostas de Erro&#10;&#10;Todas as respostas de erro seguem o padrão:&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Mensagem principal do erro&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#10;  &quot;errors&quot;: [&quot;Lista de erros específicos (opcional)&quot;]&#10;}&#10;```&#10;&#10;### Exemplos Detalhados por Cenário&#10;&#10;#### ❌ 400 - Campos Obrigatórios Ausentes&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'username': Username é obrigatório (valor fornecido: null)&quot;,&#10;    &quot;Campo 'password': Password é obrigatório (valor fornecido: null)&quot;&#10;  ]&#10;}&#10;```&#10;&#10;#### ❌ 400 - JSON Malformado&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Formato JSON inválido&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 401 - Username Não Existe&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Credenciais inválidas&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 401 - Senha Incorreta&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Credenciais inválidas&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 500 - Falha no Banco de Dados&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Connection refused to database&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 500 - Falha na Geração do Token&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Private key not found for JWT signing&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/entrar&quot;, &#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---" />
              <option name="updatedContent" value="# Documentação da API - AutenticacaoResource&#13;&#10;&#13;&#10;## Visão Geral&#13;&#10;&#13;&#10;O `AutenticacaoResource` é responsável por gerenciar a autenticação de usuários na API de Investimentos Caixa. Atualmente possui apenas um endpoint para login de usuários.&#13;&#10;&#13;&#10;**Servidor:** `http://localhost:9090`&#13;&#10;&#13;&#10;**Base Path:** `/`&#13;&#10;&#13;&#10;**Formatos suportados:**&#13;&#10;- Content-Type: `application/json`&#13;&#10;- Accept: `application/json`&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Endpoints&#13;&#10;&#13;&#10;### 1. POST /entrar&#10;**Realiza login de usuário no sistema**&#10;&#10;`http://localhost:9090/entrar`&#13;&#10;&#13;&#10;#### Descrição&#13;&#10;Autentica um usuário através de username e password, retornando um token JWT válido por 1 hora com as informações do usuário autenticado.&#13;&#10;&#13;&#10;#### Autenticação&#13;&#10;- **Token JWT:** NÃO OBRIGATÓRIO&#13;&#10;- **Roles permitidas:** `@PermitAll` (acesso público)&#13;&#10;&#13;&#10;#### Request&#13;&#10;&#13;&#10;**URL:** `POST /entrar`&#13;&#10;&#13;&#10;**Headers obrigatórios:**&#13;&#10;```&#13;&#10;Content-Type: application/json&#13;&#10;```&#13;&#10;&#13;&#10;**Body (JSON):**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;username&quot;: &quot;string&quot;,&#13;&#10;  &quot;password&quot;: &quot;string&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Campos do Request:**&#13;&#10;&#13;&#10;| Campo | Tipo | Obrigatório | Validação | Descrição |&#13;&#10;|-------|------|-------------|-----------|-----------|&#13;&#10;| `username` | string | Sim | `@NotBlank` | Nome de usuário para autenticação |&#13;&#10;| `password` | string | Sim | `@NotBlank` | Senha do usuário |&#13;&#10;&#13;&#10;**Exemplo de Request:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;username&quot;: &quot;joao123&quot;,&#13;&#10;  &quot;password&quot;: &quot;minhasenha123&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;#### Responses&#13;&#10;&#13;&#10;##### ✅ 200 - Login realizado com sucesso&#13;&#10;&#13;&#10;**Descrição:** Usuário autenticado com sucesso. Retorna token JWT válido.&#13;&#10;&#13;&#10;**Response Body:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;token&quot;: &quot;string&quot;,&#13;&#10;  &quot;tipo&quot;: &quot;Bearer&quot;,&#13;&#10;  &quot;expira_em&quot;: &quot;2025-11-15T15:30:00&quot;,&#13;&#10;  &quot;usuario&quot;: &quot;string&quot;, &#13;&#10;  &quot;role&quot;: &quot;string&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Campos da Response:**&#13;&#10;&#13;&#10;| Campo | Tipo | Descrição |&#13;&#10;|-------|------|-----------|&#13;&#10;| `token` | string | Token JWT para autenticação em endpoints protegidos |&#13;&#10;| `tipo` | string | Tipo do token (sempre &quot;Bearer&quot;) |&#13;&#10;| `expira_em` | datetime | Data e hora de expiração do token (1 hora após criação) |&#13;&#10;| `usuario` | string | Username do usuário autenticado |&#13;&#10;| `role` | string | Role do usuário (&quot;USER&quot; ou &quot;ADMIN&quot;) |&#13;&#10;&#13;&#10;**Exemplo de Response 200:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;token&quot;: &quot;eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhcGktaW52ZXN0aW1lbnRvcy1jYWl4YSIsInN1YiI6ImpvYW8xMjMiLCJncm91cHMiOlsiVVNFUiJdLCJub21lIjoiSm9hbyBTaWx2YSIsImNwZiI6IjEyMzQ1Njc4OTAwIiwidXNlcklkIjoxLCJleHAiOjE3MDE3ODk2MDB9.signature&quot;,&#13;&#10;  &quot;tipo&quot;: &quot;Bearer&quot;,&#13;&#10;  &quot;expira_em&quot;: &quot;2025-11-15T15:30:00&quot;,&#13;&#10;  &quot;usuario&quot;: &quot;joao123&quot;,&#13;&#10;  &quot;role&quot;: &quot;USER&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;##### ❌ 400 - Bad Request&#13;&#10;&#13;&#10;**Descrição:** Dados de entrada inválidos ou malformados.&#13;&#10;&#13;&#10;**Possíveis causas:**&#13;&#10;- Campos obrigatórios não informados&#13;&#10;- JSON malformado&#13;&#10;- Validação `@NotBlank` falhou&#13;&#10;&#13;&#10;**Response Body:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;string&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 400,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#13;&#10;  &quot;errors&quot;: [&quot;string&quot;]&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Exemplo de Response 400:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Dados de entrada inválidos&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 400,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#13;&#10;  &quot;errors&quot;: [&#13;&#10;    &quot;Username é obrigatório&quot;,&#13;&#10;    &quot;Password é obrigatório&quot;&#13;&#10;  ]&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;##### ❌ 401 - Unauthorized&#13;&#10;&#13;&#10;**Descrição:** Credenciais inválidas (username ou password incorretos).&#13;&#10;&#13;&#10;**Response Body:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Credenciais inválidas&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;, &#13;&#10;  &quot;status&quot;: 401,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Exemplo de Response 401:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Credenciais inválidas&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 401,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;##### ❌ 500 - Internal Server Error&#13;&#10;&#13;&#10;**Descrição:** Erro interno do servidor durante o processamento.&#13;&#10;&#13;&#10;**Possíveis causas:**&#13;&#10;- Falha na conexão com banco de dados&#13;&#10;- Erro no serviço de geração de token&#13;&#10;- Erro não tratado na aplicação&#13;&#10;&#13;&#10;**Response Body:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Erro interno do servidor: {detalhes do erro}&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 500,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;, &#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Exemplo de Response 500:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Falha na conexão com o banco de dados&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 500,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Informações Técnicas&#13;&#10;&#13;&#10;### Token JWT&#13;&#10;&#13;&#10;O token JWT gerado contém as seguintes informações:&#13;&#10;&#13;&#10;**Claims padrão:**&#13;&#10;- `iss` (issuer): &quot;api-investimentos-caixa&quot;&#13;&#10;- `sub` (subject): username do usuário&#13;&#10;- `groups`: array com a role do usuário&#13;&#10;- `exp` (expiration): timestamp de expiração (1 hora)&#13;&#10;&#13;&#10;**Claims customizados:**&#13;&#10;- `nome`: nome completo do usuário&#13;&#10;- `cpf`: CPF do usuário&#13;&#10;- `userId`: ID único do usuário no sistema&#13;&#10;&#13;&#10;**Exemplo de payload decodificado:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;iss&quot;: &quot;api-investimentos-caixa&quot;,&#13;&#10;  &quot;sub&quot;: &quot;joao123&quot;, &#13;&#10;  &quot;groups&quot;: [&quot;USER&quot;],&#13;&#10;  &quot;nome&quot;: &quot;João Silva&quot;,&#13;&#10;  &quot;cpf&quot;: &quot;12345678900&quot;,&#13;&#10;  &quot;userId&quot;: 1,&#13;&#10;  &quot;exp&quot;: 1701789600&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;### Uso do Token&#13;&#10;&#13;&#10;Para usar o token em endpoints protegidos, inclua no header:&#13;&#10;```&#13;&#10;Authorization: Bearer {token}&#13;&#10;```&#13;&#10;&#13;&#10;### Roles Disponíveis&#13;&#10;&#13;&#10;- **USER**: Usuário comum (pode acessar seus próprios dados)&#13;&#10;- **ADMIN**: Administrador (acesso completo ao sistema)&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Exemplos de Uso&#13;&#10;&#13;&#10;### cURL&#13;&#10;&#13;&#10;**Login bem-sucedido:**&#13;&#10;```bash&#13;&#10;curl -X POST http://localhost:9090/entrar \&#13;&#10;  -H &quot;Content-Type: application/json&quot; \&#13;&#10;  -d '{&#13;&#10;    &quot;username&quot;: &quot;joao123&quot;,&#13;&#10;    &quot;password&quot;: &quot;minhasenha123&quot;&#13;&#10;  }'&#13;&#10;```&#13;&#10;&#13;&#10;**Login com credenciais inválidas:**&#13;&#10;```bash&#13;&#10;curl -X POST http://localhost:9090/entrar \&#13;&#10;  -H &quot;Content-Type: application/json&quot; \&#13;&#10;  -d '{&#13;&#10;    &quot;username&quot;: &quot;usuario_inexistente&quot;, &#13;&#10;    &quot;password&quot;: &quot;senha_errada&quot;&#13;&#10;  }'&#13;&#10;```&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Considerações de Segurança&#13;&#10;&#13;&#10;1. **Criptografia de Senhas**: As senhas são criptografadas no banco usando BCrypt&#13;&#10;2. **Validação de Token**: Tokens são assinados com chave RSA privada&#13;&#10;3. **Expiração**: Tokens expiram em 1 hora para limitar janela de exposição&#13;&#10;4. **Não exposição**: Senhas nunca são retornadas nas responses&#13;&#10;5. **Rate Limiting**: Considere implementar rate limiting para prevenir ataques de força bruta&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#13;&#10;&#13;&#10;### Status Codes Possíveis&#13;&#10;&#13;&#10;| Status | Nome | Descrição | Quando Ocorre |&#13;&#10;|--------|------|-----------|---------------|&#13;&#10;| **200** | OK | Sucesso | Login realizado com sucesso |&#13;&#10;| **400** | Bad Request | Dados inválidos | JSON malformado, validações falharam |&#13;&#10;| **401** | Unauthorized | Não autorizado | Credenciais inválidas |&#13;&#10;| **500** | Internal Server Error | Erro interno | Falha no servidor/banco |&#13;&#10;&#13;&#10;### Mensagens de Erro por Categoria&#13;&#10;&#13;&#10;####  Erros de Validação (400)&#13;&#10;**Campos obrigatórios:**&#13;&#10;- `&quot;Username é obrigatório&quot;`&#13;&#10;- `&quot;Password é obrigatório&quot;`&#13;&#10;&#13;&#10;**Formato JSON:**&#13;&#10;- `&quot;Dados da requisição inválidos: formato JSON incorreto&quot;`&#13;&#10;- `&quot;Formato JSON inválido&quot;`&#13;&#10;&#13;&#10;**Mensagem genérica de validação:**&#13;&#10;- `&quot;Dados inválidos fornecidos&quot;`&#13;&#10;&#13;&#10;####  Erros de Autenticação (401)&#13;&#10;**Credenciais inválidas:**&#13;&#10;- `&quot;Credenciais inválidas&quot;` (username não existe ou senha incorreta)&#13;&#10;&#13;&#10;####  Erros Internos (500)&#13;&#10;**Falhas do sistema:**&#13;&#10;- `&quot;Erro interno do servidor: {detalhes específicos do erro}&quot;`&#13;&#10;- `&quot;Erro interno do servidor: Falha na conexão com o banco de dados&quot;`&#13;&#10;- `&quot;Erro interno do servidor: Falha na geração do token JWT&quot;`&#13;&#10;&#13;&#10;### Estrutura Completa das Respostas de Erro&#13;&#10;&#13;&#10;Todas as respostas de erro seguem o padrão:&#13;&#10;&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Mensagem principal do erro&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 400,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#13;&#10;  &quot;errors&quot;: [&quot;Lista de erros específicos (opcional)&quot;]&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;### Exemplos Detalhados por Cenário&#13;&#10;&#13;&#10;#### ❌ 400 - Campos Obrigatórios Ausentes&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 400,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#13;&#10;  &quot;errors&quot;: [&#13;&#10;    &quot;Campo 'username': Username é obrigatório (valor fornecido: null)&quot;,&#13;&#10;    &quot;Campo 'password': Password é obrigatório (valor fornecido: null)&quot;&#13;&#10;  ]&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;#### ❌ 400 - JSON Malformado&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Formato JSON inválido&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 400,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;#### ❌ 401 - Username Não Existe&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Credenciais inválidas&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 401,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;#### ❌ 401 - Senha Incorreta&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Credenciais inválidas&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 401,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;#### ❌ 500 - Falha no Banco de Dados&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Connection refused to database&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 500,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;#### ❌ 500 - Falha na Geração do Token&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Private key not found for JWT signing&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 500,&#13;&#10;  &quot;path&quot;: &quot;/entrar&quot;, &#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;---" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/docs/DOCUMENTACAO_CLIENTE.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/docs/DOCUMENTACAO_CLIENTE.md" />
              <option name="originalContent" value="# Documentação da API - ClienteResource&#10;&#10;## Visão Geral&#10;&#10;O `ClienteResource` é responsável por gerenciar operações CRUD (Create, Read, Update, Delete) de clientes na API de Investimentos Caixa. Oferece endpoints para criação, listagem, busca e atualização de clientes com controle de acesso baseado em roles.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/clientes`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. GET /clientes&#10;**Lista todos os clientes do sistema**&#10;&#10;#### Descrição&#10;Retorna uma lista completa de todos os clientes cadastrados no sistema. Endpoint restrito apenas para administradores.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /clientes`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Sem body**&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Lista recuperada com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 1,&#10;    &quot;nome&quot;: &quot;João Silva&quot;,&#10;    &quot;cpf&quot;: &quot;12345678900&quot;, &#10;    &quot;username&quot;: &quot;joao123&quot;,&#10;    &quot;role&quot;: &quot;USER&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 2,&#10;    &quot;nome&quot;: &quot;Maria Santos&quot;,&#10;    &quot;cpf&quot;: &quot;98765432100&quot;,&#10;    &quot;username&quot;: &quot;maria456&quot;, &#10;    &quot;role&quot;: &quot;ADMIN&quot;&#10;  }&#10;]&#10;```&#10;&#10;---&#10;&#10;### 2. GET /clientes/{id}&#10;**Busca cliente por ID**&#10;&#10;#### Descrição&#10;Retorna os dados de um cliente específico pelo ID. ADMINs podem buscar qualquer cliente, USERs só podem buscar seus próprios dados.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Autorização:** USERs só podem acessar seus próprios dados (validado via JWT)&#10;&#10;#### Request&#10;&#10;**URL:** `GET /clientes/{id}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Descrição |&#10;|-----------|------|-------------|-----------|&#10;| `id` | Long | Sim | ID único do cliente |&#10;&#10;**Exemplo:** `GET /clientes/1`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Cliente encontrado&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 1,&#10;  &quot;nome&quot;: &quot;João Silva&quot;,&#10;  &quot;cpf&quot;: &quot;12345678900&quot;,&#10;  &quot;username&quot;: &quot;joao123&quot;, &#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 3. POST /clientes&#10;**Cria um novo cliente**&#10;&#10;#### Descrição&#10;Cadastra um novo cliente no sistema. Endpoint público para permitir auto-registro de usuários.&#10;&#10;#### Autenticação&#10;- **Token JWT:** NÃO OBRIGATÓRIO&#10;- **Roles permitidas:** `@PermitAll` (acesso público)&#10;&#10;#### Request&#10;&#10;**URL:** `POST /clientes`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Content-Type: application/json&#10;```&#10;&#10;**Body (JSON):**&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;string&quot;,&#10;  &quot;cpf&quot;: &quot;string&quot;, &#10;  &quot;username&quot;: &quot;string&quot;,&#10;  &quot;password&quot;: &quot;string&quot;,&#10;  &quot;role&quot;: &quot;string&quot;&#10;}&#10;```&#10;&#10;**Campos do Request:**&#10;&#10;| Campo | Tipo | Obrigatório | Validação | Descrição |&#10;|-------|------|-------------|-----------|-----------|&#10;| `nome` | string | Sim | `@NotBlank`, `@Size(min=2, max=100)` | Nome completo do cliente |&#10;| `cpf` | string | Sim | `@NotBlank`, `@ValidCPF` | CPF válido (11 dígitos) |&#10;| `username` | string | Sim | `@NotBlank`, `@Size(min=3, max=50)` | Nome de usuário único |&#10;| `password` | string | Sim | `@NotBlank`, `@Size(min=6)` | Senha (mínimo 6 caracteres) |&#10;| `role` | string | Sim | `@NotBlank`, `@Pattern(USER\|ADMIN)` | Role do usuário |&#10;&#10;**Exemplo de Request:**&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;João Silva Santos&quot;,&#10;  &quot;cpf&quot;: &quot;12345678901&quot;,&#10;  &quot;username&quot;: &quot;joao_silva&quot;,&#10;  &quot;password&quot;: &quot;minhasenha123&quot;,&#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;#### Responses&#10;&#10;##### ✅ 201 - Cliente criado com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 1,&#10;  &quot;nome&quot;: &quot;João Silva Santos&quot;,&#10;  &quot;cpf&quot;: &quot;12345678901&quot;,&#10;  &quot;username&quot;: &quot;joao_silva&quot;,&#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 4. PUT /clientes/{id}&#10;**Atualiza um cliente existente**&#10;&#10;#### Descrição&#10;Atualiza os dados de um cliente específico. USERs só podem atualizar seus próprios dados, ADMINs podem atualizar qualquer cliente.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Autorização:** USERs só podem atualizar seus próprios dados (validado via JWT)&#10;&#10;#### Request&#10;&#10;**URL:** `PUT /clientes/{id}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Descrição |&#10;|-----------|------|-------------|-----------|&#10;| `id` | Long | Sim | ID único do cliente a ser atualizado |&#10;&#10;**Body (JSON):**&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;string&quot;,&#10;  &quot;username&quot;: &quot;string&quot;,&#10;  &quot;password&quot;: &quot;string&quot;&#10;}&#10;```&#10;&#10;**Campos do Request:**&#10;&#10;| Campo | Tipo | Obrigatório | Validação | Descrição |&#10;|-------|------|-------------|-----------|-----------|&#10;| `nome` | string | Não | `@Size(min=2, max=100)` | Nome completo do cliente |&#10;| `username` | string | Não | `@Size(min=3, max=50)` | Nome de usuário único |&#10;| `password` | string | Não | `@Size(min=6)` | Nova senha (mínimo 6 caracteres) |&#10;&#10;**Exemplo de Request:**&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;João Silva Santos Jr&quot;,&#10;  &quot;username&quot;: &quot;joao_silva_jr&quot;,&#10;  &quot;password&quot;: &quot;novasenha456&quot;&#10;}&#10;```&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Cliente atualizado com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 1,&#10;  &quot;nome&quot;: &quot;João Silva Santos Jr&quot;,&#10;  &quot;cpf&quot;: &quot;12345678901&quot;,&#10;  &quot;username&quot;: &quot;joao_silva_jr&quot;,&#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 5. GET /clientes/cpf/{cpf}&#10;**Busca cliente por CPF**&#10;&#10;#### Descrição&#10;Retorna os dados de um cliente específico pelo CPF. Endpoint restrito para administradores apenas.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /clientes/cpf/{cpf}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Descrição |&#10;|-----------|------|-------------|-----------|&#10;| `cpf` | string | Sim | CPF do cliente (11 dígitos) |&#10;&#10;**Exemplo:** `GET /clientes/cpf/12345678901`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Cliente encontrado&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 1,&#10;  &quot;nome&quot;: &quot;João Silva Santos&quot;,&#10;  &quot;cpf&quot;: &quot;12345678901&quot;,&#10;  &quot;username&quot;: &quot;joao_silva&quot;,&#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 6. GET /clientes/username/{username}&#10;**Busca cliente por username**&#10;&#10;#### Descrição&#10;Retorna os dados de um cliente específico pelo username. Endpoint restrito para administradores apenas.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /clientes/username/{username}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Descrição |&#10;|-----------|------|-------------|-----------|&#10;| `username` | string | Sim | Username único do cliente |&#10;&#10;**Exemplo:** `GET /clientes/username/joao_silva`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Cliente encontrado&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 1,&#10;  &quot;nome&quot;: &quot;João Silva Santos&quot;,&#10;  &quot;cpf&quot;: &quot;12345678901&quot;, &#10;  &quot;username&quot;: &quot;joao_silva&quot;,&#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;## Status Codes e Erros Comuns&#10;&#10;### ❌ 400 - Bad Request&#10;&#10;**Descrição:** Dados de entrada inválidos ou malformados.&#10;&#10;**Possíveis causas:**&#10;- Campos obrigatórios não informados&#10;- Validações falharam (tamanho, formato, etc.)&#10;- JSON malformado&#10;- CPF inválido&#10;- Role inválida (deve ser USER ou ADMIN)&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Nome é obrigatório&quot;,&#10;    &quot;CPF inválido&quot;,&#10;    &quot;Username deve ter entre 3 e 50 caracteres&quot;,&#10;    &quot;Password deve ter no mínimo 6 caracteres&quot;,&#10;    &quot;Role deve ser 'USER' ou 'ADMIN'&quot;&#10;  ]&#10;}&#10;```&#10;&#10;---&#10;&#10;### ❌ 401 - Unauthorized&#10;&#10;**Descrição:** Token JWT não fornecido ou inválido.&#10;&#10;**Possíveis causas:**&#10;- Header Authorization ausente&#10;- Token JWT expirado&#10;- Token JWT inválido ou malformado&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/clientes/1&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### ❌ 403 - Forbidden&#10;&#10;**Descrição:** Token válido mas sem permissão para a operação.&#10;&#10;**Possíveis causas:**&#10;- USER tentando acessar dados de outro cliente&#10;- USER tentando acessar endpoints de ADMIN&#10;- Falha na validação de autorização&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/clientes/2&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### ❌ 404 - Not Found&#10;&#10;**Descrição:** Cliente não encontrado.&#10;&#10;**Possíveis causas:**&#10;- ID de cliente inexistente&#10;- CPF não cadastrado no sistema&#10;- Username não encontrado&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Cliente não encontrado&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/clientes/999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### ❌ 409 - Conflict&#10;&#10;**Descrição:** Dados já existem no sistema.&#10;&#10;**Possíveis causas:**&#10;- CPF já cadastrado&#10;- Username já existe&#10;- Tentativa de duplicação de dados únicos&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;CPF ou username já cadastrado no sistema&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 409,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### ❌ 500 - Internal Server Error&#10;&#10;**Descrição:** Erro interno do servidor.&#10;&#10;**Possíveis causas:**&#10;- Falha na conexão com banco de dados&#10;- Erro não tratado na aplicação&#10;- Falha na criptografia de senhas&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: {detalhes do erro}&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Matriz de Autorização&#10;&#10;| Endpoint | Método | ADMIN | USER | Público | Observações |&#10;|----------|--------|-------|------|---------|-------------|&#10;| `/clientes` | GET | ✅ | ❌ | ❌ | Lista todos os clientes |&#10;| `/clientes/{id}` | GET | ✅ | ✅* | ❌ | *USER só seus próprios dados |&#10;| `/clientes` | POST | ✅ | ✅ | ✅ | Criação de conta é pública |&#10;| `/clientes/{id}` | PUT | ✅ | ✅* | ❌ | *USER só seus próprios dados |&#10;| `/clientes/cpf/{cpf}` | GET | ✅ | ❌ | ❌ | Busca por CPF - Admin apenas |&#10;| `/clientes/username/{username}` | GET | ✅ | ❌ | ❌ | Busca por username - Admin apenas |&#10;&#10;---&#10;&#10;## Informações Técnicas&#10;&#10;### Estrutura do Token JWT&#10;&#10;Para endpoints que exigem autenticação, o token deve conter:&#10;&#10;**Claims obrigatórios:**&#10;- `groups`: array com roles do usuário&#10;- `userId`: ID do usuário no sistema&#10;&#10;**Exemplo de uso do token:**&#10;```&#10;Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...&#10;```&#10;&#10;### Validação de CPF&#10;&#10;A aplicação utiliza validação customizada de CPF que verifica:&#10;- Formato (11 dígitos)&#10;- Algoritmo de validação dos dígitos verificadores&#10;- Rejeita CPFs com todos os dígitos iguais (111.111.111-11, etc.)&#10;&#10;### Criptografia de Senhas&#10;&#10;- Senhas são criptografadas usando BCrypt antes do armazenamento&#10;- Senhas nunca são retornadas nas responses&#10;- Minimum de 6 caracteres obrigatório&#10;&#10;### Roles Disponíveis&#10;&#10;- **USER**: Usuário comum&#10;  - Pode criar conta própria&#10;  - Pode visualizar/atualizar apenas seus dados&#10;  - Acesso a funcionalidades básicas&#10;&#10;- **ADMIN**: Administrador&#10;  - Acesso total ao sistema&#10;  - Pode visualizar/gerenciar todos os clientes&#10;  - Pode buscar por CPF e username&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Criar novo cliente (público):**&#10;```bash&#10;curl -X POST http://localhost:9090/clientes \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;nome&quot;: &quot;João Silva&quot;,&#10;    &quot;cpf&quot;: &quot;12345678901&quot;,&#10;    &quot;username&quot;: &quot;joao123&quot;,&#10;    &quot;password&quot;: &quot;senha123&quot;,&#10;    &quot;role&quot;: &quot;USER&quot;&#10;  }'&#10;```&#10;&#10;**Listar todos os clientes (ADMIN):**&#10;```bash&#10;curl -X GET http://localhost:9090/clientes \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Buscar cliente por ID (autenticado):**&#10;```bash&#10;curl -X GET http://localhost:9090/clientes/1 \&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Atualizar dados do cliente:**&#10;```bash&#10;curl -X PUT http://localhost:9090/clientes/1 \&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;nome&quot;: &quot;João Silva Santos&quot;,&#10;    &quot;username&quot;: &quot;joao_atualizado&quot;&#10;  }'&#10;```&#10;&#10;---&#10;&#10;## Considerações de Segurança&#10;&#10;1. **Controle de Acesso**: Implementação rigorosa de RBAC (Role-Based Access Control)&#10;2. **Validação de Autorização**: USERs só acessam seus próprios dados&#10;3. **Validação de Dados**: Todas as entradas são validadas (Bean Validation)&#10;4. **Criptografia**: Senhas são hasheadas com BCrypt&#10;5. **Não Exposição**: Senhas nunca retornadas nas responses&#10;6. **Validação de CPF**: Validação algorítmica de CPF&#10;7. **JWT Security**: Tokens assinados e com expiração&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Possíveis&#10;&#10;| Status | Nome | Descrição | Endpoints Afetados |&#10;|--------|------|-----------|-------------------|&#10;| **200** | OK | Sucesso | GET, PUT |&#10;| **201** | Created | Recurso criado | POST |&#10;| **400** | Bad Request | Dados inválidos | Todos |&#10;| **401** | Unauthorized | Token inválido/ausente | Todos exceto POST /clientes |&#10;| **403** | Forbidden | Sem permissão | Todos autenticados |&#10;| **404** | Not Found | Recurso não encontrado | GET por ID, CPF, username |&#10;| **409** | Conflict | Dados duplicados | POST, PUT |&#10;| **500** | Internal Server Error | Erro interno | Todos |&#10;&#10;### Mensagens de Erro por Categoria&#10;&#10;####  Erros de Validação (400)&#10;&#10;**Campos obrigatórios (POST /clientes):**&#10;- `&quot;Nome é obrigatório&quot;`&#10;- `&quot;CPF é obrigatório&quot;`&#10;- `&quot;Username é obrigatório&quot;`&#10;- `&quot;Password é obrigatório&quot;`&#10;- `&quot;Role é obrigatório&quot;`&#10;&#10;**Validações de tamanho:**&#10;- `&quot;Nome deve ter entre 2 e 100 caracteres&quot;`&#10;- `&quot;Username deve ter entre 3 e 50 caracteres&quot;`&#10;- `&quot;Password deve ter no mínimo 6 caracteres&quot;`&#10;&#10;**Validações de formato:**&#10;- `&quot;CPF inválido&quot;` (validação customizada)&#10;- `&quot;Role deve ser 'USER' ou 'ADMIN'&quot;`&#10;- `&quot;CPF deve conter exatamente 11 dígitos&quot;`&#10;&#10;**Formato JSON:**&#10;- `&quot;Dados da requisição inválidos: formato JSON incorreto&quot;`&#10;- `&quot;Formato JSON inválido&quot;`&#10;&#10;**Mensagem genérica:**&#10;- `&quot;Dados inválidos fornecidos&quot;`&#10;&#10;####  Erros de Autenticação (401)&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#10;- `&quot;Token JWT não encontrado&quot;`&#10;&#10;####  Erros de Autorização (403)&#10;- `&quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;`&#10;- `&quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;`&#10;- `&quot;Acesso negado: role não autorizada&quot;`&#10;&#10;####  Erros de Recurso Não Encontrado (404)&#10;- `&quot;Cliente não encontrado&quot;`&#10;- `&quot;Cliente não encontrado com ID: {id}&quot;`&#10;- `&quot;Cliente não encontrado com CPF: {cpf}&quot;`&#10;- `&quot;Cliente não encontrado com username: {username}&quot;`&#10;&#10;####  Erros de Conflito (409)&#10;- `&quot;CPF já cadastrado no sistema&quot;`&#10;- `&quot;Username já existe&quot;`&#10;- `&quot;CPF ou username já cadastrado no sistema&quot;`&#10;&#10;####  Erros Internos (500)&#10;- `&quot;Erro interno do servidor: {detalhes específicos}&quot;`&#10;- `&quot;Erro interno do servidor: Falha na conexão com o banco de dados&quot;`&#10;- `&quot;Erro interno do servidor: Erro na criptografia da senha&quot;`&#10;&#10;### Estrutura Completa das Respostas de Erro&#10;&#10;Todas as respostas de erro seguem o padrão:&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Mensagem principal do erro&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: [&quot;Lista de erros específicos (opcional)&quot;]&#10;}&#10;```&#10;&#10;### Exemplos Detalhados por Cenário&#10;&#10;#### ❌ 400 - Múltiplas Validações Falharam (POST)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'nome': Nome é obrigatório (valor fornecido: null)&quot;,&#10;    &quot;Campo 'cpf': CPF inválido (valor fornecido: 12345)&quot;,&#10;    &quot;Campo 'username': Username deve ter entre 3 e 50 caracteres (valor fornecido: ab)&quot;,&#10;    &quot;Campo 'password': Password deve ter no mínimo 6 caracteres (valor fornecido: 123)&quot;,&#10;    &quot;Campo 'role': Role deve ser 'USER' ou 'ADMIN' (valor fornecido: CLIENTE)&quot;&#10;  ]&#10;}&#10;```&#10;&#10;#### ❌ 400 - CPF Inválido&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;, &#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'cpf': CPF inválido (valor fornecido: 11111111111)&quot;&#10;  ]&#10;}&#10;```&#10;&#10;#### ❌ 401 - Token Ausente&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 403 - USER Tentando Acessar Dados de Outro Cliente&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;, &#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/clientes/2&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 403 - USER Tentando Listar Todos os Clientes&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 404 - Cliente Não Encontrado por ID&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Cliente não encontrado&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/clientes/999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 404 - Cliente Não Encontrado por CPF&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Cliente não encontrado com CPF: 99999999999&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/clientes/cpf/99999999999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 409 - CPF Já Cadastrado&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;CPF já cadastrado no sistema&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 409,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 409 - Username Já Existe&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Username já existe&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 409,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 500 - Falha no Banco de Dados&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Connection timeout to database&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 500 - Falha na Criptografia&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Erro na criptografia da senha&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;### Mapeamento de Erros por Endpoint&#10;&#10;#### GET /clientes&#10;- **401**: Token ausente/inválido  &#10;- **403**: Não é ADMIN&#10;- **500**: Erro interno&#10;&#10;#### GET /clientes/{id}  &#10;- **401**: Token ausente/inválido&#10;- **403**: USER tentando acessar dados de outro cliente&#10;- **404**: Cliente não encontrado&#10;- **500**: Erro interno&#10;&#10;#### POST /clientes&#10;- **400**: Validações falharam, JSON malformado&#10;- **409**: CPF ou username já existem&#10;- **500**: Erro interno&#10;&#10;#### PUT /clientes/{id}&#10;- **400**: Validações falharam, JSON malformado&#10;- **401**: Token ausente/inválido&#10;- **403**: USER tentando atualizar dados de outro cliente&#10;- **404**: Cliente não encontrado&#10;- **409**: Username já existe (se tentando alterar)&#10;- **500**: Erro interno&#10;&#10;#### GET /clientes/cpf/{cpf}&#10;- **401**: Token ausente/inválido&#10;- **403**: Não é ADMIN&#10;- **404**: Cliente não encontrado&#10;- **500**: Erro interno&#10;&#10;#### GET /clientes/username/{username}&#10;- **401**: Token ausente/inválido&#10;- **403**: Não é ADMIN  &#10;- **404**: Cliente não encontrado&#10;- **500**: Erro interno&#10;&#10;---" />
              <option name="updatedContent" value="# Documentação da API - ClienteResource&#10;&#10;## Visão Geral&#10;&#10;O `ClienteResource` é responsável por gerenciar operações CRUD (Create, Read, Update, Delete) de clientes na API de Investimentos Caixa. Oferece endpoints para criação, listagem, busca e atualização de clientes com controle de acesso baseado em roles.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/clientes`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. GET /clientes&#10;**Lista todos os clientes do sistema**&#10;&#10;`http://localhost:9090/clientes`&#10;&#10;#### Descrição&#10;Retorna uma lista completa de todos os clientes cadastrados no sistema. Endpoint restrito apenas para administradores.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /clientes`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Sem body**&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Lista recuperada com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 1,&#10;    &quot;nome&quot;: &quot;João Silva&quot;,&#10;    &quot;cpf&quot;: &quot;12345678900&quot;, &#10;    &quot;username&quot;: &quot;joao123&quot;,&#10;    &quot;role&quot;: &quot;USER&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 2,&#10;    &quot;nome&quot;: &quot;Maria Santos&quot;,&#10;    &quot;cpf&quot;: &quot;98765432100&quot;,&#10;    &quot;username&quot;: &quot;maria456&quot;, &#10;    &quot;role&quot;: &quot;ADMIN&quot;&#10;  }&#10;]&#10;```&#10;&#10;---&#10;&#10;### 2. GET /clientes/{id}&#10;**Busca cliente por ID**&#10;&#10;`http://localhost:9090/clientes/{id}`&#10;&#10;#### Descrição&#10;Retorna os dados de um cliente específico pelo ID. ADMINs podem buscar qualquer cliente, USERs só podem buscar seus próprios dados.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Autorização:** USERs só podem acessar seus próprios dados (validado via JWT)&#10;&#10;#### Request&#10;&#10;**URL:** `GET /clientes/{id}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Descrição |&#10;|-----------|------|-------------|-----------|&#10;| `id` | Long | Sim | ID único do cliente |&#10;&#10;**Exemplo:** `GET /clientes/1`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Cliente encontrado&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 1,&#10;  &quot;nome&quot;: &quot;João Silva&quot;,&#10;  &quot;cpf&quot;: &quot;12345678900&quot;,&#10;  &quot;username&quot;: &quot;joao123&quot;, &#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 3. POST /clientes&#10;**Cria um novo cliente**&#10;&#10;`http://localhost:9090/clientes`&#10;&#10;#### Descrição&#10;Cadastra um novo cliente no sistema. Endpoint público para permitir auto-registro de usuários.&#10;&#10;#### Autenticação&#10;- **Token JWT:** NÃO OBRIGATÓRIO&#10;- **Roles permitidas:** `@PermitAll` (acesso público)&#10;&#10;#### Request&#10;&#10;**URL:** `POST /clientes`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Content-Type: application/json&#10;```&#10;&#10;**Body (JSON):**&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;string&quot;,&#10;  &quot;cpf&quot;: &quot;string&quot;, &#10;  &quot;username&quot;: &quot;string&quot;,&#10;  &quot;password&quot;: &quot;string&quot;,&#10;  &quot;role&quot;: &quot;string&quot;&#10;}&#10;```&#10;&#10;**Campos do Request:**&#10;&#10;| Campo | Tipo | Obrigatório | Validação | Descrição |&#10;|-------|------|-------------|-----------|-----------|&#10;| `nome` | string | Sim | `@NotBlank`, `@Size(min=2, max=100)` | Nome completo do cliente |&#10;| `cpf` | string | Sim | `@NotBlank`, `@ValidCPF` | CPF válido (11 dígitos) |&#10;| `username` | string | Sim | `@NotBlank`, `@Size(min=3, max=50)` | Nome de usuário único |&#10;| `password` | string | Sim | `@NotBlank`, `@Size(min=6)` | Senha (mínimo 6 caracteres) |&#10;| `role` | string | Sim | `@NotBlank`, `@Pattern(USER\|ADMIN)` | Role do usuário |&#10;&#10;**Exemplo de Request:**&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;João Silva Santos&quot;,&#10;  &quot;cpf&quot;: &quot;12345678901&quot;,&#10;  &quot;username&quot;: &quot;joao_silva&quot;,&#10;  &quot;password&quot;: &quot;minhasenha123&quot;,&#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;#### Responses&#10;&#10;##### ✅ 201 - Cliente criado com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 1,&#10;  &quot;nome&quot;: &quot;João Silva Santos&quot;,&#10;  &quot;cpf&quot;: &quot;12345678901&quot;,&#10;  &quot;username&quot;: &quot;joao_silva&quot;,&#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 4. PUT /clientes/{id}&#10;**Atualiza um cliente existente**&#10;&#10;`http://localhost:9090/clientes/{id}`&#10;&#10;#### Descrição&#10;Atualiza os dados de um cliente específico. USERs só podem atualizar seus próprios dados, ADMINs podem atualizar qualquer cliente.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Autorização:** USERs só podem atualizar seus próprios dados (validado via JWT)&#10;&#10;#### Request&#10;&#10;**URL:** `PUT /clientes/{id}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Descrição |&#10;|-----------|------|-------------|-----------|&#10;| `id` | Long | Sim | ID único do cliente a ser atualizado |&#10;&#10;**Body (JSON):**&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;string&quot;,&#10;  &quot;username&quot;: &quot;string&quot;,&#10;  &quot;password&quot;: &quot;string&quot;&#10;}&#10;```&#10;&#10;**Campos do Request:**&#10;&#10;| Campo | Tipo | Obrigatório | Validação | Descrição |&#10;|-------|------|-------------|-----------|-----------|&#10;| `nome` | string | Não | `@Size(min=2, max=100)` | Nome completo do cliente |&#10;| `username` | string | Não | `@Size(min=3, max=50)` | Nome de usuário único |&#10;| `password` | string | Não | `@Size(min=6)` | Nova senha (mínimo 6 caracteres) |&#10;&#10;**Exemplo de Request:**&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;João Silva Santos Jr&quot;,&#10;  &quot;username&quot;: &quot;joao_silva_jr&quot;,&#10;  &quot;password&quot;: &quot;novasenha456&quot;&#10;}&#10;```&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Cliente atualizado com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 1,&#10;  &quot;nome&quot;: &quot;João Silva Santos Jr&quot;,&#10;  &quot;cpf&quot;: &quot;12345678901&quot;,&#10;  &quot;username&quot;: &quot;joao_silva_jr&quot;,&#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 5. GET /clientes/cpf/{cpf}&#10;**Busca cliente por CPF**&#10;&#10;`http://localhost:9090/clientes/cpf/{cpf}`&#10;&#10;#### Descrição&#10;Retorna os dados de um cliente específico pelo CPF. Endpoint restrito para administradores apenas.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /clientes/cpf/{cpf}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Descrição |&#10;|-----------|------|-------------|-----------|&#10;| `cpf` | string | Sim | CPF do cliente (11 dígitos) |&#10;&#10;**Exemplo:** `GET /clientes/cpf/12345678901`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Cliente encontrado&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 1,&#10;  &quot;nome&quot;: &quot;João Silva Santos&quot;,&#10;  &quot;cpf&quot;: &quot;12345678901&quot;,&#10;  &quot;username&quot;: &quot;joao_silva&quot;,&#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 6. GET /clientes/username/{username}&#10;**Busca cliente por username**&#10;&#10;`http://localhost:9090/clientes/username/{username}`&#10;&#10;#### Descrição&#10;Retorna os dados de um cliente específico pelo username. Endpoint restrito para administradores apenas.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /clientes/username/{username}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Descrição |&#10;|-----------|------|-------------|-----------|&#10;| `username` | string | Sim | Username único do cliente |&#10;&#10;**Exemplo:** `GET /clientes/username/joao_silva`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Cliente encontrado&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 1,&#10;  &quot;nome&quot;: &quot;João Silva Santos&quot;,&#10;  &quot;cpf&quot;: &quot;12345678901&quot;, &#10;  &quot;username&quot;: &quot;joao_silva&quot;,&#10;  &quot;role&quot;: &quot;USER&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;## Status Codes e Erros Comuns&#10;&#10;### ❌ 400 - Bad Request&#10;&#10;**Descrição:** Dados de entrada inválidos ou malformados.&#10;&#10;**Possíveis causas:**&#10;- Campos obrigatórios não informados&#10;- Validações falharam (tamanho, formato, etc.)&#10;- JSON malformado&#10;- CPF inválido&#10;- Role inválida (deve ser USER ou ADMIN)&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Nome é obrigatório&quot;,&#10;    &quot;CPF inválido&quot;,&#10;    &quot;Username deve ter entre 3 e 50 caracteres&quot;,&#10;    &quot;Password deve ter no mínimo 6 caracteres&quot;,&#10;    &quot;Role deve ser 'USER' ou 'ADMIN'&quot;&#10;  ]&#10;}&#10;```&#10;&#10;---&#10;&#10;### ❌ 401 - Unauthorized&#10;&#10;**Descrição:** Token JWT não fornecido ou inválido.&#10;&#10;**Possíveis causas:**&#10;- Header Authorization ausente&#10;- Token JWT expirado&#10;- Token JWT inválido ou malformado&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/clientes/1&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### ❌ 403 - Forbidden&#10;&#10;**Descrição:** Token válido mas sem permissão para a operação.&#10;&#10;**Possíveis causas:**&#10;- USER tentando acessar dados de outro cliente&#10;- USER tentando acessar endpoints de ADMIN&#10;- Falha na validação de autorização&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/clientes/2&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### ❌ 404 - Not Found&#10;&#10;**Descrição:** Cliente não encontrado.&#10;&#10;**Possíveis causas:**&#10;- ID de cliente inexistente&#10;- CPF não cadastrado no sistema&#10;- Username não encontrado&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Cliente não encontrado&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/clientes/999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### ❌ 409 - Conflict&#10;&#10;**Descrição:** Dados já existem no sistema.&#10;&#10;**Possíveis causas:**&#10;- CPF já cadastrado&#10;- Username já existe&#10;- Tentativa de duplicação de dados únicos&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;CPF ou username já cadastrado no sistema&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 409,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### ❌ 500 - Internal Server Error&#10;&#10;**Descrição:** Erro interno do servidor.&#10;&#10;**Possíveis causas:**&#10;- Falha na conexão com banco de dados&#10;- Erro não tratado na aplicação&#10;- Falha na criptografia de senhas&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: {detalhes do erro}&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Matriz de Autorização&#10;&#10;| Endpoint | Método | ADMIN | USER | Público | Observações |&#10;|----------|--------|-------|------|---------|-------------|&#10;| `/clientes` | GET | ✅ | ❌ | ❌ | Lista todos os clientes |&#10;| `/clientes/{id}` | GET | ✅ | ✅* | ❌ | *USER só seus próprios dados |&#10;| `/clientes` | POST | ✅ | ✅ | ✅ | Criação de conta é pública |&#10;| `/clientes/{id}` | PUT | ✅ | ✅* | ❌ | *USER só seus próprios dados |&#10;| `/clientes/cpf/{cpf}` | GET | ✅ | ❌ | ❌ | Busca por CPF - Admin apenas |&#10;| `/clientes/username/{username}` | GET | ✅ | ❌ | ❌ | Busca por username - Admin apenas |&#10;&#10;---&#10;&#10;## Informações Técnicas&#10;&#10;### Estrutura do Token JWT&#10;&#10;Para endpoints que exigem autenticação, o token deve conter:&#10;&#10;**Claims obrigatórios:**&#10;- `groups`: array com roles do usuário&#10;- `userId`: ID do usuário no sistema&#10;&#10;**Exemplo de uso do token:**&#10;```&#10;Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...&#10;```&#10;&#10;### Validação de CPF&#10;&#10;A aplicação utiliza validação customizada de CPF que verifica:&#10;- Formato (11 dígitos)&#10;- Algoritmo de validação dos dígitos verificadores&#10;- Rejeita CPFs com todos os dígitos iguais (111.111.111-11, etc.)&#10;&#10;### Criptografia de Senhas&#10;&#10;- Senhas são criptografadas usando BCrypt antes do armazenamento&#10;- Senhas nunca são retornadas nas responses&#10;- Minimum de 6 caracteres obrigatório&#10;&#10;### Roles Disponíveis&#10;&#10;- **USER**: Usuário comum&#10;  - Pode criar conta própria&#10;  - Pode visualizar/atualizar apenas seus dados&#10;  - Acesso a funcionalidades básicas&#10;&#10;- **ADMIN**: Administrador&#10;  - Acesso total ao sistema&#10;  - Pode visualizar/gerenciar todos os clientes&#10;  - Pode buscar por CPF e username&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Criar novo cliente (público):**&#10;```bash&#10;curl -X POST http://localhost:9090/clientes \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;nome&quot;: &quot;João Silva&quot;,&#10;    &quot;cpf&quot;: &quot;12345678901&quot;,&#10;    &quot;username&quot;: &quot;joao123&quot;,&#10;    &quot;password&quot;: &quot;senha123&quot;,&#10;    &quot;role&quot;: &quot;USER&quot;&#10;  }'&#10;```&#10;&#10;**Listar todos os clientes (ADMIN):**&#10;```bash&#10;curl -X GET http://localhost:9090/clientes \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Buscar cliente por ID (autenticado):**&#10;```bash&#10;curl -X GET http://localhost:9090/clientes/1 \&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Atualizar dados do cliente:**&#10;```bash&#10;curl -X PUT http://localhost:9090/clientes/1 \&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;nome&quot;: &quot;João Silva Santos&quot;,&#10;    &quot;username&quot;: &quot;joao_atualizado&quot;&#10;  }'&#10;```&#10;&#10;---&#10;&#10;## Considerações de Segurança&#10;&#10;1. **Controle de Acesso**: Implementação rigorosa de RBAC (Role-Based Access Control)&#10;2. **Validação de Autorização**: USERs só acessam seus próprios dados&#10;3. **Validação de Dados**: Todas as entradas são validadas (Bean Validation)&#10;4. **Criptografia**: Senhas são hasheadas com BCrypt&#10;5. **Não Exposição**: Senhas nunca retornadas nas responses&#10;6. **Validação de CPF**: Validação algorítmica de CPF&#10;7. **JWT Security**: Tokens assinados e com expiração&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Possíveis&#10;&#10;| Status | Nome | Descrição | Endpoints Afetados |&#10;|--------|------|-----------|-------------------|&#10;| **200** | OK | Sucesso | GET, PUT |&#10;| **201** | Created | Recurso criado | POST |&#10;| **400** | Bad Request | Dados inválidos | Todos |&#10;| **401** | Unauthorized | Token inválido/ausente | Todos exceto POST /clientes |&#10;| **403** | Forbidden | Sem permissão | Todos autenticados |&#10;| **404** | Not Found | Recurso não encontrado | GET por ID, CPF, username |&#10;| **409** | Conflict | Dados duplicados | POST, PUT |&#10;| **500** | Internal Server Error | Erro interno | Todos |&#10;&#10;### Mensagens de Erro por Categoria&#10;&#10;####  Erros de Validação (400)&#10;&#10;**Campos obrigatórios (POST /clientes):**&#10;- `&quot;Nome é obrigatório&quot;`&#10;- `&quot;CPF é obrigatório&quot;`&#10;- `&quot;Username é obrigatório&quot;`&#10;- `&quot;Password é obrigatório&quot;`&#10;- `&quot;Role é obrigatório&quot;`&#10;&#10;**Validações de tamanho:**&#10;- `&quot;Nome deve ter entre 2 e 100 caracteres&quot;`&#10;- `&quot;Username deve ter entre 3 e 50 caracteres&quot;`&#10;- `&quot;Password deve ter no mínimo 6 caracteres&quot;`&#10;&#10;**Validações de formato:**&#10;- `&quot;CPF inválido&quot;` (validação customizada)&#10;- `&quot;Role deve ser 'USER' ou 'ADMIN'&quot;`&#10;- `&quot;CPF deve conter exatamente 11 dígitos&quot;`&#10;&#10;**Formato JSON:**&#10;- `&quot;Dados da requisição inválidos: formato JSON incorreto&quot;`&#10;- `&quot;Formato JSON inválido&quot;`&#10;&#10;**Mensagem genérica:**&#10;- `&quot;Dados inválidos fornecidos&quot;`&#10;&#10;####  Erros de Autenticação (401)&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#10;- `&quot;Token JWT não encontrado&quot;`&#10;&#10;####  Erros de Autorização (403)&#10;- `&quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;`&#10;- `&quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;`&#10;- `&quot;Acesso negado: role não autorizada&quot;`&#10;&#10;####  Erros de Recurso Não Encontrado (404)&#10;- `&quot;Cliente não encontrado&quot;`&#10;- `&quot;Cliente não encontrado com ID: {id}&quot;`&#10;- `&quot;Cliente não encontrado com CPF: {cpf}&quot;`&#10;- `&quot;Cliente não encontrado com username: {username}&quot;`&#10;&#10;####  Erros de Conflito (409)&#10;- `&quot;CPF já cadastrado no sistema&quot;`&#10;- `&quot;Username já existe&quot;`&#10;- `&quot;CPF ou username já cadastrado no sistema&quot;`&#10;&#10;####  Erros Internos (500)&#10;- `&quot;Erro interno do servidor: {detalhes específicos}&quot;`&#10;- `&quot;Erro interno do servidor: Falha na conexão com o banco de dados&quot;`&#10;- `&quot;Erro interno do servidor: Erro na criptografia da senha&quot;`&#10;&#10;### Estrutura Completa das Respostas de Erro&#10;&#10;Todas as respostas de erro seguem o padrão:&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Mensagem principal do erro&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: [&quot;Lista de erros específicos (opcional)&quot;]&#10;}&#10;```&#10;&#10;### Exemplos Detalhados por Cenário&#10;&#10;#### ❌ 400 - Múltiplas Validações Falharam (POST)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'nome': Nome é obrigatório (valor fornecido: null)&quot;,&#10;    &quot;Campo 'cpf': CPF inválido (valor fornecido: 12345)&quot;,&#10;    &quot;Campo 'username': Username deve ter entre 3 e 50 caracteres (valor fornecido: ab)&quot;,&#10;    &quot;Campo 'password': Password deve ter no mínimo 6 caracteres (valor fornecido: 123)&quot;,&#10;    &quot;Campo 'role': Role deve ser 'USER' ou 'ADMIN' (valor fornecido: CLIENTE)&quot;&#10;  ]&#10;}&#10;```&#10;&#10;#### ❌ 400 - CPF Inválido&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;, &#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'cpf': CPF inválido (valor fornecido: 11111111111)&quot;&#10;  ]&#10;}&#10;```&#10;&#10;#### ❌ 401 - Token Ausente&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 403 - USER Tentando Acessar Dados de Outro Cliente&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;, &#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/clientes/2&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 403 - USER Tentando Listar Todos os Clientes&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 404 - Cliente Não Encontrado por ID&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Cliente não encontrado&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/clientes/999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 404 - Cliente Não Encontrado por CPF&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Cliente não encontrado com CPF: 99999999999&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/clientes/cpf/99999999999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 409 - CPF Já Cadastrado&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;CPF já cadastrado no sistema&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 409,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 409 - Username Já Existe&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Username já existe&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 409,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 500 - Falha no Banco de Dados&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Connection timeout to database&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;#### ❌ 500 - Falha na Criptografia&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Erro na criptografia da senha&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/clientes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;### Mapeamento de Erros por Endpoint&#10;&#10;#### GET /clientes&#10;- **401**: Token ausente/inválido  &#10;- **403**: Não é ADMIN&#10;- **500**: Erro interno&#10;&#10;#### GET /clientes/{id}  &#10;- **401**: Token ausente/inválido&#10;- **403**: USER tentando acessar dados de outro cliente&#10;- **404**: Cliente não encontrado&#10;- **500**: Erro interno&#10;&#10;#### POST /clientes&#10;- **400**: Validações falharam, JSON malformado&#10;- **409**: CPF ou username já existem&#10;- **500**: Erro interno&#10;&#10;#### PUT /clientes/{id}&#10;- **400**: Validações falharam, JSON malformado&#10;- **401**: Token ausente/inválido&#10;- **403**: USER tentando atualizar dados de outro cliente&#10;- **404**: Cliente não encontrado&#10;- **409**: Username já existe (se tentando alterar)&#10;- **500**: Erro interno&#10;&#10;#### GET /clientes/cpf/{cpf}&#10;- **401**: Token ausente/inválido&#10;- **403**: Não é ADMIN&#10;- **404**: Cliente não encontrado&#10;- **500**: Erro interno&#10;&#10;#### GET /clientes/username/{username}&#10;- **401**: Token ausente/inválido&#10;- **403**: Não é ADMIN  &#10;- **404**: Cliente não encontrado&#10;- **500**: Erro interno&#10;&#10;---" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/docs/DOCUMENTACAO_INVESTIMENTO_RESOURCE.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/docs/DOCUMENTACAO_INVESTIMENTO_RESOURCE.md" />
              <option name="originalContent" value="# Documentação da API - InvestimentoResource&#10;&#10;## Visão Geral&#10;&#10;O `InvestimentoResource` é responsável por registrar investimentos reais realizados pelos clientes e por consultar os investimentos associados a um cliente.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/investimentos`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;**Autenticação global:**&#10;- **Token JWT:** OBRIGATÓRIO para todos os endpoints&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso por Cliente:** O recurso valida que o usuário autenticado tem permissão para acessar/criar investimentos para o `clienteId` informado (veja `JwtAuthorizationHelper.validarAcessoAoCliente`).&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. POST /investimentos&#10;**Registra um novo investimento real**&#10;&#10;#### Descrição&#10;Registra um investimento realizado por um cliente. O endpoint persiste o investimento e retorna os dados do investimento criado.&#10;&#10;#### Fluxo resumido&#10;1. **Validação de entrada**: Campos obrigatórios e regras de negócio (inclui `@ValidPrazo`)&#10;2. **Validação de autorização**: Validação de acesso ao cliente via JWT&#10;3. **Persistência**: Criação do investimento por `InvestimentoService` e retorno da entidade criada&#10;4. **Resposta**: `201 Created` com o `InvestimentoResponse`&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** O servidor verifica se o usuário pode operar sobre o `clienteId` informado; USERS só podem operar sobre seus próprios clientes quando aplicável.&#10;&#10;#### Request&#10;&#10;**URL:** `POST /investimentos`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Body (JSON):**&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;produtoId&quot;: 5,&#10;  &quot;valor&quot;: 10000.00,&#10;  &quot;prazoMeses&quot;: 12,&#10;  &quot;prazoDias&quot;: null,&#10;  &quot;prazoAnos&quot;: null,&#10;  &quot;data&quot;: &quot;2025-11-15&quot;&#10;}&#10;```&#10;&#10;**Campos do Request:**&#10;&#10;| Campo | Tipo | Obrigatório | Validação | Descrição |&#10;|-------|------|-------------|-----------|-----------|&#10;| `clienteId` | Long | **Sim** | `@NotNull` | ID do cliente que realiza o investimento |&#10;| `produtoId` | Long | **Sim** | `@NotNull` | ID do produto financeiro adquirido |&#10;| `valor` | BigDecimal | **Sim** | `@NotNull`, `@DecimalMin(&quot;1.00&quot;)`, `@DecimalMax(&quot;999999999.99&quot;)` | Valor do investimento (R$ 1,00 a R$ 999.999.999,99) |&#10;| `prazoMeses` | Integer | Não* | `@Min(1)`, `@Max(600)` | Prazo em meses (1 a 600) |&#10;| `prazoDias` | Integer | Não* | `@Min(1)`, `@Max(18250)` | Prazo em dias (1 a 18.250) |&#10;| `prazoAnos` | Integer | Não* | `@Min(1)`, `@Max(50)` | Prazo em anos (1 a 50) |&#10;| `data` | date | **Sim** | `@NotNull` | Data da aplicação do investimento (YYYY-MM-DD) |&#10;&#10;*Regras especiais: o DTO aplica a validação `@ValidPrazo` — pelo menos um dos campos de prazo (`prazoMeses`, `prazoDias`, `prazoAnos`) deve ser informado e válido.&#10;&#10;**Exemplo de Request:**&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;produtoId&quot;: 5,&#10;  &quot;valor&quot;: 5000.00,&#10;  &quot;prazoMeses&quot;: 24,&#10;  &quot;data&quot;: &quot;2025-11-15&quot;&#10;}&#10;```&#10;&#10;#### Responses&#10;&#10;##### ✅ 201 - Investimento criado com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 987,&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;produtoId&quot;: 5,&#10;  &quot;valor&quot;: 5000.00,&#10;  &quot;prazoMeses&quot;: 24,&#10;  &quot;prazoDias&quot;: 720,&#10;  &quot;prazoAnos&quot;: 2,&#10;  &quot;data&quot;: &quot;2025-11-15&quot;,&#10;  &quot;tipo&quot;: &quot;CDB&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;rentabilidade&quot;: 20.00,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 30,&#10;  &quot;minimo_dias_investimento&quot;: 30,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `id` | Long | ID do investimento criado |&#10;| `clienteId` | Long | ID do cliente |&#10;| `produtoId` | Long | ID do produto |&#10;| `valor` | BigDecimal | Valor investido |&#10;| `prazoMeses` | Integer | Prazo em meses (quando calculado/formato preferencial) |&#10;| `prazoDias` | Integer | Prazo em dias (cálculo auxiliar) |&#10;| `prazoAnos` | Integer | Prazo em anos (quando aplicável) |&#10;| `data` | date | Data da aplicação |&#10;| `tipo` | enum | Tipo do produto (ex: CDB, LCI) |&#10;| `tipo_rentabilidade` | enum | Tipo de rentabilidade (ex: PRE, POS) |&#10;| `rentabilidade` | BigDecimal | Valor percentual de rentabilidade |&#10;| `periodo_rentabilidade` | enum | Período da rentabilidade (ex: AO_ANO) |&#10;| `indice` | enum | Índice relacionado (ex: CDI, SELIC, IPCA, NENHUM) |&#10;| `liquidez` | Integer | Liquidez em dias (-1 = sem liquidez) |&#10;| `minimo_dias_investimento` | Integer | Mínimo de dias para resgate |&#10;| `fgc` | Boolean | Indica proteção pelo FGC |&#10;&#10;---&#10;&#10;### 2. GET /investimentos/{clienteId}&#10;**Busca todos os investimentos de um cliente**&#10;&#10;#### Descrição&#10;Retorna a lista de investimentos persistidos para o cliente informado. O endpoint ordena ou filtra conforme regras internas do serviço.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** O recurso chama `JwtAuthorizationHelper.validarAcessoAoCliente` para garantir que o usuário autenticado pode visualizar os investimentos do `clienteId` informado.&#10;&#10;#### Request&#10;&#10;**URL:** `GET /investimentos/{clienteId}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `clienteId` | Long | Sim | `@NotNull` | ID único do cliente |&#10;&#10;**Exemplo:** `GET /investimentos/1`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Investimentos obtidos com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 987,&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;produtoId&quot;: 5,&#10;    &quot;valor&quot;: 5000.00,&#10;    &quot;prazoMeses&quot;: 24,&#10;    &quot;prazoDias&quot;: 720,&#10;    &quot;prazoAnos&quot;: 2,&#10;    &quot;data&quot;: &quot;2025-11-15&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 20.00,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 30,&#10;    &quot;minimo_dias_investimento&quot;: 30,&#10;    &quot;fgc&quot;: true&#10;  }&#10;]&#10;```&#10;&#10;---&#10;&#10;## Status Codes e Erros por Endpoint&#10;&#10;### POST /investimentos&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **201** | Created | Investimento criado com sucesso |&#10;| **400** | Bad Request | Validações falharam, regras de negócio violadas (ex: ausência de prazo válido, valor fora dos limites) |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Usuário não autorizado a criar investimento para o cliente informado |&#10;| **500** | Internal Server Error | Erro interno do sistema |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 400 - Bad Request (Validações)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/investimentos&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'clienteId': ID do cliente é obrigatório (valor fornecido: null)&quot;,&#10;    &quot;Campo 'produtoId': ID do produto é obrigatório (valor fornecido: null)&quot;,&#10;    &quot;Campo 'valor': Valor mínimo de investimento é R$ 1,00 (valor fornecido: 0.50)&quot;,&#10;    &quot;Campo 'prazoMeses': Prazo em meses deve ser no mínimo 1 (valor fornecido: 0)&quot;&#10;  ]&#10;}&#10;```&#10;&#10;##### ❌ 400 - Bad Request (Regras de Negócio)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro de validação: Pelo menos um prazo deve ser informado (prazoMeses, prazoDias ou prazoAnos)&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/investimentos&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /investimentos/{clienteId}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Lista de investimentos retornada com sucesso |&#10;| **204** | No Content | Cliente existe mas não possui investimentos (implementação pode retornar 200 com lista vazia)&#10;| **400** | Bad Request | `clienteId` inválido |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Usuário não autorizado a visualizar os investimentos deste cliente |&#10;| **404** | Not Found | Cliente não encontrado (dependendo da implementação do serviço) |&#10;| **500** | Internal Server Error | Erro interno do sistema |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 403 - Forbidden (Acesso negado)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado ao cliente informado&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/investimentos/2&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Observações Técnicas e Testes&#10;&#10;- As validações importantes estão no DTO `InvestimentoRequest` e na anotação customizada `@ValidPrazo`.&#10;- A autorização por cliente é feita por `JwtAuthorizationHelper.validarAcessoAoCliente(jwt, clienteId)` (chamado tanto no POST quanto no GET).&#10;- Testes de integração relevantes: `src/test/java/.../InvestimentoResourceIntegrationTest.java`.&#10;- Verifique também o contrato OpenAPI em `swagger-api-investimentos-caixa.yaml` para exemplos automáticos e para manter a documentação sincronizada.&#10;&#10;---&#10;&#10;&#10;" />
              <option name="updatedContent" value="# Documentação da API - InvestimentoResource&#10;&#10;## Visão Geral&#10;&#10;O `InvestimentoResource` é responsável por registrar investimentos reais realizados pelos clientes e por consultar os investimentos associados a um cliente.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/investimentos`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;**Autenticação global:**&#10;- **Token JWT:** OBRIGATÓRIO para todos os endpoints&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso por Cliente:** O recurso valida que o usuário autenticado tem permissão para acessar/criar investimentos para o `clienteId` informado (veja `JwtAuthorizationHelper.validarAcessoAoCliente`).&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. POST /investimentos&#10;**Registra um novo investimento real**&#10;&#10;`http://localhost:9090/investimentos`&#10;&#10;#### Descrição&#10;Registra um investimento realizado por um cliente. O endpoint persiste o investimento e retorna os dados do investimento criado.&#10;&#10;#### Fluxo resumido&#10;1. **Validação de entrada**: Campos obrigatórios e regras de negócio (inclui `@ValidPrazo`)&#10;2. **Validação de autorização**: Validação de acesso ao cliente via JWT&#10;3. **Persistência**: Criação do investimento por `InvestimentoService` e retorno da entidade criada&#10;4. **Resposta**: `201 Created` com o `InvestimentoResponse`&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** O servidor verifica se o usuário pode operar sobre o `clienteId` informado; USERS só podem operar sobre seus próprios clientes quando aplicável.&#10;&#10;#### Request&#10;&#10;**URL:** `POST /investimentos`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Body (JSON):**&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;produtoId&quot;: 5,&#10;  &quot;valor&quot;: 10000.00,&#10;  &quot;prazoMeses&quot;: 12,&#10;  &quot;prazoDias&quot;: null,&#10;  &quot;prazoAnos&quot;: null,&#10;  &quot;data&quot;: &quot;2025-11-15&quot;&#10;}&#10;```&#10;&#10;**Campos do Request:**&#10;&#10;| Campo | Tipo | Obrigatório | Validação | Descrição |&#10;|-------|------|-------------|-----------|-----------|&#10;| `clienteId` | Long | **Sim** | `@NotNull` | ID do cliente que realiza o investimento |&#10;| `produtoId` | Long | **Sim** | `@NotNull` | ID do produto financeiro adquirido |&#10;| `valor` | BigDecimal | **Sim** | `@NotNull`, `@DecimalMin(&quot;1.00&quot;)`, `@DecimalMax(&quot;999999999.99&quot;)` | Valor do investimento (R$ 1,00 a R$ 999.999.999,99) |&#10;| `prazoMeses` | Integer | Não* | `@Min(1)`, `@Max(600)` | Prazo em meses (1 a 600) |&#10;| `prazoDias` | Integer | Não* | `@Min(1)`, `@Max(18250)` | Prazo em dias (1 a 18.250) |&#10;| `prazoAnos` | Integer | Não* | `@Min(1)`, `@Max(50)` | Prazo em anos (1 a 50) |&#10;| `data` | date | **Sim** | `@NotNull` | Data da aplicação do investimento (YYYY-MM-DD) |&#10;&#10;*Regras especiais: o DTO aplica a validação `@ValidPrazo` — pelo menos um dos campos de prazo (`prazoMeses`, `prazoDias`, `prazoAnos`) deve ser informado e válido.&#10;&#10;**Exemplo de Request:**&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;produtoId&quot;: 5,&#10;  &quot;valor&quot;: 5000.00,&#10;  &quot;prazoMeses&quot;: 24,&#10;  &quot;data&quot;: &quot;2025-11-15&quot;&#10;}&#10;```&#10;&#10;#### Responses&#10;&#10;##### ✅ 201 - Investimento criado com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 987,&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;produtoId&quot;: 5,&#10;  &quot;valor&quot;: 5000.00,&#10;  &quot;prazoMeses&quot;: 24,&#10;  &quot;prazoDias&quot;: 720,&#10;  &quot;prazoAnos&quot;: 2,&#10;  &quot;data&quot;: &quot;2025-11-15&quot;,&#10;  &quot;tipo&quot;: &quot;CDB&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;rentabilidade&quot;: 20.00,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 30,&#10;  &quot;minimo_dias_investimento&quot;: 30,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `id` | Long | ID do investimento criado |&#10;| `clienteId` | Long | ID do cliente |&#10;| `produtoId` | Long | ID do produto |&#10;| `valor` | BigDecimal | Valor investido |&#10;| `prazoMeses` | Integer | Prazo em meses (quando calculado/formato preferencial) |&#10;| `prazoDias` | Integer | Prazo em dias (cálculo auxiliar) |&#10;| `prazoAnos` | Integer | Prazo em anos (quando aplicável) |&#10;| `data` | date | Data da aplicação |&#10;| `tipo` | enum | Tipo do produto (ex: CDB, LCI) |&#10;| `tipo_rentabilidade` | enum | Tipo de rentabilidade (ex: PRE, POS) |&#10;| `rentabilidade` | BigDecimal | Valor percentual de rentabilidade |&#10;| `periodo_rentabilidade` | enum | Período da rentabilidade (ex: AO_ANO) |&#10;| `indice` | enum | Índice relacionado (ex: CDI, SELIC, IPCA, NENHUM) |&#10;| `liquidez` | Integer | Liquidez em dias (-1 = sem liquidez) |&#10;| `minimo_dias_investimento` | Integer | Mínimo de dias para resgate |&#10;| `fgc` | Boolean | Indica proteção pelo FGC |&#10;&#10;---&#10;&#10;### 2. GET /investimentos/{clienteId}&#10;**Busca todos os investimentos de um cliente**&#10;&#10;`http://localhost:9090/investimentos/{clienteId}`&#10;&#10;#### Descrição&#10;Retorna a lista de investimentos persistidos para o cliente informado. O endpoint ordena ou filtra conforme regras internas do serviço.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** O recurso chama `JwtAuthorizationHelper.validarAcessoAoCliente` para garantir que o usuário autenticado pode visualizar os investimentos do `clienteId` informado.&#10;&#10;#### Request&#10;&#10;**URL:** `GET /investimentos/{clienteId}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `clienteId` | Long | Sim | `@NotNull` | ID único do cliente |&#10;&#10;**Exemplo:** `GET /investimentos/1`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Investimentos obtidos com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 987,&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;produtoId&quot;: 5,&#10;    &quot;valor&quot;: 5000.00,&#10;    &quot;prazoMeses&quot;: 24,&#10;    &quot;prazoDias&quot;: 720,&#10;    &quot;prazoAnos&quot;: 2,&#10;    &quot;data&quot;: &quot;2025-11-15&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 20.00,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 30,&#10;    &quot;minimo_dias_investimento&quot;: 30,&#10;    &quot;fgc&quot;: true&#10;  }&#10;]&#10;```&#10;&#10;---&#10;&#10;## Status Codes e Erros por Endpoint&#10;&#10;### POST /investimentos&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **201** | Created | Investimento criado com sucesso |&#10;| **400** | Bad Request | Validações falharam, regras de negócio violadas (ex: ausência de prazo válido, valor fora dos limites) |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Usuário não autorizado a criar investimento para o cliente informado |&#10;| **500** | Internal Server Error | Erro interno do sistema |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 400 - Bad Request (Validações)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/investimentos&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'clienteId': ID do cliente é obrigatório (valor fornecido: null)&quot;,&#10;    &quot;Campo 'produtoId': ID do produto é obrigatório (valor fornecido: null)&quot;,&#10;    &quot;Campo 'valor': Valor mínimo de investimento é R$ 1,00 (valor fornecido: 0.50)&quot;,&#10;    &quot;Campo 'prazoMeses': Prazo em meses deve ser no mínimo 1 (valor fornecido: 0)&quot;&#10;  ]&#10;}&#10;```&#10;&#10;##### ❌ 400 - Bad Request (Regras de Negócio)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro de validação: Pelo menos um prazo deve ser informado (prazoMeses, prazoDias ou prazoAnos)&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/investimentos&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /investimentos/{clienteId}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Lista de investimentos retornada com sucesso |&#10;| **204** | No Content | Cliente existe mas não possui investimentos (implementação pode retornar 200 com lista vazia)&#10;| **400** | Bad Request | `clienteId` inválido |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Usuário não autorizado a visualizar os investimentos deste cliente |&#10;| **404** | Not Found | Cliente não encontrado (dependendo da implementação do serviço) |&#10;| **500** | Internal Server Error | Erro interno do sistema |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 403 - Forbidden (Acesso negado)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado ao cliente informado&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/investimentos/2&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Observações Técnicas e Testes&#10;&#10;- As validações importantes estão no DTO `InvestimentoRequest` e na anotação customizada `@ValidPrazo`.&#10;- A autorização por cliente é feita por `JwtAuthorizationHelper.validarAcessoAoCliente(jwt, clienteId)` (chamado tanto no POST quanto no GET).&#10;- Testes de integração relevantes: `src/test/java/.../InvestimentoResourceIntegrationTest.java`.&#10;- Verifique também o contrato OpenAPI em `swagger-api-investimentos-caixa.yaml` para exemplos automáticos e para manter a documentação sincronizada.&#10;&#10;---&#10;&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/docs/DOCUMENTACAO_PERFIL_RISCO.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/docs/DOCUMENTACAO_PERFIL_RISCO.md" />
              <option name="originalContent" value="# Documentação da API - PerfilRiscoResource&#10;&#10;## Visão Geral&#10;&#10;O `PerfilRiscoResource` é responsável por calcular e fornecer o perfil de risco de clientes baseado em seu histórico de investimentos e simulações. Utiliza algoritmos de Machine Learning para analisar o comportamento do cliente e determinar seu perfil (Conservador, Moderado ou Agressivo).&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/perfil-risco`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;**Autenticação global:**&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. GET /perfil-risco/{clienteId}&#10;**Calcula o perfil de risco de um cliente**&#10;&#10;#### Descrição&#10;Analisa o histórico de investimentos e simulações de um cliente para determinar seu perfil de risco. O cálculo utiliza Machine Learning baseado nos produtos mais utilizados pelo cliente, considerando primeiro investimentos reais e, na ausência destes, simulações realizadas.&#10;&#10;#### Algoritmo de Cálculo&#10;1. **Prioridade 1**: Histórico de investimentos reais&#10;2. **Prioridade 2**: Histórico de simulações (se não houver investimentos)&#10;3. **Erro**: Se não houver nenhum histórico&#10;&#10;**Perfis possíveis:**&#10;- **CONSERVADOR**: Focado em produtos de baixo risco&#10;- **MODERADO**: Equilibrio entre risco e retorno &#10;- **AGRESSIVO**: Tolerância a alto risco para maior rentabilidade&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;&#10;#### Request&#10;&#10;**URL:** `GET /perfil-risco/{clienteId}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Descrição |&#10;|-----------|------|-------------|-----------|&#10;| `clienteId` | Long | Sim | ID único do cliente para análise |&#10;&#10;**Exemplo:** `GET /perfil-risco/1`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Perfil calculado com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;perfil&quot;: &quot;MODERADO&quot;,&#10;  &quot;pontuacao&quot;: 65,&#10;  &quot;descricao&quot;: &quot;Perfil equilibrado entre segurança e rentabilidade.&quot;&#10;}&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `clienteId` | Long | ID do cliente analisado |&#10;| `perfil` | string | Perfil de risco: &quot;CONSERVADOR&quot;, &quot;MODERADO&quot;, &quot;AGRESSIVO&quot; |&#10;| `pontuacao` | integer | Pontuação calculada (0-100) baseada no algoritmo |&#10;| `descricao` | string | Descrição detalhada do perfil |&#10;&#10;**Exemplos por Perfil:**&#10;&#10;**Perfil Conservador:**&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;perfil&quot;: &quot;CONSERVADOR&quot;, &#10;  &quot;pontuacao&quot;: 25,&#10;  &quot;descricao&quot;: &quot;Perfil focado em segurança e liquidez, com baixa tolerância ao risco.&quot;&#10;}&#10;```&#10;&#10;**Perfil Moderado:**&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 2,&#10;  &quot;perfil&quot;: &quot;MODERADO&quot;,&#10;  &quot;pontuacao&quot;: 55,&#10;  &quot;descricao&quot;: &quot;Perfil equilibrado entre segurança e rentabilidade.&quot;&#10;}&#10;```&#10;&#10;**Perfil Agressivo:**&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 3,&#10;  &quot;perfil&quot;: &quot;AGRESSIVO&quot;,&#10;  &quot;pontuacao&quot;: 85,&#10;  &quot;descricao&quot;: &quot;Perfil voltado para alta rentabilidade, com maior tolerância ao risco.&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;## Status Codes e Erros por Endpoint&#10;&#10;### GET /perfil-risco/{clienteId}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Perfil calculado com sucesso |&#10;| **400** | Bad Request | Cliente sem histórico suficiente |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Token válido mas sem permissão |&#10;| **404** | Not Found | Cliente não encontrado |&#10;| **500** | Internal Server Error | Erro interno do sistema |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 400 - Bad Request&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Cliente não possui histórico de investimentos nem simulações para calcular perfil de risco&quot;&#10;}&#10;```&#10;&#10;**Quando ocorre:**&#10;- Cliente existe mas não tem investimentos&#10;- Cliente existe mas não tem simulações&#10;- Histórico insuficiente para cálculo&#10;&#10;##### ❌ 401 - Unauthorized&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/perfil-risco/1&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;**Quando ocorre:**&#10;- Header Authorization ausente&#10;- Token JWT inválido ou expirado&#10;- Token malformado&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/perfil-risco/1&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;**Quando ocorre:**&#10;- Token válido mas role não autorizada&#10;- User tentando acessar dados de outro cliente (sem validação atual)&#10;&#10;##### ❌ 404 - Not Found&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Cliente não encontrado&quot;&#10;}&#10;```&#10;&#10;**Quando ocorre:**&#10;- ID de cliente não existe no sistema&#10;- Cliente foi removido do banco&#10;&#10;##### ❌ 500 - Internal Server Error&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno no servidor&quot;&#10;}&#10;```&#10;&#10;**Quando ocorre:**&#10;- Falha na conexão com banco de dados&#10;- Erro no algoritmo de ML&#10;- Falha no processamento interno&#10;- Exception não tratada&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Consolidados&#10;&#10;| Status | Nome | Descrição | Cenários |&#10;|--------|------|-----------|----------|&#10;| **200** | OK | Perfil calculado | Cliente com histórico suficiente |&#10;| **400** | Bad Request | Dados insuficientes | Sem histórico de investimentos/simulações |&#10;| **401** | Unauthorized | Token inválido | Não autenticado |&#10;| **403** | Forbidden | Sem permissão | Role não autorizada |&#10;| **404** | Not Found | Cliente não existe | ID inválido |&#10;| **500** | Internal Server Error | Erro interno | Falhas do sistema |&#10;&#10;### Categorias de Mensagens de Erro&#10;&#10;####  Erros de Validação (400)&#10;- `&quot;Cliente não possui histórico de investimentos nem simulações para calcular perfil de risco&quot;`&#10;&#10;####  Erros de Autenticação (401)&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#10;&#10;####  Erros de Autorização (403)&#10;- `&quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;`&#10;&#10;####  Erros de Recurso (404)&#10;- `&quot;Cliente não encontrado&quot;`&#10;- `&quot;Cliente não encontrado com ID: {clienteId}&quot;`&#10;&#10;####  Erros Internos (500)&#10;- `&quot;Erro interno no servidor&quot;`&#10;&#10;### Estrutura de Erros&#10;&#10;**Erros simples (400, 404, 500):**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Mensagem do erro&quot;&#10;}&#10;```&#10;&#10;**Erros de framework (401, 403):**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Mensagem detalhada&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/perfil-risco/1&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Algoritmo de Cálculo de Perfil&#10;&#10;### Etapas do Processo&#10;&#10;1. **Validação do Cliente**&#10;   - Verifica se o cliente existe no sistema&#10;   - Retorna 404 se não encontrado&#10;&#10;2. **Coleta de Dados**&#10;   - **Prioridade 1**: Investimentos reais do cliente&#10;   - **Prioridade 2**: Simulações realizadas (se não há investimentos)&#10;&#10;3. **Análise via Machine Learning**&#10;   - Utiliza `GeradorRecomendacaoML` para análise&#10;   - Ordena produtos por aparições no histórico&#10;   - Considera níveis de risco dos produtos&#10;&#10;4. **Cálculo da Pontuação**&#10;   - Baseado na frequência de produtos por nível de risco&#10;   - Pontuação de 0 a 100 points&#10;   - Fórmula: `(aparições_nivel_dominante * 100) / total_pontuações`&#10;&#10;5. **Determinação do Perfil**&#10;   - **CONSERVADOR**: Maioria produtos de risco BAIXO&#10;   - **MODERADO**: Maioria produtos de risco MÉDIO  &#10;   - **AGRESSIVO**: Maioria produtos de risco ALTO&#10;&#10;### Níveis de Risco dos Produtos&#10;&#10;| Nível | Enum | Características |&#10;|-------|------|----------------|&#10;| **BAIXO** | `NivelRisco.BAIXO` | Produtos garantidos pelo FGC |&#10;| **MÉDIO** | `NivelRisco.MEDIO` | Renda fixa não garantida pelo FGC |&#10;| **ALTO** | `NivelRisco.ALTO` | Renda variável, sem garantias |&#10;&#10;### Casos Especiais&#10;&#10;- **Sem histórico**: Retorna erro 400&#10;- **Histórico misto**: Perfil determinado pela maioria&#10;- **Empate**: Sistema prioriza o primeiro produto na ordenação&#10;&#10;---&#10;&#10;## Informações Técnicas&#10;&#10;### Autenticação e Autorização&#10;&#10;**Roles aceitas:**&#10;- `USER`: Pode calcular perfil (sem validação de propriedade atual)&#10;- `ADMIN`: Acesso irrestrito a qualquer cliente&#10;&#10;**Token JWT deve conter:**&#10;- Role válida (`USER` ou `ADMIN`)&#10;- Token não expirado&#10;- Assinatura válida&#10;&#10;### Dependências do Cálculo&#10;&#10;O endpoint depende de:&#10;- **ClienteService**: Validação da existência do cliente&#10;- **InvestimentoRepository**: Histórico de investimentos reais&#10;- **SimulacaoRepository**: Histórico de simulações&#10;- **ProdutoRepository**: Informações dos produtos e riscos&#10;- **GeradorRecomendacaoML**: Algoritmo de machine learning&#10;&#10;### Performance&#10;&#10;- Consultas ao banco para histórico&#10;- Processamento ML pode ser intensivo&#10;- Cache não implementado (recalcula sempre)&#10;- Complexidade cresce com volume de histórico&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Calcular perfil de cliente específico:**&#10;```bash&#10;curl -X GET http://localhost:9090/perfil-risco/1 \&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Exemplo com cliente sem histórico:**&#10;```bash&#10;curl -X GET http://localhost:9090/perfil-risco/999 \&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;### Respostas Esperadas&#10;&#10;**Cliente com perfil conservador:**&#10;```bash&#10;HTTP/1.1 200 OK&#10;Content-Type: application/json&#10;&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;perfil&quot;: &quot;CONSERVADOR&quot;,&#10;  &quot;pontuacao&quot;: 30,&#10;  &quot;descricao&quot;: &quot;Perfil focado em segurança e liquidez, com baixa tolerância ao risco.&quot;&#10;}&#10;```&#10;&#10;**Cliente não encontrado:**&#10;```bash&#10;HTTP/1.1 404 Not Found&#10;Content-Type: application/json&#10;&#10;{&#10;  &quot;message&quot;: &quot;Cliente não encontrado&quot;&#10;}&#10;```&#10;&#10;**Cliente sem histórico:**&#10;```bash&#10;HTTP/1.1 400 Bad Request &#10;Content-Type: application/json&#10;&#10;{&#10;  &quot;message&quot;: &quot;Cliente não possui histórico de investimentos nem simulações para calcular perfil de risco&quot;&#10;}&#10;```&#10;&#10;&#10;" />
              <option name="updatedContent" value="# Documentação da API - PerfilRiscoResource&#13;&#10;&#13;&#10;## Visão Geral&#13;&#10;&#13;&#10;O `PerfilRiscoResource` é responsável por calcular e fornecer o perfil de risco de clientes baseado em seu histórico de investimentos e simulações. Utiliza algoritmos de Machine Learning para analisar o comportamento do cliente e determinar seu perfil (Conservador, Moderado ou Agressivo).&#13;&#10;&#13;&#10;**Servidor:** `http://localhost:9090`&#13;&#10;&#13;&#10;**Base Path:** `/perfil-risco`&#13;&#10;&#13;&#10;**Formatos suportados:**&#13;&#10;- Content-Type: `application/json`&#13;&#10;- Accept: `application/json`&#13;&#10;&#13;&#10;**Autenticação global:**&#13;&#10;- **Token JWT:** OBRIGATÓRIO&#13;&#10;- **Roles permitidas:** `USER`, `ADMIN`&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Endpoints&#13;&#10;&#13;&#10;### 1. GET /perfil-risco/{clienteId}&#10;**Calcula o perfil de risco de um cliente**&#10;&#10;`http://localhost:9090/perfil-risco/{clienteId}`&#10;&#10;#### Descrição&#13;&#10;Analisa o histórico de investimentos e simulações de um cliente para determinar seu perfil de risco. O cálculo utiliza Machine Learning baseado nos produtos mais utilizados pelo cliente, considerando primeiro investimentos reais e, na ausência destes, simulações realizadas.&#13;&#10;&#13;&#10;#### Algoritmo de Cálculo&#13;&#10;1. **Prioridade 1**: Histórico de investimentos reais&#13;&#10;2. **Prioridade 2**: Histórico de simulações (se não houver investimentos)&#13;&#10;3. **Erro**: Se não houver nenhum histórico&#13;&#10;&#13;&#10;**Perfis possíveis:**&#13;&#10;- **CONSERVADOR**: Focado em produtos de baixo risco&#13;&#10;- **MODERADO**: Equilibrio entre risco e retorno &#13;&#10;- **AGRESSIVO**: Tolerância a alto risco para maior rentabilidade&#13;&#10;&#13;&#10;#### Autenticação&#13;&#10;- **Token JWT:** OBRIGATÓRIO&#13;&#10;- **Roles permitidas:** `USER`, `ADMIN`&#13;&#10;&#13;&#10;#### Request&#13;&#10;&#13;&#10;**URL:** `GET /perfil-risco/{clienteId}`&#13;&#10;&#13;&#10;**Headers obrigatórios:**&#13;&#10;```&#13;&#10;Authorization: Bearer {jwt_token}&#13;&#10;Content-Type: application/json&#13;&#10;```&#13;&#10;&#13;&#10;**Path Parameters:**&#13;&#10;&#13;&#10;| Parâmetro | Tipo | Obrigatório | Descrição |&#13;&#10;|-----------|------|-------------|-----------|&#13;&#10;| `clienteId` | Long | Sim | ID único do cliente para análise |&#13;&#10;&#13;&#10;**Exemplo:** `GET /perfil-risco/1`&#13;&#10;&#13;&#10;#### Responses&#13;&#10;&#13;&#10;##### ✅ 200 - Perfil calculado com sucesso&#13;&#10;&#13;&#10;**Response Body:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;clienteId&quot;: 1,&#13;&#10;  &quot;perfil&quot;: &quot;MODERADO&quot;,&#13;&#10;  &quot;pontuacao&quot;: 65,&#13;&#10;  &quot;descricao&quot;: &quot;Perfil equilibrado entre segurança e rentabilidade.&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Campos da Response:**&#13;&#10;&#13;&#10;| Campo | Tipo | Descrição |&#13;&#10;|-------|------|-----------|&#13;&#10;| `clienteId` | Long | ID do cliente analisado |&#13;&#10;| `perfil` | string | Perfil de risco: &quot;CONSERVADOR&quot;, &quot;MODERADO&quot;, &quot;AGRESSIVO&quot; |&#13;&#10;| `pontuacao` | integer | Pontuação calculada (0-100) baseada no algoritmo |&#13;&#10;| `descricao` | string | Descrição detalhada do perfil |&#13;&#10;&#13;&#10;**Exemplos por Perfil:**&#13;&#10;&#13;&#10;**Perfil Conservador:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;clienteId&quot;: 1,&#13;&#10;  &quot;perfil&quot;: &quot;CONSERVADOR&quot;, &#13;&#10;  &quot;pontuacao&quot;: 25,&#13;&#10;  &quot;descricao&quot;: &quot;Perfil focado em segurança e liquidez, com baixa tolerância ao risco.&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Perfil Moderado:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;clienteId&quot;: 2,&#13;&#10;  &quot;perfil&quot;: &quot;MODERADO&quot;,&#13;&#10;  &quot;pontuacao&quot;: 55,&#13;&#10;  &quot;descricao&quot;: &quot;Perfil equilibrado entre segurança e rentabilidade.&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Perfil Agressivo:**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;clienteId&quot;: 3,&#13;&#10;  &quot;perfil&quot;: &quot;AGRESSIVO&quot;,&#13;&#10;  &quot;pontuacao&quot;: 85,&#13;&#10;  &quot;descricao&quot;: &quot;Perfil voltado para alta rentabilidade, com maior tolerância ao risco.&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Status Codes e Erros por Endpoint&#13;&#10;&#13;&#10;### GET /perfil-risco/{clienteId}&#13;&#10;&#13;&#10;#### Status Codes Possíveis&#13;&#10;| Status | Descrição | Quando Ocorre |&#13;&#10;|--------|-----------|---------------|&#13;&#10;| **200** | OK | Perfil calculado com sucesso |&#13;&#10;| **400** | Bad Request | Cliente sem histórico suficiente |&#13;&#10;| **401** | Unauthorized | Token ausente/inválido |&#13;&#10;| **403** | Forbidden | Token válido mas sem permissão |&#13;&#10;| **404** | Not Found | Cliente não encontrado |&#13;&#10;| **500** | Internal Server Error | Erro interno do sistema |&#13;&#10;&#13;&#10;#### Mensagens de Erro Possíveis&#13;&#10;&#13;&#10;##### ❌ 400 - Bad Request&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Cliente não possui histórico de investimentos nem simulações para calcular perfil de risco&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Quando ocorre:**&#13;&#10;- Cliente existe mas não tem investimentos&#13;&#10;- Cliente existe mas não tem simulações&#13;&#10;- Histórico insuficiente para cálculo&#13;&#10;&#13;&#10;##### ❌ 401 - Unauthorized&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 401,&#13;&#10;  &quot;path&quot;: &quot;/perfil-risco/1&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Quando ocorre:**&#13;&#10;- Header Authorization ausente&#13;&#10;- Token JWT inválido ou expirado&#13;&#10;- Token malformado&#13;&#10;&#13;&#10;##### ❌ 403 - Forbidden&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 403,&#13;&#10;  &quot;path&quot;: &quot;/perfil-risco/1&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Quando ocorre:**&#13;&#10;- Token válido mas role não autorizada&#13;&#10;- User tentando acessar dados de outro cliente (sem validação atual)&#13;&#10;&#13;&#10;##### ❌ 404 - Not Found&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Cliente não encontrado&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Quando ocorre:**&#13;&#10;- ID de cliente não existe no sistema&#13;&#10;- Cliente foi removido do banco&#13;&#10;&#13;&#10;##### ❌ 500 - Internal Server Error&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Erro interno no servidor&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Quando ocorre:**&#13;&#10;- Falha na conexão com banco de dados&#13;&#10;- Erro no algoritmo de ML&#13;&#10;- Falha no processamento interno&#13;&#10;- Exception não tratada&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#13;&#10;&#13;&#10;### Status Codes Consolidados&#13;&#10;&#13;&#10;| Status | Nome | Descrição | Cenários |&#13;&#10;|--------|------|-----------|----------|&#13;&#10;| **200** | OK | Perfil calculado | Cliente com histórico suficiente |&#13;&#10;| **400** | Bad Request | Dados insuficientes | Sem histórico de investimentos/simulações |&#13;&#10;| **401** | Unauthorized | Token inválido | Não autenticado |&#13;&#10;| **403** | Forbidden | Sem permissão | Role não autorizada |&#13;&#10;| **404** | Not Found | Cliente não existe | ID inválido |&#13;&#10;| **500** | Internal Server Error | Erro interno | Falhas do sistema |&#13;&#10;&#13;&#10;### Categorias de Mensagens de Erro&#13;&#10;&#13;&#10;####  Erros de Validação (400)&#13;&#10;- `&quot;Cliente não possui histórico de investimentos nem simulações para calcular perfil de risco&quot;`&#13;&#10;&#13;&#10;####  Erros de Autenticação (401)&#13;&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#13;&#10;&#13;&#10;####  Erros de Autorização (403)&#13;&#10;- `&quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;`&#13;&#10;&#13;&#10;####  Erros de Recurso (404)&#13;&#10;- `&quot;Cliente não encontrado&quot;`&#13;&#10;- `&quot;Cliente não encontrado com ID: {clienteId}&quot;`&#13;&#10;&#13;&#10;####  Erros Internos (500)&#13;&#10;- `&quot;Erro interno no servidor&quot;`&#13;&#10;&#13;&#10;### Estrutura de Erros&#13;&#10;&#13;&#10;**Erros simples (400, 404, 500):**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Mensagem do erro&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Erros de framework (401, 403):**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Mensagem detalhada&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 403,&#13;&#10;  &quot;path&quot;: &quot;/perfil-risco/1&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Algoritmo de Cálculo de Perfil&#13;&#10;&#13;&#10;### Etapas do Processo&#13;&#10;&#13;&#10;1. **Validação do Cliente**&#13;&#10;   - Verifica se o cliente existe no sistema&#13;&#10;   - Retorna 404 se não encontrado&#13;&#10;&#13;&#10;2. **Coleta de Dados**&#13;&#10;   - **Prioridade 1**: Investimentos reais do cliente&#13;&#10;   - **Prioridade 2**: Simulações realizadas (se não há investimentos)&#13;&#10;&#13;&#10;3. **Análise via Machine Learning**&#13;&#10;   - Utiliza `GeradorRecomendacaoML` para análise&#13;&#10;   - Ordena produtos por aparições no histórico&#13;&#10;   - Considera níveis de risco dos produtos&#13;&#10;&#13;&#10;4. **Cálculo da Pontuação**&#13;&#10;   - Baseado na frequência de produtos por nível de risco&#13;&#10;   - Pontuação de 0 a 100 points&#13;&#10;   - Fórmula: `(aparições_nivel_dominante * 100) / total_pontuações`&#13;&#10;&#13;&#10;5. **Determinação do Perfil**&#13;&#10;   - **CONSERVADOR**: Maioria produtos de risco BAIXO&#13;&#10;   - **MODERADO**: Maioria produtos de risco MÉDIO  &#13;&#10;   - **AGRESSIVO**: Maioria produtos de risco ALTO&#13;&#10;&#13;&#10;### Níveis de Risco dos Produtos&#13;&#10;&#13;&#10;| Nível | Enum | Características |&#13;&#10;|-------|------|----------------|&#13;&#10;| **BAIXO** | `NivelRisco.BAIXO` | Produtos garantidos pelo FGC |&#13;&#10;| **MÉDIO** | `NivelRisco.MEDIO` | Renda fixa não garantida pelo FGC |&#13;&#10;| **ALTO** | `NivelRisco.ALTO` | Renda variável, sem garantias |&#13;&#10;&#13;&#10;### Casos Especiais&#13;&#10;&#13;&#10;- **Sem histórico**: Retorna erro 400&#13;&#10;- **Histórico misto**: Perfil determinado pela maioria&#13;&#10;- **Empate**: Sistema prioriza o primeiro produto na ordenação&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Informações Técnicas&#13;&#10;&#13;&#10;### Autenticação e Autorização&#13;&#10;&#13;&#10;**Roles aceitas:**&#13;&#10;- `USER`: Pode calcular perfil (sem validação de propriedade atual)&#13;&#10;- `ADMIN`: Acesso irrestrito a qualquer cliente&#13;&#10;&#13;&#10;**Token JWT deve conter:**&#13;&#10;- Role válida (`USER` ou `ADMIN`)&#13;&#10;- Token não expirado&#13;&#10;- Assinatura válida&#13;&#10;&#13;&#10;### Dependências do Cálculo&#13;&#10;&#13;&#10;O endpoint depende de:&#13;&#10;- **ClienteService**: Validação da existência do cliente&#13;&#10;- **InvestimentoRepository**: Histórico de investimentos reais&#13;&#10;- **SimulacaoRepository**: Histórico de simulações&#13;&#10;- **ProdutoRepository**: Informações dos produtos e riscos&#13;&#10;- **GeradorRecomendacaoML**: Algoritmo de machine learning&#13;&#10;&#13;&#10;### Performance&#13;&#10;&#13;&#10;- Consultas ao banco para histórico&#13;&#10;- Processamento ML pode ser intensivo&#13;&#10;- Cache não implementado (recalcula sempre)&#13;&#10;- Complexidade cresce com volume de histórico&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Exemplos de Uso&#13;&#10;&#13;&#10;### cURL&#13;&#10;&#13;&#10;**Calcular perfil de cliente específico:**&#13;&#10;```bash&#13;&#10;curl -X GET http://localhost:9090/perfil-risco/1 \&#13;&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#13;&#10;  -H &quot;Content-Type: application/json&quot;&#13;&#10;```&#13;&#10;&#13;&#10;**Exemplo com cliente sem histórico:**&#13;&#10;```bash&#13;&#10;curl -X GET http://localhost:9090/perfil-risco/999 \&#13;&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#13;&#10;  -H &quot;Content-Type: application/json&quot;&#13;&#10;```&#13;&#10;&#13;&#10;### Respostas Esperadas&#13;&#10;&#13;&#10;**Cliente com perfil conservador:**&#13;&#10;```bash&#13;&#10;HTTP/1.1 200 OK&#13;&#10;Content-Type: application/json&#13;&#10;&#13;&#10;{&#13;&#10;  &quot;clienteId&quot;: 1,&#13;&#10;  &quot;perfil&quot;: &quot;CONSERVADOR&quot;,&#13;&#10;  &quot;pontuacao&quot;: 30,&#13;&#10;  &quot;descricao&quot;: &quot;Perfil focado em segurança e liquidez, com baixa tolerância ao risco.&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Cliente não encontrado:**&#13;&#10;```bash&#13;&#10;HTTP/1.1 404 Not Found&#13;&#10;Content-Type: application/json&#13;&#10;&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Cliente não encontrado&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Cliente sem histórico:**&#13;&#10;```bash&#13;&#10;HTTP/1.1 400 Bad Request &#13;&#10;Content-Type: application/json&#13;&#10;&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Cliente não possui histórico de investimentos nem simulações para calcular perfil de risco&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;&#13;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/docs/DOCUMENTACAO_PRODUTO_RECOMENDADO.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/docs/DOCUMENTACAO_PRODUTO_RECOMENDADO.md" />
              <option name="originalContent" value="# Documentação da API - ProdutoRecomendadoResource&#10;&#10;## Visão Geral&#10;&#10;O `ProdutoRecomendadoResource` é responsável por fornecer recomendações personalizadas de produtos de investimento baseadas no perfil de risco e histórico comportamental dos clientes. Utiliza algoritmos de Machine Learning para analisar padrões de investimento e gerar sugestões adequadas.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/produtos-recomendados`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;**Autenticação global:**&#10;- **Token JWT:** OBRIGATÓRIO para todos os endpoints&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. GET /produtos-recomendados/cliente/{clienteId}&#10;**Obtém produtos recomendados baseados no histórico do cliente**&#10;&#10;#### Descrição&#10;Analisa o histórico de investimentos e simulações de um cliente específico para gerar recomendações personalizadas usando algoritmos de Machine Learning. O sistema prioriza investimentos reais e, na ausência destes, utiliza simulações como base para as recomendações.&#10;&#10;#### Algoritmo de Recomendação&#10;1. **Prioridade 1**: Histórico de investimentos reais&#10;2. **Prioridade 2**: Histórico de simulações (fallback)&#10;3. **Machine Learning**: Análise de padrões via GeradorRecomendacaoML&#10;4. **Ordenação**: Produtos ordenados por frequência de aparição&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** USERs só podem acessar seus próprios dados, ADMINs têm acesso irrestrito&#10;&#10;#### Request&#10;&#10;**URL:** `GET /produtos-recomendados/cliente/{clienteId}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `clienteId` | Long | Sim | `@Positive` | ID único do cliente (deve ser positivo) |&#10;&#10;**Exemplo:** `GET /produtos-recomendados/cliente/1`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Recomendações obtidas com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 1,&#10;    &quot;nome&quot;: &quot;CDB Banco XYZ&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 2.5,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 30,&#10;    &quot;minimo_dias_investimento&quot;: 90,&#10;    &quot;fgc&quot;: true,&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 5,&#10;    &quot;nome&quot;: &quot;Tesouro Selic 2027&quot;,&#10;    &quot;tipo&quot;: &quot;TESOURO_DIRETO&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 10.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;SELIC&quot;,&#10;    &quot;liquidez&quot;: 1,&#10;    &quot;minimo_dias_investimento&quot;: 1,&#10;    &quot;fgc&quot;: false,&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `id` | Long | ID único do produto |&#10;| `nome` | string | Nome comercial do produto |&#10;| `tipo` | enum | Tipo do produto (CDB, LCI, LCA, etc.) |&#10;| `tipo_rentabilidade` | enum | Tipo de rentabilidade (PRE, POS) |&#10;| `rentabilidade` | BigDecimal | Percentual de rentabilidade |&#10;| `periodo_rentabilidade` | enum | Período (AO_DIA, AO_MES, AO_ANO, PERIODO_TOTAL) |&#10;| `indice` | enum | Índice de referência (CDI, SELIC, IPCA, etc.) |&#10;| `liquidez` | integer | Prazo para resgate em dias (-1 = sem liquidez) |&#10;| `minimo_dias_investimento` | integer | Prazo mínimo de investimento em dias |&#10;| `fgc` | boolean | Protegido pelo Fundo Garantidor de Créditos |&#10;| `risco` | enum | Nível de risco (BAIXO, MEDIO, ALTO) |&#10;&#10;---&#10;&#10;### 2. GET /produtos-recomendados/{perfil}&#10;**Obtém produtos recomendados por perfil de risco**&#10;&#10;#### Descrição&#10;Retorna todos os produtos adequados para um perfil de risco específico. Não requer histórico do cliente, sendo baseado apenas na classificação de risco dos produtos disponíveis.&#10;&#10;#### Perfis Aceitos&#10;- **conservador**: Produtos de risco BAIXO (garantidos pelo FGC)&#10;- **moderado**: Produtos de risco MÉDIO (renda fixa sem FGC)&#10;- **agressivo**: Produtos de risco ALTO (renda variável sem FGC)&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** Não há validação específica de cliente&#10;&#10;#### Request&#10;&#10;**URL:** `GET /produtos-recomendados/{perfil}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `perfil` | string | Sim | Deve ser: conservador, moderado ou agressivo | Perfil de risco (case-insensitive) |&#10;&#10;**Exemplos:** &#10;- `GET /produtos-recomendados/conservador`&#10;- `GET /produtos-recomendados/moderado`&#10;- `GET /produtos-recomendados/agressivo`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Produtos obtidos com sucesso&#10;&#10;**Response Body para perfil conservador:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 1,&#10;    &quot;nome&quot;: &quot;CDB Banco ABC&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 1.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 90,&#10;    &quot;minimo_dias_investimento&quot;: 30,&#10;    &quot;fgc&quot;: true,&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 3,&#10;    &quot;nome&quot;: &quot;Poupança CEF&quot;,&#10;    &quot;tipo&quot;: &quot;POUPANCA&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 7.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;TR&quot;,&#10;    &quot;liquidez&quot;: 1,&#10;    &quot;minimo_dias_investimento&quot;: 1,&#10;    &quot;fgc&quot;: true,&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#10;  }&#10;]&#10;```&#10;&#10;**Response Body para perfil agressivo:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 8,&#10;    &quot;nome&quot;: &quot;Fundo Multimercado XYZ&quot;,&#10;    &quot;tipo&quot;: &quot;FUNDO&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 50.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 30,&#10;    &quot;minimo_dias_investimento&quot;: 1,&#10;    &quot;fgc&quot;: false,&#10;    &quot;risco&quot;: &quot;ALTO&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 10,&#10;    &quot;nome&quot;: &quot;VALE3&quot;,&#10;    &quot;tipo&quot;: &quot;ACAO&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 0.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_DIA&quot;,&#10;    &quot;indice&quot;: null,&#10;    &quot;liquidez&quot;: 1,&#10;    &quot;minimo_dias_investimento&quot;: 1,&#10;    &quot;fgc&quot;: false,&#10;    &quot;risco&quot;: &quot;ALTO&quot;&#10;  }&#10;]&#10;```&#10;&#10;---&#10;&#10;## Status Codes e Erros por Endpoint&#10;&#10;### GET /produtos-recomendados/cliente/{clienteId}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Recomendações geradas com sucesso |&#10;| **400** | Bad Request | Cliente sem histórico, ID inválido |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | USER tentando acessar dados de outro cliente |&#10;| **404** | Not Found | Cliente não encontrado |&#10;| **500** | Internal Server Error | Erro interno do sistema |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 400 - Bad Request&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Cliente não possui histórico de investimentos nem simulações para gerar recomendações&quot;&#10;}&#10;```&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Cliente ID não pode ser nulo&quot;&#10;}&#10;```&#10;&#10;**Quando ocorre:**&#10;- Cliente existe mas não tem investimentos nem simulações&#10;- Parâmetro clienteId inválido (não positivo)&#10;&#10;##### ❌ 401 - Unauthorized&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/produtos-recomendados/cliente/1&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/produtos-recomendados/cliente/2&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 404 - Not Found (via ClienteNotFoundException)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Cliente não encontrado&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/produtos-recomendados/cliente/999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 500 - Internal Server Error&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno no servidor&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /produtos-recomendados/{perfil}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Produtos filtrados com sucesso |&#10;| **400** | Bad Request | Perfil inválido |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não autorizada |&#10;| **500** | Internal Server Error | Erro interno do sistema |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 400 - Bad Request&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Perfil inválido: INVALIDO. Valores aceitos: Conservador, Moderado, Agressivo&quot;&#10;}&#10;```&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Perfil não pode ser nulo ou vazio&quot;&#10;}&#10;```&#10;&#10;**Quando ocorre:**&#10;- Perfil não é um dos valores aceitos (conservador, moderado, agressivo)&#10;- Perfil vazio ou nulo&#10;&#10;##### ❌ 401 - Unauthorized&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/produtos-recomendados/conservador&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/produtos-recomendados/conservador&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 500 - Internal Server Error&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno no servidor&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Consolidados&#10;&#10;| Status | Nome | Descrição | Endpoints Afetados |&#10;|--------|------|-----------|-------------------|&#10;| **200** | OK | Sucesso | Ambos |&#10;| **400** | Bad Request | Dados inválidos/insuficientes | Ambos |&#10;| **401** | Unauthorized | Token ausente/inválido | Ambos |&#10;| **403** | Forbidden | Sem permissão | Ambos |&#10;| **404** | Not Found | Cliente não encontrado | GET /cliente/{clienteId} apenas |&#10;| **500** | Internal Server Error | Erro interno | Ambos |&#10;&#10;### Categorias de Mensagens de Erro&#10;&#10;####  Erros de Validação (400)&#10;&#10;**Endpoint /cliente/{clienteId}:**&#10;- `&quot;Cliente não possui histórico de investimentos nem simulações para gerar recomendações&quot;`&#10;- `&quot;Cliente ID não pode ser nulo&quot;`&#10;&#10;**Endpoint /{perfil}:**&#10;- `&quot;Perfil inválido: {perfil}. Valores aceitos: Conservador, Moderado, Agressivo&quot;`&#10;- `&quot;Perfil não pode ser nulo ou vazio&quot;`&#10;&#10;####  Erros de Autenticação (401)&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#10;&#10;####  Erros de Autorização (403)&#10;- `&quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;` (role inválida)&#10;- `&quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;` (USER acessando outro cliente)&#10;- `&quot;Token JWT não encontrado&quot;` (token ausente)&#10;- `&quot;Acesso negado: role não autorizada&quot;` (role não permitida)&#10;&#10;####  Erros de Recurso (404)&#10;- `&quot;Cliente não encontrado&quot;` (apenas endpoint /cliente/{clienteId})&#10;&#10;####  Erros Internos (500)&#10;- `&quot;Erro interno no servidor&quot;`&#10;&#10;### Estrutura de Erros&#10;&#10;**Erros simples (400, 500):**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Mensagem do erro&quot;&#10;}&#10;```&#10;&#10;**Erros de framework (401, 403, 404):**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Mensagem detalhada&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/produtos-recomendados/cliente/1&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Perfis de Risco e Produtos&#10;&#10;### Mapeamento de Perfis&#10;&#10;| Perfil | Nível de Risco | Características | Produtos Típicos |&#10;|--------|----------------|----------------|------------------|&#10;| **Conservador** | BAIXO | Garantia FGC, baixa volatilidade | CDB, LCI, LCA, Poupança, Tesouro Direto |&#10;| **Moderado** | MÉDIO | Renda fixa sem FGC | Debêntures, CRI, Fundos DI |&#10;| **Agressivo** | ALTO | Renda variável, alta volatilidade | Ações, FII, Fundos Multimercado, ETFs |&#10;&#10;### Tipos de Produtos Disponíveis&#10;&#10;#### Renda Fixa (Baixo/Médio Risco)&#10;- **CDB**: Certificado de Depósito Bancário&#10;- **LCI**: Letra de Crédito Imobiliário&#10;- **LCA**: Letra de Crédito do Agronegócio&#10;- **TESOURO_DIRETO**: Títulos do Tesouro Nacional&#10;- **POUPANCA**: Caderneta de Poupança&#10;- **DEBENTURE**: Debêntures corporativas&#10;- **CRI**: Certificado de Recebíveis Imobiliários&#10;&#10;#### Renda Variável (Alto Risco)&#10;- **FUNDO**: Fundos de Investimento&#10;- **FII**: Fundos de Investimento Imobiliário&#10;- **ACAO**: Ações de empresas&#10;- **ETF**: Exchange Traded Funds&#10;&#10;### Algoritmo de Machine Learning&#10;&#10;#### Para endpoint /cliente/{clienteId}:&#10;1. **Coleta de Dados**: Investimentos reais → Simulações (fallback)&#10;2. **Análise ML**: `GeradorRecomendacaoML.encontrarProdutosOrdenadosPorAparicao`&#10;3. **Ordenação**: Por frequência de aparição no histórico&#10;4. **Resultado**: Lista ordenada de produtos mais adequados&#10;&#10;#### Para endpoint /{perfil}:&#10;1. **Mapeamento**: Perfil → NivelRisco enum&#10;2. **Filtro**: Produtos com risco correspondente&#10;3. **Resultado**: Todos os produtos do nível de risco&#10;&#10;---&#10;&#10;## Informações Técnicas&#10;&#10;### Autenticação e Autorização&#10;&#10;**Validação de Acesso (endpoint /cliente/{clienteId}):**&#10;- Utiliza `JwtAuthorizationHelper.validarAcessoAoCliente()`&#10;- **ADMIN**: Acesso irrestrito&#10;- **USER**: Apenas seus próprios dados (baseado em `userId` no JWT)&#10;&#10;**Token JWT deve conter:**&#10;- Role válida (`USER` ou `ADMIN`)&#10;- `userId` (para validação de propriedade)&#10;- Token não expirado&#10;&#10;### Dependências do Sistema&#10;&#10;- **ClienteService**: Validação da existência do cliente&#10;- **ProdutoRepository**: Busca de produtos disponíveis&#10;- **InvestimentoRepository**: Histórico de investimentos reais&#10;- **SimulacaoRepository**: Histórico de simulações&#10;- **GeradorRecomendacaoML**: Algoritmo de machine learning&#10;- **ProdutoMapper**: Conversão entidade → DTO&#10;&#10;### Performance&#10;&#10;- **Cache**: Não implementado (consulta sempre atualizada)&#10;- **ML Processing**: Pode ser intensivo com histórico extenso&#10;- **Database Queries**: Múltiplas consultas por request&#10;- **Complexidade**: O(n) onde n = tamanho do histórico&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Recomendações por cliente:**&#10;```bash&#10;curl -X GET http://localhost:9090/produtos-recomendados/cliente/1 \&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Recomendações por perfil conservador:**&#10;```bash&#10;curl -X GET http://localhost:9090/produtos-recomendados/conservador \&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Recomendações por perfil agressivo:**&#10;```bash&#10;curl -X GET http://localhost:9090/produtos-recomendados/agressivo \&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;### Respostas Típicas&#10;&#10;**Cliente com histórico rico:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 1,&#10;    &quot;nome&quot;: &quot;CDB Premium&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;rentabilidade&quot;: 5.0,&#10;    &quot;risco&quot;: &quot;BAIXO&quot;,&#10;    &quot;fgc&quot;: true&#10;  }&#10;]&#10;```&#10;&#10;**Cliente sem histórico:**&#10;```bash&#10;HTTP/1.1 400 Bad Request&#10;{&#10;  &quot;message&quot;: &quot;Cliente não possui histórico de investimentos nem simulações para gerar recomendações&quot;&#10;}&#10;```&#10;&#10;**Perfil inválido:**&#10;```bash&#10;HTTP/1.1 400 Bad Request&#10;{&#10;  &quot;message&quot;: &quot;Perfil inválido: INEXISTENTE. Valores aceitos: Conservador, Moderado, Agressivo&quot;&#10;}&#10;```&#10;&#10;&#10;&#10;---&#10;&#10;## Casos de Uso Típicos&#10;&#10;### 1. Recomendação Personalizada&#10;**Cenário**: Cliente logado quer ver produtos adequados&#10;```&#10;GET /produtos-recomendados/cliente/{meuId}&#10;→ Lista baseada no meu histórico real&#10;```&#10;&#10;### 2. Exploração por Perfil&#10;**Cenário**: Cliente quer ver produtos de um perfil específico&#10;```&#10;GET /produtos-recomendados/conservador&#10;→ Todos os produtos de baixo risco&#10;```&#10;&#10;### 3. Onboarding de Cliente&#10;**Cenário**: Cliente novo sem histórico&#10;```&#10;GET /produtos-recomendados/cliente/novo&#10;→ 400: Sem histórico&#10;GET /produtos-recomendados/moderado  &#10;→ Produtos padrão para começar&#10;```&#10;&#10;### 4. Assessment de Produtos&#10;**Cenário**: Ver diferenças entre perfis&#10;```&#10;GET /produtos-recomendados/conservador  → Produtos seguros&#10;GET /produtos-recomendados/agressivo    → Produtos arriscados&#10;```&#10;&#10;" />
              <option name="updatedContent" value="# Documentação da API - ProdutoRecomendadoResource&#13;&#10;&#13;&#10;## Visão Geral&#13;&#10;&#13;&#10;O `ProdutoRecomendadoResource` é responsável por fornecer recomendações personalizadas de produtos de investimento baseadas no perfil de risco e histórico comportamental dos clientes. Utiliza algoritmos de Machine Learning para analisar padrões de investimento e gerar sugestões adequadas.&#13;&#10;&#13;&#10;**Servidor:** `http://localhost:9090`&#13;&#10;&#13;&#10;**Base Path:** `/produtos-recomendados`&#13;&#10;&#13;&#10;**Formatos suportados:**&#13;&#10;- Content-Type: `application/json`&#13;&#10;- Accept: `application/json`&#13;&#10;&#13;&#10;**Autenticação global:**&#13;&#10;- **Token JWT:** OBRIGATÓRIO para todos os endpoints&#13;&#10;- **Roles permitidas:** `USER`, `ADMIN`&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Endpoints&#13;&#10;&#13;&#10;### 1. GET /produtos-recomendados/cliente/{clienteId}&#10;**Obtém produtos recomendados baseados no histórico do cliente**&#10;&#10;`http://localhost:9090/produtos-recomendados/cliente/{clienteId}`&#10;&#10;#### Descrição&#13;&#10;Analisa o histórico de investimentos e simulações de um cliente específico para gerar recomendações personalizadas usando algoritmos de Machine Learning. O sistema prioriza investimentos reais e, na ausência destes, utiliza simulações como base para as recomendações.&#13;&#10;&#13;&#10;#### Algoritmo de Recomendação&#13;&#10;1. **Prioridade 1**: Histórico de investimentos reais&#13;&#10;2. **Prioridade 2**: Histórico de simulações (fallback)&#13;&#10;3. **Machine Learning**: Análise de padrões via GeradorRecomendacaoML&#13;&#10;4. **Ordenação**: Produtos ordenados por frequência de aparição&#13;&#10;&#13;&#10;#### Autenticação&#13;&#10;- **Token JWT:** OBRIGATÓRIO&#13;&#10;- **Roles permitidas:** `USER`, `ADMIN`&#13;&#10;- **Validação de Acesso:** USERs só podem acessar seus próprios dados, ADMINs têm acesso irrestrito&#13;&#10;&#13;&#10;#### Request&#13;&#10;&#13;&#10;**URL:** `GET /produtos-recomendados/cliente/{clienteId}`&#13;&#10;&#13;&#10;**Headers obrigatórios:**&#13;&#10;```&#13;&#10;Authorization: Bearer {jwt_token}&#13;&#10;Content-Type: application/json&#13;&#10;```&#13;&#10;&#13;&#10;**Path Parameters:**&#13;&#10;&#13;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#13;&#10;|-----------|------|-------------|-----------|-----------|&#13;&#10;| `clienteId` | Long | Sim | `@Positive` | ID único do cliente (deve ser positivo) |&#13;&#10;&#13;&#10;**Exemplo:** `GET /produtos-recomendados/cliente/1`&#13;&#10;&#13;&#10;#### Responses&#13;&#10;&#13;&#10;##### ✅ 200 - Recomendações obtidas com sucesso&#13;&#10;&#13;&#10;**Response Body:**&#13;&#10;```json&#13;&#10;[&#13;&#10;  {&#13;&#10;    &quot;id&quot;: 1,&#13;&#10;    &quot;nome&quot;: &quot;CDB Banco XYZ&quot;,&#13;&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#13;&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#13;&#10;    &quot;rentabilidade&quot;: 2.5,&#13;&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#13;&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#13;&#10;    &quot;liquidez&quot;: 30,&#13;&#10;    &quot;minimo_dias_investimento&quot;: 90,&#13;&#10;    &quot;fgc&quot;: true,&#13;&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#13;&#10;  },&#13;&#10;  {&#13;&#10;    &quot;id&quot;: 5,&#13;&#10;    &quot;nome&quot;: &quot;Tesouro Selic 2027&quot;,&#13;&#10;    &quot;tipo&quot;: &quot;TESOURO_DIRETO&quot;,&#13;&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#13;&#10;    &quot;rentabilidade&quot;: 10.0,&#13;&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#13;&#10;    &quot;indice&quot;: &quot;SELIC&quot;,&#13;&#10;    &quot;liquidez&quot;: 1,&#13;&#10;    &quot;minimo_dias_investimento&quot;: 1,&#13;&#10;    &quot;fgc&quot;: false,&#13;&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#13;&#10;  }&#13;&#10;]&#13;&#10;```&#13;&#10;&#13;&#10;**Campos da Response:**&#13;&#10;&#13;&#10;| Campo | Tipo | Descrição |&#13;&#10;|-------|------|-----------|&#13;&#10;| `id` | Long | ID único do produto |&#13;&#10;| `nome` | string | Nome comercial do produto |&#13;&#10;| `tipo` | enum | Tipo do produto (CDB, LCI, LCA, etc.) |&#13;&#10;| `tipo_rentabilidade` | enum | Tipo de rentabilidade (PRE, POS) |&#13;&#10;| `rentabilidade` | BigDecimal | Percentual de rentabilidade |&#13;&#10;| `periodo_rentabilidade` | enum | Período (AO_DIA, AO_MES, AO_ANO, PERIODO_TOTAL) |&#13;&#10;| `indice` | enum | Índice de referência (CDI, SELIC, IPCA, etc.) |&#13;&#10;| `liquidez` | integer | Prazo para resgate em dias (-1 = sem liquidez) |&#13;&#10;| `minimo_dias_investimento` | integer | Prazo mínimo de investimento em dias |&#13;&#10;| `fgc` | boolean | Protegido pelo Fundo Garantidor de Créditos |&#13;&#10;| `risco` | enum | Nível de risco (BAIXO, MEDIO, ALTO) |&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;### 2. GET /produtos-recomendados/{perfil}&#13;&#10;**Obtém produtos recomendados por perfil de risco**&#13;&#10;&#13;&#10;#### Descrição&#13;&#10;Retorna todos os produtos adequados para um perfil de risco específico. Não requer histórico do cliente, sendo baseado apenas na classificação de risco dos produtos disponíveis.&#13;&#10;&#13;&#10;#### Perfis Aceitos&#13;&#10;- **conservador**: Produtos de risco BAIXO (garantidos pelo FGC)&#13;&#10;- **moderado**: Produtos de risco MÉDIO (renda fixa sem FGC)&#13;&#10;- **agressivo**: Produtos de risco ALTO (renda variável sem FGC)&#13;&#10;&#13;&#10;#### Autenticação&#13;&#10;- **Token JWT:** OBRIGATÓRIO&#13;&#10;- **Roles permitidas:** `USER`, `ADMIN`&#13;&#10;- **Validação de Acesso:** Não há validação específica de cliente&#13;&#10;&#13;&#10;#### Request&#13;&#10;&#13;&#10;**URL:** `GET /produtos-recomendados/{perfil}`&#13;&#10;&#13;&#10;**Headers obrigatórios:**&#13;&#10;```&#13;&#10;Authorization: Bearer {jwt_token}&#13;&#10;Content-Type: application/json&#13;&#10;```&#13;&#10;&#13;&#10;**Path Parameters:**&#13;&#10;&#13;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#13;&#10;|-----------|------|-------------|-----------|-----------|&#13;&#10;| `perfil` | string | Sim | Deve ser: conservador, moderado ou agressivo | Perfil de risco (case-insensitive) |&#13;&#10;&#13;&#10;**Exemplos:** &#13;&#10;- `GET /produtos-recomendados/conservador`&#13;&#10;- `GET /produtos-recomendados/moderado`&#13;&#10;- `GET /produtos-recomendados/agressivo`&#13;&#10;&#13;&#10;#### Responses&#13;&#10;&#13;&#10;##### ✅ 200 - Produtos obtidos com sucesso&#13;&#10;&#13;&#10;**Response Body para perfil conservador:**&#13;&#10;```json&#13;&#10;[&#13;&#10;  {&#13;&#10;    &quot;id&quot;: 1,&#13;&#10;    &quot;nome&quot;: &quot;CDB Banco ABC&quot;,&#13;&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#13;&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#13;&#10;    &quot;rentabilidade&quot;: 1.0,&#13;&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#13;&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#13;&#10;    &quot;liquidez&quot;: 90,&#13;&#10;    &quot;minimo_dias_investimento&quot;: 30,&#13;&#10;    &quot;fgc&quot;: true,&#13;&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#13;&#10;  },&#13;&#10;  {&#13;&#10;    &quot;id&quot;: 3,&#13;&#10;    &quot;nome&quot;: &quot;Poupança CEF&quot;,&#13;&#10;    &quot;tipo&quot;: &quot;POUPANCA&quot;,&#13;&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#13;&#10;    &quot;rentabilidade&quot;: 7.0,&#13;&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#13;&#10;    &quot;indice&quot;: &quot;TR&quot;,&#13;&#10;    &quot;liquidez&quot;: 1,&#13;&#10;    &quot;minimo_dias_investimento&quot;: 1,&#13;&#10;    &quot;fgc&quot;: true,&#13;&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#13;&#10;  }&#13;&#10;]&#13;&#10;```&#13;&#10;&#13;&#10;**Response Body para perfil agressivo:**&#13;&#10;```json&#13;&#10;[&#13;&#10;  {&#13;&#10;    &quot;id&quot;: 8,&#13;&#10;    &quot;nome&quot;: &quot;Fundo Multimercado XYZ&quot;,&#13;&#10;    &quot;tipo&quot;: &quot;FUNDO&quot;,&#13;&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#13;&#10;    &quot;rentabilidade&quot;: 50.0,&#13;&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#13;&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#13;&#10;    &quot;liquidez&quot;: 30,&#13;&#10;    &quot;minimo_dias_investimento&quot;: 1,&#13;&#10;    &quot;fgc&quot;: false,&#13;&#10;    &quot;risco&quot;: &quot;ALTO&quot;&#13;&#10;  },&#13;&#10;  {&#13;&#10;    &quot;id&quot;: 10,&#13;&#10;    &quot;nome&quot;: &quot;VALE3&quot;,&#13;&#10;    &quot;tipo&quot;: &quot;ACAO&quot;,&#13;&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#13;&#10;    &quot;rentabilidade&quot;: 0.0,&#13;&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_DIA&quot;,&#13;&#10;    &quot;indice&quot;: null,&#13;&#10;    &quot;liquidez&quot;: 1,&#13;&#10;    &quot;minimo_dias_investimento&quot;: 1,&#13;&#10;    &quot;fgc&quot;: false,&#13;&#10;    &quot;risco&quot;: &quot;ALTO&quot;&#13;&#10;  }&#13;&#10;]&#13;&#10;```&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Status Codes e Erros por Endpoint&#13;&#10;&#13;&#10;### GET /produtos-recomendados/cliente/{clienteId}&#13;&#10;&#13;&#10;#### Status Codes Possíveis&#13;&#10;| Status | Descrição | Quando Ocorre |&#13;&#10;|--------|-----------|---------------|&#13;&#10;| **200** | OK | Recomendações geradas com sucesso |&#13;&#10;| **400** | Bad Request | Cliente sem histórico, ID inválido |&#13;&#10;| **401** | Unauthorized | Token ausente/inválido |&#13;&#10;| **403** | Forbidden | USER tentando acessar dados de outro cliente |&#13;&#10;| **404** | Not Found | Cliente não encontrado |&#13;&#10;| **500** | Internal Server Error | Erro interno do sistema |&#13;&#10;&#13;&#10;#### Mensagens de Erro Possíveis&#13;&#10;&#13;&#10;##### ❌ 400 - Bad Request&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Cliente não possui histórico de investimentos nem simulações para gerar recomendações&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Cliente ID não pode ser nulo&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Quando ocorre:**&#13;&#10;- Cliente existe mas não tem investimentos nem simulações&#13;&#10;- Parâmetro clienteId inválido (não positivo)&#13;&#10;&#13;&#10;##### ❌ 401 - Unauthorized&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 401,&#13;&#10;  &quot;path&quot;: &quot;/produtos-recomendados/cliente/1&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;##### ❌ 403 - Forbidden&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 403,&#13;&#10;  &quot;path&quot;: &quot;/produtos-recomendados/cliente/2&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;##### ❌ 404 - Not Found (via ClienteNotFoundException)&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Cliente não encontrado&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 404,&#13;&#10;  &quot;path&quot;: &quot;/produtos-recomendados/cliente/999&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;##### ❌ 500 - Internal Server Error&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Erro interno no servidor&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;### GET /produtos-recomendados/{perfil}&#13;&#10;&#13;&#10;#### Status Codes Possíveis&#13;&#10;| Status | Descrição | Quando Ocorre |&#13;&#10;|--------|-----------|---------------|&#13;&#10;| **200** | OK | Produtos filtrados com sucesso |&#13;&#10;| **400** | Bad Request | Perfil inválido |&#13;&#10;| **401** | Unauthorized | Token ausente/inválido |&#13;&#10;| **403** | Forbidden | Role não autorizada |&#13;&#10;| **500** | Internal Server Error | Erro interno do sistema |&#13;&#10;&#13;&#10;#### Mensagens de Erro Possíveis&#13;&#10;&#13;&#10;##### ❌ 400 - Bad Request&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Perfil inválido: INVALIDO. Valores aceitos: Conservador, Moderado, Agressivo&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Perfil não pode ser nulo ou vazio&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Quando ocorre:**&#13;&#10;- Perfil não é um dos valores aceitos (conservador, moderado, agressivo)&#13;&#10;- Perfil vazio ou nulo&#13;&#10;&#13;&#10;##### ❌ 401 - Unauthorized&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 401,&#13;&#10;  &quot;path&quot;: &quot;/produtos-recomendados/conservador&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;##### ❌ 403 - Forbidden&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 403,&#13;&#10;  &quot;path&quot;: &quot;/produtos-recomendados/conservador&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;##### ❌ 500 - Internal Server Error&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Erro interno no servidor&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#13;&#10;&#13;&#10;### Status Codes Consolidados&#13;&#10;&#13;&#10;| Status | Nome | Descrição | Endpoints Afetados |&#13;&#10;|--------|------|-----------|-------------------|&#13;&#10;| **200** | OK | Sucesso | Ambos |&#13;&#10;| **400** | Bad Request | Dados inválidos/insuficientes | Ambos |&#13;&#10;| **401** | Unauthorized | Token ausente/inválido | Ambos |&#13;&#10;| **403** | Forbidden | Sem permissão | Ambos |&#13;&#10;| **404** | Not Found | Cliente não encontrado | GET /cliente/{clienteId} apenas |&#13;&#10;| **500** | Internal Server Error | Erro interno | Ambos |&#13;&#10;&#13;&#10;### Categorias de Mensagens de Erro&#13;&#10;&#13;&#10;####  Erros de Validação (400)&#13;&#10;&#13;&#10;**Endpoint /cliente/{clienteId}:**&#13;&#10;- `&quot;Cliente não possui histórico de investimentos nem simulações para gerar recomendações&quot;`&#13;&#10;- `&quot;Cliente ID não pode ser nulo&quot;`&#13;&#10;&#13;&#10;**Endpoint /{perfil}:**&#13;&#10;- `&quot;Perfil inválido: {perfil}. Valores aceitos: Conservador, Moderado, Agressivo&quot;`&#13;&#10;- `&quot;Perfil não pode ser nulo ou vazio&quot;`&#13;&#10;&#13;&#10;####  Erros de Autenticação (401)&#13;&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#13;&#10;&#13;&#10;####  Erros de Autorização (403)&#13;&#10;- `&quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;` (role inválida)&#13;&#10;- `&quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;` (USER acessando outro cliente)&#13;&#10;- `&quot;Token JWT não encontrado&quot;` (token ausente)&#13;&#10;- `&quot;Acesso negado: role não autorizada&quot;` (role não permitida)&#13;&#10;&#13;&#10;####  Erros de Recurso (404)&#13;&#10;- `&quot;Cliente não encontrado&quot;` (apenas endpoint /cliente/{clienteId})&#13;&#10;&#13;&#10;####  Erros Internos (500)&#13;&#10;- `&quot;Erro interno no servidor&quot;`&#13;&#10;&#13;&#10;### Estrutura de Erros&#13;&#10;&#13;&#10;**Erros simples (400, 500):**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Mensagem do erro&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Erros de framework (401, 403, 404):**&#13;&#10;```json&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Mensagem detalhada&quot;,&#13;&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#13;&#10;  &quot;status&quot;: 403,&#13;&#10;  &quot;path&quot;: &quot;/produtos-recomendados/cliente/1&quot;,&#13;&#10;  &quot;errors&quot;: null&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Perfis de Risco e Produtos&#13;&#10;&#13;&#10;### Mapeamento de Perfis&#13;&#10;&#13;&#10;| Perfil | Nível de Risco | Características | Produtos Típicos |&#13;&#10;|--------|----------------|----------------|------------------|&#13;&#10;| **Conservador** | BAIXO | Garantia FGC, baixa volatilidade | CDB, LCI, LCA, Poupança, Tesouro Direto |&#13;&#10;| **Moderado** | MÉDIO | Renda fixa sem FGC | Debêntures, CRI, Fundos DI |&#13;&#10;| **Agressivo** | ALTO | Renda variável, alta volatilidade | Ações, FII, Fundos Multimercado, ETFs |&#13;&#10;&#13;&#10;### Tipos de Produtos Disponíveis&#13;&#10;&#13;&#10;#### Renda Fixa (Baixo/Médio Risco)&#13;&#10;- **CDB**: Certificado de Depósito Bancário&#13;&#10;- **LCI**: Letra de Crédito Imobiliário&#13;&#10;- **LCA**: Letra de Crédito do Agronegócio&#13;&#10;- **TESOURO_DIRETO**: Títulos do Tesouro Nacional&#13;&#10;- **POUPANCA**: Caderneta de Poupança&#13;&#10;- **DEBENTURE**: Debêntures corporativas&#13;&#10;- **CRI**: Certificado de Recebíveis Imobiliários&#13;&#10;&#13;&#10;#### Renda Variável (Alto Risco)&#13;&#10;- **FUNDO**: Fundos de Investimento&#13;&#10;- **FII**: Fundos de Investimento Imobiliário&#13;&#10;- **ACAO**: Ações de empresas&#13;&#10;- **ETF**: Exchange Traded Funds&#13;&#10;&#13;&#10;### Algoritmo de Machine Learning&#13;&#10;&#13;&#10;#### Para endpoint /cliente/{clienteId}:&#13;&#10;1. **Coleta de Dados**: Investimentos reais → Simulações (fallback)&#13;&#10;2. **Análise ML**: `GeradorRecomendacaoML.encontrarProdutosOrdenadosPorAparicao`&#13;&#10;3. **Ordenação**: Por frequência de aparição no histórico&#13;&#10;4. **Resultado**: Lista ordenada de produtos mais adequados&#13;&#10;&#13;&#10;#### Para endpoint /{perfil}:&#13;&#10;1. **Mapeamento**: Perfil → NivelRisco enum&#13;&#10;2. **Filtro**: Produtos com risco correspondente&#13;&#10;3. **Resultado**: Todos os produtos do nível de risco&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Informações Técnicas&#13;&#10;&#13;&#10;### Autenticação e Autorização&#13;&#10;&#13;&#10;**Validação de Acesso (endpoint /cliente/{clienteId}):**&#13;&#10;- Utiliza `JwtAuthorizationHelper.validarAcessoAoCliente()`&#13;&#10;- **ADMIN**: Acesso irrestrito&#13;&#10;- **USER**: Apenas seus próprios dados (baseado em `userId` no JWT)&#13;&#10;&#13;&#10;**Token JWT deve conter:**&#13;&#10;- Role válida (`USER` ou `ADMIN`)&#13;&#10;- `userId` (para validação de propriedade)&#13;&#10;- Token não expirado&#13;&#10;&#13;&#10;### Dependências do Sistema&#13;&#10;&#13;&#10;- **ClienteService**: Validação da existência do cliente&#13;&#10;- **ProdutoRepository**: Busca de produtos disponíveis&#13;&#10;- **InvestimentoRepository**: Histórico de investimentos reais&#13;&#10;- **SimulacaoRepository**: Histórico de simulações&#13;&#10;- **GeradorRecomendacaoML**: Algoritmo de machine learning&#13;&#10;- **ProdutoMapper**: Conversão entidade → DTO&#13;&#10;&#13;&#10;### Performance&#13;&#10;&#13;&#10;- **Cache**: Não implementado (consulta sempre atualizada)&#13;&#10;- **ML Processing**: Pode ser intensivo com histórico extenso&#13;&#10;- **Database Queries**: Múltiplas consultas por request&#13;&#10;- **Complexidade**: O(n) onde n = tamanho do histórico&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Exemplos de Uso&#13;&#10;&#13;&#10;### cURL&#13;&#10;&#13;&#10;**Recomendações por cliente:**&#13;&#10;```bash&#13;&#10;curl -X GET http://localhost:9090/produtos-recomendados/cliente/1 \&#13;&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#13;&#10;  -H &quot;Content-Type: application/json&quot;&#13;&#10;```&#13;&#10;&#13;&#10;**Recomendações por perfil conservador:**&#13;&#10;```bash&#13;&#10;curl -X GET http://localhost:9090/produtos-recomendados/conservador \&#13;&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#13;&#10;  -H &quot;Content-Type: application/json&quot;&#13;&#10;```&#13;&#10;&#13;&#10;**Recomendações por perfil agressivo:**&#13;&#10;```bash&#13;&#10;curl -X GET http://localhost:9090/produtos-recomendados/agressivo \&#13;&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#13;&#10;  -H &quot;Content-Type: application/json&quot;&#13;&#10;```&#13;&#10;&#13;&#10;### Respostas Típicas&#13;&#10;&#13;&#10;**Cliente com histórico rico:**&#13;&#10;```json&#13;&#10;[&#13;&#10;  {&#13;&#10;    &quot;id&quot;: 1,&#13;&#10;    &quot;nome&quot;: &quot;CDB Premium&quot;,&#13;&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#13;&#10;    &quot;rentabilidade&quot;: 5.0,&#13;&#10;    &quot;risco&quot;: &quot;BAIXO&quot;,&#13;&#10;    &quot;fgc&quot;: true&#13;&#10;  }&#13;&#10;]&#13;&#10;```&#13;&#10;&#13;&#10;**Cliente sem histórico:**&#13;&#10;```bash&#13;&#10;HTTP/1.1 400 Bad Request&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Cliente não possui histórico de investimentos nem simulações para gerar recomendações&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;**Perfil inválido:**&#13;&#10;```bash&#13;&#10;HTTP/1.1 400 Bad Request&#13;&#10;{&#13;&#10;  &quot;message&quot;: &quot;Perfil inválido: INEXISTENTE. Valores aceitos: Conservador, Moderado, Agressivo&quot;&#13;&#10;}&#13;&#10;```&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;---&#13;&#10;&#13;&#10;## Casos de Uso Típicos&#13;&#10;&#13;&#10;### 1. Recomendação Personalizada&#13;&#10;**Cenário**: Cliente logado quer ver produtos adequados&#13;&#10;```&#13;&#10;GET /produtos-recomendados/cliente/{meuId}&#13;&#10;→ Lista baseada no meu histórico real&#13;&#10;```&#13;&#10;&#13;&#10;### 2. Exploração por Perfil&#13;&#10;**Cenário**: Cliente quer ver produtos de um perfil específico&#13;&#10;```&#13;&#10;GET /produtos-recomendados/conservador&#13;&#10;→ Todos os produtos de baixo risco&#13;&#10;```&#13;&#10;&#13;&#10;### 3. Onboarding de Cliente&#13;&#10;**Cenário**: Cliente novo sem histórico&#13;&#10;```&#13;&#10;GET /produtos-recomendados/cliente/novo&#13;&#10;→ 400: Sem histórico&#13;&#10;GET /produtos-recomendados/moderado  &#13;&#10;→ Produtos padrão para começar&#13;&#10;```&#13;&#10;&#13;&#10;### 4. Assessment de Produtos&#13;&#10;**Cenário**: Ver diferenças entre perfis&#13;&#10;```&#13;&#10;GET /produtos-recomendados/conservador  → Produtos seguros&#13;&#10;GET /produtos-recomendados/agressivo    → Produtos arriscados&#13;&#10;```&#13;&#10;&#13;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/docs/DOCUMENTACAO_PRODUTO_RESOURCE.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/docs/DOCUMENTACAO_PRODUTO_RESOURCE.md" />
              <option name="originalContent" value="# Documentação da API - ProdutoResource&#10;&#10;## Visão Geral&#10;&#10;O `ProdutoResource` é responsável pelo gerenciamento completo dos produtos de investimento disponíveis na plataforma. Permite consultar, criar, atualizar e filtrar produtos financeiros com diferentes características de rentabilidade, risco e liquidez.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/produtos`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;**Autenticação global:**&#10;- **Token JWT:** OBRIGATÓRIO para todos os endpoints&#10;- **Roles permitidas:** Varia por endpoint (USER/ADMIN)&#10;&#10;**Características:**&#10;- **CRUD completo**: Criar, ler, atualizar e contar produtos&#10;- **Filtros avançados**: Busca por múltiplos critérios&#10;- **Validações rigorosas**: Bean Validation + validação customizada&#10;- **Controle de acesso**: Operações de escrita restritas a ADMIN&#10;- **Enums estruturados**: Tipos e características padronizadas&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. GET /produtos&#10;**Lista produtos com filtros opcionais**&#10;&#10;#### Descrição&#10;Retorna uma lista de produtos de investimento disponíveis na plataforma. Suporta filtros via query parameters para busca específica por características do produto. Se nenhum filtro for aplicado, retorna todos os produtos cadastrados.&#10;&#10;#### Algoritmo de Filtragem&#10;1. **Priorização**: Filtros são aplicados em ordem de especificidade&#10;2. **Exclusividade**: Apenas um filtro é aplicado por requisição&#10;3. **Fallback**: Sem filtros = listagem completa&#10;4. **Ordem de precedência**:&#10;   - `tipo` → `tipo_rentabilidade` → `fgc` → `liquidez_imediata` → `sem_liquidez` → `nome` → todos&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** Qualquer usuário autenticado pode consultar&#10;&#10;#### Request&#10;&#10;**URL:** `GET /produtos`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Query Parameters (todos opcionais):**&#10;&#10;| Parâmetro | Tipo | Descrição | Valores Possíveis |&#10;|-----------|------|-----------|-------------------|&#10;| `tipo` | enum | Filtra por tipo de produto | CDB, LCI, LCA, TESOURO_DIRETO, POUPANCA, DEBENTURE, CRI, FUNDO, FII, ACAO, ETF |&#10;| `tipo_rentabilidade` | enum | Filtra por tipo de rentabilidade | PRE, POS |&#10;| `fgc` | boolean | Produtos protegidos pelo FGC | true, false |&#10;| `liquidez_imediata` | boolean | Produtos com liquidez imediata | true, false |&#10;| `sem_liquidez` | boolean | Produtos sem liquidez | true, false |&#10;| `nome` | string | Busca por nome (contém texto) | Qualquer texto não vazio |&#10;&#10;**Exemplos de URLs:**&#10;```&#10;GET /produtos&#10;GET /produtos?tipo=CDB&#10;GET /produtos?tipo_rentabilidade=POS&#10;GET /produtos?fgc=true&#10;GET /produtos?liquidez_imediata=true&#10;GET /produtos?sem_liquidez=true&#10;GET /produtos?nome=Premium&#10;```&#10;&#10;**Regras de Filtragem:**&#10;- **Um filtro por vez**: Se múltiplos filtros forem fornecidos, apenas o primeiro na ordem de precedência será aplicado&#10;- **Case sensitive**: Enum values devem ser exatos&#10;- **Nome flexível**: Busca por substring (case insensitive)&#10;- **Boolean explícito**: `fgc=true` filtra produtos COM FGC; `fgc=false` não filtra&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 1,&#10;    &quot;nome&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 20.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 90,&#10;    &quot;minimo_dias_investimento&quot;: 30,&#10;    &quot;fgc&quot;: true,&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 2,&#10;    &quot;nome&quot;: &quot;LCI Premium Pré-fixada&quot;,&#10;    &quot;tipo&quot;: &quot;LCI&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;PRE&quot;,&#10;    &quot;rentabilidade&quot;: 11.5,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;NENHUM&quot;,&#10;    &quot;liquidez&quot;: -1,&#10;    &quot;minimo_dias_investimento&quot;: 90,&#10;    &quot;fgc&quot;: true,&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `id` | Long | ID único do produto |&#10;| `nome` | String | Nome completo do produto |&#10;| `tipo` | enum | Tipo de produto financeiro |&#10;| `tipo_rentabilidade` | enum | PRE (pré-fixado) ou POS (pós-fixado) |&#10;| `rentabilidade` | BigDecimal | Taxa/percentual de rentabilidade |&#10;| `periodo_rentabilidade` | enum | Periodicidade da rentabilidade |&#10;| `indice` | enum | Índice de referência (CDI, SELIC, etc.) |&#10;| `liquidez` | Integer | Dias para liquidez (-1 = sem liquidez, &gt;= 0 = dias) |&#10;| `minimo_dias_investimento` | Integer | Prazo mínimo obrigatório |&#10;| `fgc` | Boolean | Protegido pelo Fundo Garantidor de Créditos |&#10;| `risco` | enum | Nível de risco (BAIXO, MEDIO, ALTO) |&#10;&#10;---&#10;&#10;### 2. GET /produtos/{id}&#10;**Busca produto específico por ID**&#10;&#10;#### Descrição&#10;Retorna os detalhes completos de um produto específico através do seu ID único. Utilizado para consulta detalhada de produtos individuais.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** Qualquer usuário autenticado pode consultar&#10;&#10;#### Request&#10;&#10;**URL:** `GET /produtos/{id}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `id` | Long | **Sim** | `@NotNull` | ID único do produto |&#10;&#10;**Exemplo:** `GET /produtos/1`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Produto encontrado&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 1,&#10;  &quot;nome&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;  &quot;tipo&quot;: &quot;CDB&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;rentabilidade&quot;: 20.0,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 90,&#10;  &quot;minimo_dias_investimento&quot;: 30,&#10;  &quot;fgc&quot;: true,&#10;  &quot;risco&quot;: &quot;BAIXO&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 3. POST /produtos&#10;**Cria um novo produto**&#10;&#10;#### Descrição&#10;Cria um novo produto de investimento na plataforma. Realiza validações completas dos dados fornecidos, incluindo validação customizada da consistência entre tipo de rentabilidade e índice.&#10;&#10;#### Validações Aplicadas&#10;1. **Bean Validation**: Campos obrigatórios, tamanhos e formatos&#10;2. **Validação customizada**: Consistência rentabilidade-índice&#10;3. **Regras de negócio**: Lógica específica do domínio&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;- **Validação de Acesso:** Apenas administradores podem criar produtos&#10;&#10;#### Request&#10;&#10;**URL:** `POST /produtos`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Body (JSON):**&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;CDB Premium 125% CDI&quot;,&#10;  &quot;tipo&quot;: &quot;CDB&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;rentabilidade&quot;: 25.0,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 30,&#10;  &quot;minimo_dias_investimento&quot;: 30,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;&#10;**Campos do Request:**&#10;&#10;| Campo | Tipo | Obrigatório | Validação | Descrição |&#10;|-------|------|-------------|-----------|-----------|&#10;| `nome` | String | **Sim** | `@NotBlank`, `@Size(min=2, max=255)` | Nome do produto (2-255 caracteres) |&#10;| `tipo` | enum | **Sim** | `@NotNull` | Tipo de produto financeiro |&#10;| `tipo_rentabilidade` | enum | **Sim** | `@NotNull` | PRE ou POS |&#10;| `rentabilidade` | BigDecimal | **Sim** | `@NotNull`, `@DecimalMin(&quot;0.0&quot;)` | Taxa de rentabilidade (&gt;= 0) |&#10;| `periodo_rentabilidade` | enum | **Sim** | `@NotNull` | AO_DIA, AO_MES, AO_ANO, PERIODO_TOTAL |&#10;| `indice` | enum | Condicional | `@ValidRentabilidadeIndice` | Obrigatório se POS, opcional se PRE |&#10;| `liquidez` | Integer | **Sim** | `@NotNull`, `@Min(-1)` | -1 (sem liquidez) ou &gt;= 0 (dias) |&#10;| `minimo_dias_investimento` | Integer | **Sim** | `@NotNull`, `@Min(0)` | Prazo mínimo em dias |&#10;| `fgc` | Boolean | **Sim** | `@NotNull` | Protegido pelo FGC |&#10;&#10;**Validações Especiais:**&#10;&#10;1. **@ValidRentabilidadeIndice**: Validação customizada que verifica:&#10;   - Se `tipo_rentabilidade = &quot;POS&quot;` → `indice` deve ser diferente de `null` e `&quot;NENHUM&quot;`&#10;   - Se `tipo_rentabilidade = &quot;PRE&quot;` → `indice` pode ser `null` ou `&quot;NENHUM&quot;`&#10;&#10;**Exemplos de Requests Válidos:**&#10;&#10;*Produto pré-fixado:*&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;LCI Pré-fixada 11% a.a.&quot;,&#10;  &quot;tipo&quot;: &quot;LCI&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;PRE&quot;,&#10;  &quot;rentabilidade&quot;: 11.0,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;NENHUM&quot;,&#10;  &quot;liquidez&quot;: -1,&#10;  &quot;minimo_dias_investimento&quot;: 90,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;&#10;*Produto pós-fixado:*&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;CDB 110% CDI&quot;,&#10;  &quot;tipo&quot;: &quot;CDB&quot;, &#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;rentabilidade&quot;: 10.0,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 0,&#10;  &quot;minimo_dias_investimento&quot;: 1,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;&#10;#### Responses&#10;&#10;##### ✅ 201 - Produto criado com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 15,&#10;  &quot;nome&quot;: &quot;CDB Premium 125% CDI&quot;,&#10;  &quot;tipo&quot;: &quot;CDB&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;rentabilidade&quot;: 25.0,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 30,&#10;  &quot;minimo_dias_investimento&quot;: 30,&#10;  &quot;fgc&quot;: true,&#10;  &quot;risco&quot;: &quot;BAIXO&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 4. PUT /produtos/{id}&#10;**Atualiza um produto existente**&#10;&#10;#### Descrição&#10;Atualiza completamente um produto existente na plataforma. Realiza as mesmas validações do POST, incluindo verificação de existência do produto.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;- **Validação de Acesso:** Apenas administradores podem atualizar produtos&#10;&#10;#### Request&#10;&#10;**URL:** `PUT /produtos/{id}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `id` | Long | **Sim** | `@NotNull` | ID do produto a ser atualizado |&#10;&#10;**Body:** Mesmo formato do POST (todos os campos obrigatórios)&#10;&#10;**Exemplo:** `PUT /produtos/15`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Produto atualizado com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 15,&#10;  &quot;nome&quot;: &quot;CDB Premium 130% CDI Atualizado&quot;,&#10;  &quot;tipo&quot;: &quot;CDB&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;rentabilidade&quot;: 30.0,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 60,&#10;  &quot;minimo_dias_investimento&quot;: 30,&#10;  &quot;fgc&quot;: true,&#10;  &quot;risco&quot;: &quot;BAIXO&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 5. GET /produtos/count&#10;**Conta total de produtos**&#10;&#10;#### Descrição&#10;Retorna o número total de produtos cadastrados na plataforma. Útil para paginação, dashboards e estatísticas gerais.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** Qualquer usuário autenticado pode consultar&#10;&#10;#### Request&#10;&#10;**URL:** `GET /produtos/count`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Parâmetros:** Nenhum&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Contagem obtida com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;total&quot;: 42&#10;}&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `total` | Long | Número total de produtos cadastrados |&#10;&#10;---&#10;&#10;## Status Codes e Erros por Endpoint&#10;&#10;### GET /produtos&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Consulta executada com sucesso (mesmo se retornar lista vazia) |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não autorizada |&#10;| **500** | Internal Server Error | Erro interno do sistema |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 401 - Unauthorized&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/produtos&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /produtos/{id}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Produto encontrado |&#10;| **400** | Bad Request | ID inválido (não numérico) |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não autorizada |&#10;| **404** | Not Found | Produto não encontrado |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 404 - Not Found&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Produto não encontrado com ID: 999&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/produtos/999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### POST /produtos&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **201** | Created | Produto criado com sucesso |&#10;| **400** | Bad Request | Validações falharam, dados inválidos |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não é ADMIN |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 400 - Bad Request (Validações Bean)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/produtos&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'nome': Nome é obrigatório&quot;,&#10;    &quot;Campo 'tipo': Tipo do produto é obrigatório&quot;,&#10;    &quot;Campo 'rentabilidade': Rentabilidade deve ser maior ou igual a zero&quot;&#10;  ]&#10;}&#10;```&#10;&#10;##### ❌ 400 - Bad Request (Validação Customizada)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro de validação: Produtos com rentabilidade pós-fixada devem ter um índice válido (diferente de NENHUM)&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/produtos&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: apenas usuários com role ADMIN podem acessar este recurso&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/produtos&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### PUT /produtos/{id}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Produto atualizado com sucesso |&#10;| **400** | Bad Request | Validações falharam, ID inválido |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não é ADMIN |&#10;| **404** | Not Found | Produto não encontrado para atualizar |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 404 - Not Found&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Produto não encontrado com ID: 999&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/produtos/999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /produtos/count&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Contagem obtida com sucesso |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não autorizada |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Consolidados&#10;&#10;| Status | Nome | Descrição | Endpoints Afetados |&#10;|--------|------|-----------|-------------------|&#10;| **200** | OK | Sucesso | GET (todos), PUT |&#10;| **201** | Created | Produto criado | POST |&#10;| **400** | Bad Request | Validações/dados inválidos | POST, PUT |&#10;| **401** | Unauthorized | Token inválido | Todos |&#10;| **403** | Forbidden | Role não autorizada | Todos |&#10;| **404** | Not Found | Produto não encontrado | GET /{id}, PUT |&#10;| **500** | Internal Server Error | Erro interno | Todos |&#10;&#10;### Categorias de Mensagens de Erro&#10;&#10;####  Erros de Validação (400)&#10;&#10;**Campos obrigatórios:**&#10;- `&quot;Nome é obrigatório&quot;`&#10;- `&quot;Tipo do produto é obrigatório&quot;`&#10;- `&quot;Tipo de rentabilidade é obrigatório&quot;`&#10;- `&quot;Rentabilidade é obrigatória&quot;`&#10;- `&quot;Período de rentabilidade é obrigatório&quot;`&#10;- `&quot;Liquidez é obrigatória&quot;`&#10;- `&quot;Mínimo de dias de investimento é obrigatório&quot;`&#10;- `&quot;FGC é obrigatório&quot;`&#10;&#10;**Validações de formato:**&#10;- `&quot;Nome deve ter entre 2 e 255 caracteres&quot;`&#10;- `&quot;Rentabilidade deve ser maior ou igual a zero&quot;`&#10;- `&quot;Liquidez deve ser -1 (sem liquidez) ou &gt;= 0&quot;`&#10;- `&quot;Mínimo de dias de investimento deve ser &gt;= 0&quot;`&#10;&#10;**Validações customizadas:**&#10;- `&quot;Produtos com rentabilidade pós-fixada devem ter um índice válido (diferente de NENHUM)&quot;`&#10;&#10;####  Erros de Autenticação (401)&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#10;- `&quot;Token JWT inválido ou expirado&quot;`&#10;&#10;####  Erros de Autorização (403)&#10;- `&quot;Acesso negado: apenas usuários com role ADMIN podem acessar este recurso&quot;`&#10;- `&quot;Token JWT não encontrado&quot;`&#10;- `&quot;Acesso negado: role não autorizada&quot;`&#10;&#10;####  Erros de Recurso (404)&#10;- `&quot;Produto não encontrado com ID: {id}&quot;`&#10;&#10;####  Erros Internos (500)&#10;- `&quot;Erro interno do servidor: {detalhes do erro}&quot;`&#10;&#10;---&#10;&#10;## Enums e Tipos de Dados&#10;&#10;### TipoProduto&#10;| Valor | Descrição | Tipo de Renda |&#10;|-------|-----------|---------------|&#10;| `CDB` | Certificado de Depósito Bancário | RENDA_FIXA |&#10;| `LCI` | Letra de Crédito Imobiliário | RENDA_FIXA |&#10;| `LCA` | Letra de Crédito do Agronegócio | RENDA_FIXA |&#10;| `TESOURO_DIRETO` | Tesouro Direto | RENDA_FIXA |&#10;| `POUPANCA` | Poupança | RENDA_FIXA |&#10;| `DEBENTURE` | Debênture | RENDA_FIXA |&#10;| `CRI` | Certificado de Recebíveis Imobiliários | RENDA_FIXA |&#10;| `FUNDO` | Fundo de Investimento | RENDA_VARIAVEL |&#10;| `FII` | Fundo de Investimento Imobiliário | RENDA_VARIAVEL |&#10;| `ACAO` | Ação | RENDA_VARIAVEL |&#10;| `ETF` | ETF | RENDA_VARIAVEL |&#10;&#10;### TipoRentabilidade&#10;| Valor | Descrição |&#10;|-------|-----------|&#10;| `PRE` | Pré-fixado |&#10;| `POS` | Pós-fixado |&#10;&#10;### PeriodoRentabilidade&#10;| Valor | Significado |&#10;|-------|-------------|&#10;| `AO_DIA` | Ao dia |&#10;| `AO_MES` | Ao mês |&#10;| `AO_ANO` | Ao ano |&#10;| `PERIODO_TOTAL` | Período total |&#10;&#10;### Indice&#10;| Valor | Descrição |&#10;|-------|-----------|&#10;| `CDI` | Certificado de Depósito Interbancário |&#10;| `SELIC` | Sistema Especial de Liquidação e Custódia |&#10;| `IPCA` | Índice Nacional de Preços ao Consumidor Amplo |&#10;| `TR` | Taxa Referencial |&#10;| `NENHUM` | Sem índice (produtos pré-fixados) |&#10;&#10;### NivelRisco&#10;| Valor | Descrição |&#10;|-------|-----------|&#10;| `BAIXO` | Risco baixo (produtos com garantias) |&#10;| `MEDIO` | Risco médio |&#10;| `ALTO` | Risco alto (renda variável) |&#10;&#10;---&#10;&#10;## Validação Customizada: @ValidRentabilidadeIndice&#10;&#10;### Funcionamento&#10;A anotação `@ValidRentabilidadeIndice` implementa uma validação de consistência que garante:&#10;&#10;1. **Produtos pós-fixados (POS)**: Devem ter um índice válido&#10;2. **Produtos pré-fixados (PRE)**: Índice é opcional&#10;&#10;### Regras Implementadas&#10;```java&#10;if (tipoRentabilidade == POS) {&#10;    // Índice não pode ser null nem NENHUM&#10;    if (indice == null || indice == NENHUM) {&#10;        return false; // Inválido&#10;    }&#10;}&#10;// PRE ou outros casos: sempre válido&#10;return true;&#10;```&#10;&#10;### Exemplos de Validação&#10;&#10;#### ✅ Válidos&#10;```json&#10;// Pré-fixado sem índice&#10;{&quot;tipo_rentabilidade&quot;: &quot;PRE&quot;, &quot;indice&quot;: &quot;NENHUM&quot;}&#10;{&quot;tipo_rentabilidade&quot;: &quot;PRE&quot;, &quot;indice&quot;: null}&#10;&#10;// Pós-fixado com índice&#10;{&quot;tipo_rentabilidade&quot;: &quot;POS&quot;, &quot;indice&quot;: &quot;CDI&quot;}&#10;{&quot;tipo_rentabilidade&quot;: &quot;POS&quot;, &quot;indice&quot;: &quot;SELIC&quot;}&#10;```&#10;&#10;#### ❌ Inválidos&#10;```json&#10;// Pós-fixado sem índice válido&#10;{&quot;tipo_rentabilidade&quot;: &quot;POS&quot;, &quot;indice&quot;: &quot;NENHUM&quot;}&#10;{&quot;tipo_rentabilidade&quot;: &quot;POS&quot;, &quot;indice&quot;: null}&#10;```&#10;&#10;---&#10;&#10;## Algoritmos de Filtragem&#10;&#10;### Precedência de Filtros&#10;```java&#10;if (tipo != null) return buscarPorTipo(tipo);&#10;else if (tipoRentabilidade != null) return buscarPorTipoRentabilidade(tipoRentabilidade);&#10;else if (fgc == TRUE) return buscarProdutosComFgc();&#10;else if (liquidezImediata == TRUE) return buscarProdutosComLiquidezImediata();&#10;else if (semLiquidez == TRUE) return buscarProdutosSemLiquidez();&#10;else if (nome != null &amp;&amp; !nome.isEmpty()) return buscarPorNome(nome);&#10;else return listarTodos();&#10;```&#10;&#10;### Tipos de Busca&#10;&#10;1. **Por tipo**: Produtos de categoria específica (CDB, LCI, etc.)&#10;2. **Por rentabilidade**: Pré ou pós-fixados&#10;3. **Com FGC**: Apenas produtos garantidos&#10;4. **Liquidez imediata**: liquidez = 0&#10;5. **Sem liquidez**: liquidez = -1&#10;6. **Por nome**: Busca substring no nome&#10;7. **Todos**: Sem filtros aplicados&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Listar todos os produtos:**&#10;```bash&#10;curl -X GET http://localhost:9090/produtos \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;**Filtrar CDBs:**&#10;```bash&#10;curl -X GET &quot;http://localhost:9090/produtos?tipo=CDB&quot; \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;**Buscar produto específico:**&#10;```bash&#10;curl -X GET http://localhost:9090/produtos/1 \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;**Criar novo produto (ADMIN):**&#10;```bash&#10;curl -X POST http://localhost:9090/produtos \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;nome&quot;: &quot;CDB Novo 115% CDI&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 15.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 90,&#10;    &quot;minimo_dias_investimento&quot;: 30,&#10;    &quot;fgc&quot;: true&#10;  }'&#10;```&#10;&#10;**Atualizar produto (ADMIN):**&#10;```bash&#10;curl -X PUT http://localhost:9090/produtos/15 \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;nome&quot;: &quot;CDB Atualizado 120% CDI&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 20.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 60,&#10;    &quot;minimo_dias_investimento&quot;: 30,&#10;    &quot;fgc&quot;: true&#10;  }'&#10;```&#10;&#10;**Contar produtos:**&#10;```bash&#10;curl -X GET http://localhost:9090/produtos/count \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;### Respostas Típicas&#10;&#10;**Lista vazia:**&#10;```json&#10;[]&#10;```&#10;&#10;**Erro de validação:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'nome': Nome é obrigatório&quot;&#10;  ]&#10;}&#10;```&#10;&#10;**Erro de autorização:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: apenas usuários com role ADMIN podem acessar este recurso&quot;&#10;}&#10;```&#10;&#10;&#10;&#10;---&#10;&#10;## Casos de Uso Típicos&#10;&#10;### 1. Catálogo de Produtos&#10;**Cenário**: Cliente navega pelos produtos disponíveis&#10;```&#10;GET /produtos → Lista completa&#10;GET /produtos?fgc=true → Apenas com garantia&#10;GET /produtos/5 → Detalhes específicos&#10;```&#10;&#10;### 2. Busca Específica&#10;**Cenário**: Cliente busca produto por características&#10;```&#10;GET /produtos?tipo=CDB → CDBs disponíveis&#10;GET /produtos?liquidez_imediata=true → Com liquidez&#10;GET /produtos?nome=Premium → Produtos premium&#10;```&#10;&#10;### 3. Administração (ADMIN)&#10;**Cenário**: Gestor gerencia catálogo&#10;```&#10;POST /produtos → Criar novo produto&#10;PUT /produtos/10 → Atualizar existente&#10;GET /produtos/count → Estatísticas&#10;```&#10;&#10;### 4. Análise de Portfólio&#10;**Cenário**: Assessor analisa opções por categoria&#10;```&#10;GET /produtos?tipo_rentabilidade=POS → Pós-fixados&#10;GET /produtos?tipo_rentabilidade=PRE → Pré-fixados&#10;```&#10;&#10;---" />
              <option name="updatedContent" value="# Documentação da API - ProdutoResource&#10;&#10;## Visão Geral&#10;&#10;O `ProdutoResource` é responsável pelo gerenciamento completo dos produtos de investimento disponíveis na plataforma. Permite consultar, criar, atualizar e filtrar produtos financeiros com diferentes características de rentabilidade, risco e liquidez.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/produtos`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;**Autenticação global:**&#10;- **Token JWT:** OBRIGATÓRIO para todos os endpoints&#10;- **Roles permitidas:** Varia por endpoint (USER/ADMIN)&#10;&#10;**Características:**&#10;- **CRUD completo**: Criar, ler, atualizar e contar produtos&#10;- **Filtros avançados**: Busca por múltiplos critérios&#10;- **Validações rigorosas**: Bean Validation + validação customizada&#10;- **Controle de acesso**: Operações de escrita restritas a ADMIN&#10;- **Enums estruturados**: Tipos e características padronizadas&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. GET /produtos&#10;**Lista produtos com filtros opcionais**&#10;&#10;`http://localhost:9090/produtos`&#10;&#10;#### Descrição&#10;Retorna uma lista de produtos de investimento disponíveis na plataforma. Suporta filtros via query parameters para busca específica por características do produto. Se nenhum filtro for aplicado, retorna todos os produtos cadastrados.&#10;&#10;#### Algoritmo de Filtragem&#10;1. **Priorização**: Filtros são aplicados em ordem de especificidade&#10;2. **Exclusividade**: Apenas um filtro é aplicado por requisição&#10;3. **Fallback**: Sem filtros = listagem completa&#10;4. **Ordem de precedência**:&#10;   - `tipo` → `tipo_rentabilidade` → `fgc` → `liquidez_imediata` → `sem_liquidez` → `nome` → todos&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** Qualquer usuário autenticado pode consultar&#10;&#10;#### Request&#10;&#10;**URL:** `GET /produtos`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Query Parameters (todos opcionais):**&#10;&#10;| Parâmetro | Tipo | Descrição | Valores Possíveis |&#10;|-----------|------|-----------|-------------------|&#10;| `tipo` | enum | Filtra por tipo de produto | CDB, LCI, LCA, TESOURO_DIRETO, POUPANCA, DEBENTURE, CRI, FUNDO, FII, ACAO, ETF |&#10;| `tipo_rentabilidade` | enum | Filtra por tipo de rentabilidade | PRE, POS |&#10;| `fgc` | boolean | Produtos protegidos pelo FGC | true, false |&#10;| `liquidez_imediata` | boolean | Produtos com liquidez imediata | true, false |&#10;| `sem_liquidez` | boolean | Produtos sem liquidez | true, false |&#10;| `nome` | string | Busca por nome (contém texto) | Qualquer texto não vazio |&#10;&#10;**Exemplos de URLs:**&#10;```&#10;GET /produtos&#10;GET /produtos?tipo=CDB&#10;GET /produtos?tipo_rentabilidade=POS&#10;GET /produtos?fgc=true&#10;GET /produtos?liquidez_imediata=true&#10;GET /produtos?sem_liquidez=true&#10;GET /produtos?nome=Premium&#10;```&#10;&#10;**Regras de Filtragem:**&#10;- **Um filtro por vez**: Se múltiplos filtros forem fornecidos, apenas o primeiro na ordem de precedência será aplicado&#10;- **Case sensitive**: Enum values devem ser exatos&#10;- **Nome flexível**: Busca por substring (case insensitive)&#10;- **Boolean explícito**: `fgc=true` filtra produtos COM FGC; `fgc=false` não filtra&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 1,&#10;    &quot;nome&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 20.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 90,&#10;    &quot;minimo_dias_investimento&quot;: 30,&#10;    &quot;fgc&quot;: true,&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 2,&#10;    &quot;nome&quot;: &quot;LCI Premium Pré-fixada&quot;,&#10;    &quot;tipo&quot;: &quot;LCI&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;PRE&quot;,&#10;    &quot;rentabilidade&quot;: 11.5,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;NENHUM&quot;,&#10;    &quot;liquidez&quot;: -1,&#10;    &quot;minimo_dias_investimento&quot;: 90,&#10;    &quot;fgc&quot;: true,&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `id` | Long | ID único do produto |&#10;| `nome` | String | Nome completo do produto |&#10;| `tipo` | enum | Tipo de produto financeiro |&#10;| `tipo_rentabilidade` | enum | PRE (pré-fixado) ou POS (pós-fixado) |&#10;| `rentabilidade` | BigDecimal | Taxa/percentual de rentabilidade |&#10;| `periodo_rentabilidade` | enum | Periodicidade da rentabilidade |&#10;| `indice` | enum | Índice de referência (CDI, SELIC, etc.) |&#10;| `liquidez` | Integer | Dias para liquidez (-1 = sem liquidez, &gt;= 0 = dias) |&#10;| `minimo_dias_investimento` | Integer | Prazo mínimo obrigatório |&#10;| `fgc` | Boolean | Protegido pelo Fundo Garantidor de Créditos |&#10;| `risco` | enum | Nível de risco (BAIXO, MEDIO, ALTO) |&#10;&#10;---&#10;&#10;### 2. GET /produtos/{id}&#10;**Busca produto específico por ID**&#10;&#10;`http://localhost:9090/produtos/{id}`&#10;&#10;#### Descrição&#10;Retorna os detalhes completos de um produto específico através do seu ID único. Utilizado para consulta detalhada de produtos individuais.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** Qualquer usuário autenticado pode consultar&#10;&#10;#### Request&#10;&#10;**URL:** `GET /produtos/{id}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `id` | Long | **Sim** | `@NotNull` | ID único do produto |&#10;&#10;**Exemplo:** `GET /produtos/1`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Produto encontrado&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 1,&#10;  &quot;nome&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;  &quot;tipo&quot;: &quot;CDB&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;rentabilidade&quot;: 20.0,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 90,&#10;  &quot;minimo_dias_investimento&quot;: 30,&#10;  &quot;fgc&quot;: true,&#10;  &quot;risco&quot;: &quot;BAIXO&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 3. POST /produtos&#10;**Cria um novo produto**&#10;&#10;`http://localhost:9090/produtos`&#10;&#10;#### Descrição&#10;Cria um novo produto de investimento na plataforma. Realiza validações completas dos dados fornecidos, incluindo validação customizada da consistência entre tipo de rentabilidade e índice.&#10;&#10;#### Validações Aplicadas&#10;1. **Bean Validation**: Campos obrigatórios, tamanhos e formatos&#10;2. **Validação customizada**: Consistência rentabilidade-índice&#10;3. **Regras de negócio**: Lógica específica do domínio&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;- **Validação de Acesso:** Apenas administradores podem criar produtos&#10;&#10;#### Request&#10;&#10;**URL:** `POST /produtos`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Body (JSON):**&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;CDB Premium 125% CDI&quot;,&#10;  &quot;tipo&quot;: &quot;CDB&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;rentabilidade&quot;: 25.0,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 30,&#10;  &quot;minimo_dias_investimento&quot;: 30,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;&#10;**Campos do Request:**&#10;&#10;| Campo | Tipo | Obrigatório | Validação | Descrição |&#10;|-------|------|-------------|-----------|-----------|&#10;| `nome` | String | **Sim** | `@NotBlank`, `@Size(min=2, max=255)` | Nome do produto (2-255 caracteres) |&#10;| `tipo` | enum | **Sim** | `@NotNull` | Tipo de produto financeiro |&#10;| `tipo_rentabilidade` | enum | **Sim** | `@NotNull` | PRE ou POS |&#10;| `rentabilidade` | BigDecimal | **Sim** | `@NotNull`, `@DecimalMin(&quot;0.0&quot;)` | Taxa de rentabilidade (&gt;= 0) |&#10;| `periodo_rentabilidade` | enum | **Sim** | `@NotNull` | AO_DIA, AO_MES, AO_ANO, PERIODO_TOTAL |&#10;| `indice` | enum | Condicional | `@ValidRentabilidadeIndice` | Obrigatório se POS, opcional se PRE |&#10;| `liquidez` | Integer | **Sim** | `@NotNull`, `@Min(-1)` | -1 (sem liquidez) ou &gt;= 0 (dias) |&#10;| `minimo_dias_investimento` | Integer | **Sim** | `@NotNull`, `@Min(0)` | Prazo mínimo em dias |&#10;| `fgc` | Boolean | **Sim** | `@NotNull` | Protegido pelo FGC |&#10;&#10;**Validações Especiais:**&#10;&#10;1. **@ValidRentabilidadeIndice**: Validação customizada que verifica:&#10;   - Se `tipo_rentabilidade = &quot;POS&quot;` → `indice` deve ser diferente de `null` e `&quot;NENHUM&quot;`&#10;   - Se `tipo_rentabilidade = &quot;PRE&quot;` → `indice` pode ser `null` ou `&quot;NENHUM&quot;`&#10;&#10;**Exemplos de Requests Válidos:**&#10;&#10;*Produto pré-fixado:*&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;LCI Pré-fixada 11% a.a.&quot;,&#10;  &quot;tipo&quot;: &quot;LCI&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;PRE&quot;,&#10;  &quot;rentabilidade&quot;: 11.0,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;NENHUM&quot;,&#10;  &quot;liquidez&quot;: -1,&#10;  &quot;minimo_dias_investimento&quot;: 90,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;&#10;*Produto pós-fixado:*&#10;```json&#10;{&#10;  &quot;nome&quot;: &quot;CDB 110% CDI&quot;,&#10;  &quot;tipo&quot;: &quot;CDB&quot;, &#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;rentabilidade&quot;: 10.0,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 0,&#10;  &quot;minimo_dias_investimento&quot;: 1,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;&#10;#### Responses&#10;&#10;##### ✅ 201 - Produto criado com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 15,&#10;  &quot;nome&quot;: &quot;CDB Premium 125% CDI&quot;,&#10;  &quot;tipo&quot;: &quot;CDB&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;rentabilidade&quot;: 25.0,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 30,&#10;  &quot;minimo_dias_investimento&quot;: 30,&#10;  &quot;fgc&quot;: true,&#10;  &quot;risco&quot;: &quot;BAIXO&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 4. PUT /produtos/{id}&#10;**Atualiza um produto existente**&#10;&#10;`http://localhost:9090/produtos/{id}`&#10;&#10;#### Descrição&#10;Atualiza completamente um produto existente na plataforma. Realiza as mesmas validações do POST, incluindo verificação de existência do produto.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;- **Validação de Acesso:** Apenas administradores podem atualizar produtos&#10;&#10;#### Request&#10;&#10;**URL:** `PUT /produtos/{id}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `id` | Long | **Sim** | `@NotNull` | ID do produto a ser atualizado |&#10;&#10;**Body:** Mesmo formato do POST (todos os campos obrigatórios)&#10;&#10;**Exemplo:** `PUT /produtos/15`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Produto atualizado com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 15,&#10;  &quot;nome&quot;: &quot;CDB Premium 130% CDI Atualizado&quot;,&#10;  &quot;tipo&quot;: &quot;CDB&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;rentabilidade&quot;: 30.0,&#10;  &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 60,&#10;  &quot;minimo_dias_investimento&quot;: 30,&#10;  &quot;fgc&quot;: true,&#10;  &quot;risco&quot;: &quot;BAIXO&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 5. GET /produtos/count&#10;**Conta total de produtos**&#10;&#10;`http://localhost:9090/produtos/count`&#10;&#10;#### Descrição&#10;Retorna o número total de produtos cadastrados na plataforma. Útil para paginação, dashboards e estatísticas gerais.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** Qualquer usuário autenticado pode consultar&#10;&#10;#### Request&#10;&#10;**URL:** `GET /produtos/count`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Parâmetros:** Nenhum&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Contagem obtida com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;total&quot;: 42&#10;}&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `total` | Long | Número total de produtos cadastrados |&#10;&#10;---&#10;&#10;## Status Codes e Erros por Endpoint&#10;&#10;### GET /produtos&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Consulta executada com sucesso (mesmo se retornar lista vazia) |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não autorizada |&#10;| **500** | Internal Server Error | Erro interno do sistema |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 401 - Unauthorized&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/produtos&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /produtos/{id}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Produto encontrado |&#10;| **400** | Bad Request | ID inválido (não numérico) |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não autorizada |&#10;| **404** | Not Found | Produto não encontrado |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 404 - Not Found&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Produto não encontrado com ID: 999&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/produtos/999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### POST /produtos&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **201** | Created | Produto criado com sucesso |&#10;| **400** | Bad Request | Validações falharam, dados inválidos |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não é ADMIN |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 400 - Bad Request (Validações Bean)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/produtos&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'nome': Nome é obrigatório&quot;,&#10;    &quot;Campo 'tipo': Tipo do produto é obrigatório&quot;,&#10;    &quot;Campo 'rentabilidade': Rentabilidade deve ser maior ou igual a zero&quot;&#10;  ]&#10;}&#10;```&#10;&#10;##### ❌ 400 - Bad Request (Validação Customizada)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro de validação: Produtos com rentabilidade pós-fixada devem ter um índice válido (diferente de NENHUM)&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/produtos&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: apenas usuários com role ADMIN podem acessar este recurso&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/produtos&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### PUT /produtos/{id}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Produto atualizado com sucesso |&#10;| **400** | Bad Request | Validações falharam, ID inválido |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não é ADMIN |&#10;| **404** | Not Found | Produto não encontrado para atualizar |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 404 - Not Found&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Produto não encontrado com ID: 999&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/produtos/999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /produtos/count&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Contagem obtida com sucesso |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não autorizada |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Consolidados&#10;&#10;| Status | Nome | Descrição | Endpoints Afetados |&#10;|--------|------|-----------|-------------------|&#10;| **200** | OK | Sucesso | GET (todos), PUT |&#10;| **201** | Created | Produto criado | POST |&#10;| **400** | Bad Request | Validações/dados inválidos | POST, PUT |&#10;| **401** | Unauthorized | Token inválido | Todos |&#10;| **403** | Forbidden | Role não autorizada | Todos |&#10;| **404** | Not Found | Produto não encontrado | GET /{id}, PUT |&#10;| **500** | Internal Server Error | Erro interno | Todos |&#10;&#10;### Categorias de Mensagens de Erro&#10;&#10;####  Erros de Validação (400)&#10;&#10;**Campos obrigatórios:**&#10;- `&quot;Nome é obrigatório&quot;`&#10;- `&quot;Tipo do produto é obrigatório&quot;`&#10;- `&quot;Tipo de rentabilidade é obrigatório&quot;`&#10;- `&quot;Rentabilidade é obrigatória&quot;`&#10;- `&quot;Período de rentabilidade é obrigatório&quot;`&#10;- `&quot;Liquidez é obrigatória&quot;`&#10;- `&quot;Mínimo de dias de investimento é obrigatório&quot;`&#10;- `&quot;FGC é obrigatório&quot;`&#10;&#10;**Validações de formato:**&#10;- `&quot;Nome deve ter entre 2 e 255 caracteres&quot;`&#10;- `&quot;Rentabilidade deve ser maior ou igual a zero&quot;`&#10;- `&quot;Liquidez deve ser -1 (sem liquidez) ou &gt;= 0&quot;`&#10;- `&quot;Mínimo de dias de investimento deve ser &gt;= 0&quot;`&#10;&#10;**Validações customizadas:**&#10;- `&quot;Produtos com rentabilidade pós-fixada devem ter um índice válido (diferente de NENHUM)&quot;`&#10;&#10;####  Erros de Autenticação (401)&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#10;- `&quot;Token JWT inválido ou expirado&quot;`&#10;&#10;####  Erros de Autorização (403)&#10;- `&quot;Acesso negado: apenas usuários com role ADMIN podem acessar este recurso&quot;`&#10;- `&quot;Token JWT não encontrado&quot;`&#10;- `&quot;Acesso negado: role não autorizada&quot;`&#10;&#10;####  Erros de Recurso (404)&#10;- `&quot;Produto não encontrado com ID: {id}&quot;`&#10;&#10;####  Erros Internos (500)&#10;- `&quot;Erro interno do servidor: {detalhes do erro}&quot;`&#10;&#10;---&#10;&#10;## Enums e Tipos de Dados&#10;&#10;### TipoProduto&#10;| Valor | Descrição | Tipo de Renda |&#10;|-------|-----------|---------------|&#10;| `CDB` | Certificado de Depósito Bancário | RENDA_FIXA |&#10;| `LCI` | Letra de Crédito Imobiliário | RENDA_FIXA |&#10;| `LCA` | Letra de Crédito do Agronegócio | RENDA_FIXA |&#10;| `TESOURO_DIRETO` | Tesouro Direto | RENDA_FIXA |&#10;| `POUPANCA` | Poupança | RENDA_FIXA |&#10;| `DEBENTURE` | Debênture | RENDA_FIXA |&#10;| `CRI` | Certificado de Recebíveis Imobiliários | RENDA_FIXA |&#10;| `FUNDO` | Fundo de Investimento | RENDA_VARIAVEL |&#10;| `FII` | Fundo de Investimento Imobiliário | RENDA_VARIAVEL |&#10;| `ACAO` | Ação | RENDA_VARIAVEL |&#10;| `ETF` | ETF | RENDA_VARIAVEL |&#10;&#10;### TipoRentabilidade&#10;| Valor | Descrição |&#10;|-------|-----------|&#10;| `PRE` | Pré-fixado |&#10;| `POS` | Pós-fixado |&#10;&#10;### PeriodoRentabilidade&#10;| Valor | Significado |&#10;|-------|-------------|&#10;| `AO_DIA` | Ao dia |&#10;| `AO_MES` | Ao mês |&#10;| `AO_ANO` | Ao ano |&#10;| `PERIODO_TOTAL` | Período total |&#10;&#10;### Indice&#10;| Valor | Descrição |&#10;|-------|-----------|&#10;| `CDI` | Certificado de Depósito Interbancário |&#10;| `SELIC` | Sistema Especial de Liquidação e Custódia |&#10;| `IPCA` | Índice Nacional de Preços ao Consumidor Amplo |&#10;| `TR` | Taxa Referencial |&#10;| `NENHUM` | Sem índice (produtos pré-fixados) |&#10;&#10;### NivelRisco&#10;| Valor | Descrição |&#10;|-------|-----------|&#10;| `BAIXO` | Risco baixo (produtos com garantias) |&#10;| `MEDIO` | Risco médio |&#10;| `ALTO` | Risco alto (renda variável) |&#10;&#10;---&#10;&#10;## Validação Customizada: @ValidRentabilidadeIndice&#10;&#10;### Funcionamento&#10;A anotação `@ValidRentabilidadeIndice` implementa uma validação de consistência que garante:&#10;&#10;1. **Produtos pós-fixados (POS)**: Devem ter um índice válido&#10;2. **Produtos pré-fixados (PRE)**: Índice é opcional&#10;&#10;### Regras Implementadas&#10;```java&#10;if (tipoRentabilidade == POS) {&#10;    // Índice não pode ser null nem NENHUM&#10;    if (indice == null || indice == NENHUM) {&#10;        return false; // Inválido&#10;    }&#10;}&#10;// PRE ou outros casos: sempre válido&#10;return true;&#10;```&#10;&#10;### Exemplos de Validação&#10;&#10;#### ✅ Válidos&#10;```json&#10;// Pré-fixado sem índice&#10;{&quot;tipo_rentabilidade&quot;: &quot;PRE&quot;, &quot;indice&quot;: &quot;NENHUM&quot;}&#10;{&quot;tipo_rentabilidade&quot;: &quot;PRE&quot;, &quot;indice&quot;: null}&#10;&#10;// Pós-fixado com índice&#10;{&quot;tipo_rentabilidade&quot;: &quot;POS&quot;, &quot;indice&quot;: &quot;CDI&quot;}&#10;{&quot;tipo_rentabilidade&quot;: &quot;POS&quot;, &quot;indice&quot;: &quot;SELIC&quot;}&#10;```&#10;&#10;#### ❌ Inválidos&#10;```json&#10;// Pós-fixado sem índice válido&#10;{&quot;tipo_rentabilidade&quot;: &quot;POS&quot;, &quot;indice&quot;: &quot;NENHUM&quot;}&#10;{&quot;tipo_rentabilidade&quot;: &quot;POS&quot;, &quot;indice&quot;: null}&#10;```&#10;&#10;---&#10;&#10;## Algoritmos de Filtragem&#10;&#10;### Precedência de Filtros&#10;```java&#10;if (tipo != null) return buscarPorTipo(tipo);&#10;else if (tipoRentabilidade != null) return buscarPorTipoRentabilidade(tipoRentabilidade);&#10;else if (fgc == TRUE) return buscarProdutosComFgc();&#10;else if (liquidezImediata == TRUE) return buscarProdutosComLiquidezImediata();&#10;else if (semLiquidez == TRUE) return buscarProdutosSemLiquidez();&#10;else if (nome != null &amp;&amp; !nome.isEmpty()) return buscarPorNome(nome);&#10;else return listarTodos();&#10;```&#10;&#10;### Tipos de Busca&#10;&#10;1. **Por tipo**: Produtos de categoria específica (CDB, LCI, etc.)&#10;2. **Por rentabilidade**: Pré ou pós-fixados&#10;3. **Com FGC**: Apenas produtos garantidos&#10;4. **Liquidez imediata**: liquidez = 0&#10;5. **Sem liquidez**: liquidez = -1&#10;6. **Por nome**: Busca substring no nome&#10;7. **Todos**: Sem filtros aplicados&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Listar todos os produtos:**&#10;```bash&#10;curl -X GET http://localhost:9090/produtos \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;**Filtrar CDBs:**&#10;```bash&#10;curl -X GET &quot;http://localhost:9090/produtos?tipo=CDB&quot; \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;**Buscar produto específico:**&#10;```bash&#10;curl -X GET http://localhost:9090/produtos/1 \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;**Criar novo produto (ADMIN):**&#10;```bash&#10;curl -X POST http://localhost:9090/produtos \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;nome&quot;: &quot;CDB Novo 115% CDI&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 15.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 90,&#10;    &quot;minimo_dias_investimento&quot;: 30,&#10;    &quot;fgc&quot;: true&#10;  }'&#10;```&#10;&#10;**Atualizar produto (ADMIN):**&#10;```bash&#10;curl -X PUT http://localhost:9090/produtos/15 \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;nome&quot;: &quot;CDB Atualizado 120% CDI&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;    &quot;rentabilidade&quot;: 20.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 60,&#10;    &quot;minimo_dias_investimento&quot;: 30,&#10;    &quot;fgc&quot;: true&#10;  }'&#10;```&#10;&#10;**Contar produtos:**&#10;```bash&#10;curl -X GET http://localhost:9090/produtos/count \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;### Respostas Típicas&#10;&#10;**Lista vazia:**&#10;```json&#10;[]&#10;```&#10;&#10;**Erro de validação:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'nome': Nome é obrigatório&quot;&#10;  ]&#10;}&#10;```&#10;&#10;**Erro de autorização:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: apenas usuários com role ADMIN podem acessar este recurso&quot;&#10;}&#10;```&#10;&#10;&#10;&#10;---&#10;&#10;## Casos de Uso Típicos&#10;&#10;### 1. Catálogo de Produtos&#10;**Cenário**: Cliente navega pelos produtos disponíveis&#10;```&#10;GET /produtos → Lista completa&#10;GET /produtos?fgc=true → Apenas com garantia&#10;GET /produtos/5 → Detalhes específicos&#10;```&#10;&#10;### 2. Busca Específica&#10;**Cenário**: Cliente busca produto por características&#10;```&#10;GET /produtos?tipo=CDB → CDBs disponíveis&#10;GET /produtos?liquidez_imediata=true → Com liquidez&#10;GET /produtos?nome=Premium → Produtos premium&#10;```&#10;&#10;### 3. Administração (ADMIN)&#10;**Cenário**: Gestor gerencia catálogo&#10;```&#10;POST /produtos → Criar novo produto&#10;PUT /produtos/10 → Atualizar existente&#10;GET /produtos/count → Estatísticas&#10;```&#10;&#10;### 4. Análise de Portfólio&#10;**Cenário**: Assessor analisa opções por categoria&#10;```&#10;GET /produtos?tipo_rentabilidade=POS → Pós-fixados&#10;GET /produtos?tipo_rentabilidade=PRE → Pré-fixados&#10;```&#10;&#10;---" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/docs/DOCUMENTACAO_SIMULACAO_INVESTIMENTO.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/docs/DOCUMENTACAO_SIMULACAO_INVESTIMENTO.md" />
              <option name="originalContent" value="# Documentação da API - SimulacaoInvestimentoResource&#10;&#10;## Visão Geral&#10;&#10;O `SimulacaoInvestimentoResource` é responsável por realizar simulações de investimentos financeiros e gerenciar o histórico de simulações dos clientes. Permite calcular projeções de rentabilidade, consultar histórico de simulações e obter estatísticas comportamentais.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/simular-investimento`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;**Autenticação global:**&#10;- **Token JWT:** OBRIGATÓRIO para todos os endpoints&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. POST /simular-investimento&#10;**Realiza simulação de investimento**&#10;&#10;#### Descrição&#10;Calcula a projeção de rentabilidade de um investimento baseado nos parâmetros fornecidos. O sistema busca produtos que atendam aos critérios especificados e retorna o resultado da simulação com o produto validado e valores calculados.&#10;&#10;#### Algoritmo de Simulação&#10;1. **Validação de entrada**: Campos obrigatórios e regras de negócio&#10;2. **Busca de produtos**: Filtragem baseada nos critérios informados&#10;3. **Cálculo financeiro**: Projeção de rentabilidade no prazo especificado&#10;4. **Persistência**: Salvamento da simulação para histórico&#10;5. **Resposta**: Produto validado e resultado calculado&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** Não há validação específica de propriedade&#10;&#10;#### Request&#10;&#10;**URL:** `POST /simular-investimento`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Body (JSON):**&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;produto_id&quot;: 5,&#10;  &quot;valor&quot;: 10000.00,&#10;  &quot;prazoMeses&quot;: 12,&#10;  &quot;tipoProduto&quot;: &quot;CDB&quot;,&#10;  &quot;produto&quot;: &quot;CDB Premium&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 90,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;&#10;**Campos do Request:**&#10;&#10;| Campo | Tipo | Obrigatório | Validação | Descrição |&#10;|-------|------|-------------|-----------|-----------|&#10;| `clienteId` | Long | **Sim** | `@NotNull` | ID do cliente |&#10;| `produto_id` | Long | Não | - | ID específico do produto (opcional) |&#10;| `valor` | BigDecimal | **Sim** | `@NotNull`, `@DecimalMin(&quot;1.00&quot;)`, `@DecimalMax(&quot;999999999.99&quot;)` | Valor do investimento (R$ 1,00 a R$ 999.999.999,99) |&#10;| `prazoMeses` | Integer | **Um obrigatório** | `@Min(1)`, `@Max(600)` | Prazo em meses (1 a 600) |&#10;| `prazoDias` | Integer | **Um obrigatório** | `@Min(1)`, `@Max(18250)` | Prazo em dias (1 a 18.250) |&#10;| `prazoAnos` | Integer | **Um obrigatório** | `@Min(1)`, `@Max(50)` | Prazo em anos (1 a 50) |&#10;| `tipoProduto` | enum | Não | - | Tipo do produto (CDB, LCI, LCA, etc.) |&#10;| `produto` | string | Não | - | Nome do produto para filtrar |&#10;| `tipo_rentabilidade` | enum | Não | - | PRE, POS |&#10;| `indice` | enum | Não | - | CDI, SELIC, IPCA, TR, NENHUM |&#10;| `liquidez` | Integer | Não | `@Min(-1)` | Liquidez desejada (-1 = sem liquidez, &gt;= 0 = dias) |&#10;| `fgc` | Boolean | Não | - | Protegido pelo FGC |&#10;&#10;**Regras de Validação Especiais:**&#10;&#10;1. **Prazo obrigatório**: Pelo menos um campo de prazo deve ser informado (`@ValidPrazo`)&#10;2. **Liquidez**: Deve ser -1 (sem liquidez) ou &gt;= 0 (dias de liquidez)&#10;3. **Prazo máximo**: Não pode exceder 20 anos (240 meses) para simulação precisa&#10;4. **Consistência rentabilidade/índice**:&#10;   - PRE → índice deve ser NENHUM&#10;   - POS → índice deve ser específico (CDI, SELIC, etc.)&#10;&#10;**Exemplo de Request:**&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;valor&quot;: 5000.00,&#10;  &quot;prazoMeses&quot;: 24,&#10;  &quot;tipoProduto&quot;: &quot;CDB&quot;, &#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 30,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;&#10;#### Responses&#10;&#10;##### ✅ 201 - Simulação criada com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;produtoValidado&quot;: {&#10;    &quot;id&quot;: 1,&#10;    &quot;nome&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS_FIXADO&quot;,&#10;    &quot;rentabilidade&quot;: 20.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 30,&#10;    &quot;minimo_dias_investimento&quot;: 30,&#10;    &quot;fgc&quot;: true,&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#10;  },&#10;  &quot;resultadoSimulacao&quot;: {&#10;    &quot;valorFinal&quot;: 5624.50,&#10;    &quot;rentabilidadeEfetiva&quot;: 12.49,&#10;    &quot;prazoMeses&quot;: 24,&#10;    &quot;prazoDias&quot;: 720,&#10;    &quot;prazoAnos&quot;: 2,&#10;    &quot;valorInvestido&quot;: 5000.00,&#10;    &quot;rendimento&quot;: 624.50,&#10;    &quot;valorSimulado&quot;: true,&#10;    &quot;cenarioSimulacao&quot;: &quot;Simulação baseada em CDI atual&quot;&#10;  },&#10;  &quot;dataSimulacao&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;simulacaoId&quot;: 123&#10;}&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `produtoValidado` | object | Produto encontrado que atende aos critérios |&#10;| `resultadoSimulacao` | object | Resultado dos cálculos financeiros |&#10;| `resultadoSimulacao.valorFinal` | BigDecimal | Valor total ao final do prazo |&#10;| `resultadoSimulacao.rentabilidadeEfetiva` | BigDecimal | Rentabilidade efetiva calculada (%) |&#10;| `resultadoSimulacao.rendimento` | BigDecimal | Valor do rendimento (valorFinal - valorInvestido) |&#10;| `resultadoSimulacao.valorSimulado` | Boolean | Indica se é uma simulação (true) |&#10;| `resultadoSimulacao.cenarioSimulacao` | string | Descrição do cenário utilizado |&#10;| `dataSimulacao` | datetime | Data/hora da simulação |&#10;| `clienteId` | Long | ID do cliente |&#10;| `simulacaoId` | Long | ID da simulação persistida |&#10;&#10;---&#10;&#10;### 2. GET /simular-investimento/historico/{clienteId}&#10;**Busca histórico de simulações de um cliente**&#10;&#10;#### Descrição&#10;Retorna todas as simulações realizadas por um cliente específico, ordenadas por data. Permite acompanhar o comportamento e histórico de simulações para análise de perfil.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** USERs só podem acessar seus próprios dados, ADMINs têm acesso irrestrito&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simular-investimento/historico/{clienteId}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `clienteId` | Long | Sim | `@Positive` | ID único do cliente (deve ser positivo) |&#10;&#10;**Exemplo:** `GET /simular-investimento/historico/1`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Histórico obtido com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 123,&#10;    &quot;produto_id&quot;: 1,&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;valorInvestido&quot;: 5000.00,&#10;    &quot;valorFinal&quot;: 5624.50,&#10;    &quot;prazoMeses&quot;: 24,&#10;    &quot;prazoDias&quot;: 720,&#10;    &quot;prazoAnos&quot;: 2,&#10;    &quot;dataSimulacao&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;    &quot;rentabilidadeEfetiva&quot;: 12.49,&#10;    &quot;rendimento&quot;: 624.50,&#10;    &quot;valorSimulado&quot;: true,&#10;    &quot;cenarioSimulacao&quot;: &quot;Simulação baseada em CDI atual&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 122,&#10;    &quot;produto_id&quot;: 3,&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;produto&quot;: &quot;LCI Banco ABC 95% CDI&quot;,&#10;    &quot;valorInvestido&quot;: 10000.00,&#10;    &quot;valorFinal&quot;: 10950.00,&#10;    &quot;prazoMeses&quot;: 12,&#10;    &quot;prazoDias&quot;: 360,&#10;    &quot;prazoAnos&quot;: 1,&#10;    &quot;dataSimulacao&quot;: &quot;2025-11-10T10:15:00&quot;,&#10;    &quot;rentabilidadeEfetiva&quot;: 9.50,&#10;    &quot;rendimento&quot;: 950.00,&#10;    &quot;valorSimulado&quot;: true,&#10;    &quot;cenarioSimulacao&quot;: &quot;Simulação baseada em CDI atual&quot;&#10;  }&#10;]&#10;```&#10;&#10;---&#10;&#10;### 3. GET /simular-investimento/{id}&#10;**Busca simulação específica por ID**&#10;&#10;#### Descrição&#10;Retorna os detalhes de uma simulação específica pelo seu ID. Inclui validação de acesso para garantir que o usuário só acesse simulações próprias (ou todas se for ADMIN).&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** Baseada no clienteId da simulação vs. userId do JWT&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simular-investimento/{id}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `id` | Long | Sim | `@Positive` | ID único da simulação |&#10;&#10;**Exemplo:** `GET /simular-investimento/123`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Simulação encontrada&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 123,&#10;  &quot;produto_id&quot;: 1,&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;  &quot;valorInvestido&quot;: 5000.00,&#10;  &quot;valorFinal&quot;: 5624.50,&#10;  &quot;prazoMeses&quot;: 24,&#10;  &quot;prazoDias&quot;: 720,&#10;  &quot;prazoAnos&quot;: 2,&#10;  &quot;dataSimulacao&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;rentabilidadeEfetiva&quot;: 12.49,&#10;  &quot;rendimento&quot;: 624.50,&#10;  &quot;valorSimulado&quot;: true,&#10;  &quot;cenarioSimulacao&quot;: &quot;Simulação baseada em CDI atual&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 4. GET /simular-investimento/estatisticas/{clienteId}&#10;**Busca estatísticas de simulações do cliente**&#10;&#10;#### Descrição&#10;Retorna estatísticas consolidadas das simulações de um cliente, incluindo totais, médias e última simulação. Útil para análise comportamental e dashboards.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** USERs só podem acessar suas próprias estatísticas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simular-investimento/estatisticas/{clienteId}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `clienteId` | Long | Sim | `@Positive` | ID único do cliente |&#10;&#10;**Exemplo:** `GET /simular-investimento/estatisticas/1`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Estatísticas obtidas com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;totalSimulacoes&quot;: 15,&#10;  &quot;totalInvestido&quot;: 125000.00,&#10;  &quot;mediaValorInvestido&quot;: 8333.33,&#10;  &quot;ultimaSimulacao&quot;: {&#10;    &quot;id&quot;: 123,&#10;    &quot;produto_id&quot;: 1,&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;valorInvestido&quot;: 5000.00,&#10;    &quot;valorFinal&quot;: 5624.50,&#10;    &quot;prazoMeses&quot;: 24,&#10;    &quot;prazoDias&quot;: 720,&#10;    &quot;prazoAnos&quot;: 2,&#10;    &quot;dataSimulacao&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;    &quot;rentabilidadeEfetiva&quot;: 12.49,&#10;    &quot;rendimento&quot;: 624.50,&#10;    &quot;valorSimulado&quot;: true,&#10;    &quot;cenarioSimulacao&quot;: &quot;Simulação baseada em CDI atual&quot;&#10;  }&#10;}&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `totalSimulacoes` | Long | Número total de simulações realizadas |&#10;| `totalInvestido` | BigDecimal | Soma de todos os valores simulados |&#10;| `mediaValorInvestido` | BigDecimal | Valor médio por simulação |&#10;| `ultimaSimulacao` | object | Dados da simulação mais recente (pode ser null) |&#10;&#10;---&#10;&#10;## Status Codes e Erros por Endpoint&#10;&#10;### POST /simular-investimento&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **201** | Created | Simulação criada com sucesso |&#10;| **400** | Bad Request | Validações falharam, regras de negócio violadas |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não autorizada |&#10;| **500** | Internal Server Error | Erro interno do sistema |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 400 - Bad Request (Validações)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/simular-investimento&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'clienteId': ID do cliente é obrigatório (valor fornecido: null)&quot;,&#10;    &quot;Campo 'valor': Valor mínimo de investimento é R$ 1,00 (valor fornecido: 0.50)&quot;,&#10;    &quot;Campo 'prazoMeses': Prazo em meses deve ser no mínimo 1 (valor fornecido: 0)&quot;&#10;  ]&#10;}&#10;```&#10;&#10;##### ❌ 400 - Bad Request (Regras de Negócio)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro de validação: Pelo menos um prazo deve ser informado (prazoMeses, prazoDias ou prazoAnos)&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/simular-investimento&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro de validação: Produtos pré-fixados não devem ter índice específico. Use 'NENHUM' como índice.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/simular-investimento&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro de validação: Prazo muito longo para simulação precisa. Máximo recomendado: 20 anos (240 meses)&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/simular-investimento&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /simular-investimento/historico/{clienteId}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Histórico obtido com sucesso |&#10;| **400** | Bad Request | clienteId inválido (não positivo) |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | USER tentando acessar dados de outro cliente |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/simular-investimento/historico/2&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /simular-investimento/{id}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Simulação encontrada |&#10;| **400** | Bad Request | ID inválido (não positivo) |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Tentativa de acessar simulação de outro cliente |&#10;| **404** | Not Found | Simulação não encontrada |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 404 - Not Found&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Simulação não encontrada com ID: 999&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/simular-investimento/999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/simular-investimento/123&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /simular-investimento/estatisticas/{clienteId}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Estatísticas obtidas |&#10;| **400** | Bad Request | clienteId inválido |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Acesso negado aos dados do cliente |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/simular-investimento/estatisticas/2&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Consolidados&#10;&#10;| Status | Nome | Descrição | Endpoints Afetados |&#10;|--------|------|-----------|-------------------|&#10;| **200** | OK | Sucesso | GET (historico, por ID, estatísticas) |&#10;| **201** | Created | Simulação criada | POST |&#10;| **400** | Bad Request | Validações/regras violadas | Todos |&#10;| **401** | Unauthorized | Token inválido | Todos |&#10;| **403** | Forbidden | Sem permissão específica | Todos autenticados |&#10;| **404** | Not Found | Simulação não encontrada | GET /{id} |&#10;| **500** | Internal Server Error | Erro interno | Todos |&#10;&#10;### Categorias de Mensagens de Erro&#10;&#10;####  Erros de Validação (400)&#10;&#10;**Campos obrigatórios:**&#10;- `&quot;ID do cliente é obrigatório&quot;`&#10;- `&quot;Valor do investimento é obrigatório&quot;`&#10;&#10;**Validações de range:**&#10;- `&quot;Valor mínimo de investimento é R$ 1,00&quot;`&#10;- `&quot;Valor máximo de investimento é R$ 999.999.999,99&quot;`&#10;- `&quot;Prazo em meses deve ser no mínimo 1&quot;`&#10;- `&quot;Prazo em meses deve ser no máximo 600 (50 anos)&quot;`&#10;- `&quot;Liquidez deve ser -1 (sem liquidez) ou &gt;= 0&quot;`&#10;&#10;**Validações customizadas:**&#10;- `&quot;Pelo menos um prazo deve ser informado (prazoMeses, prazoDias ou prazoAnos)&quot;`&#10;&#10;**Regras de negócio:**&#10;- `&quot;Liquidez deve ser -1 (sem liquidos) ou o número de dias desejado.&quot;`&#10;- `&quot;Prazo muito longo para simulação precisa. Máximo recomendado: 20 anos (240 meses)&quot;`&#10;- `&quot;Produtos pré-fixados não devem ter índice específico. Use 'NENHUM' como índice.&quot;`&#10;- `&quot;Produtos pós-fixados devem ter um índice específico (CDI, SELIC, IPCA, etc.)&quot;`&#10;&#10;####  Erros de Autenticação (401)&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#10;&#10;####  Erros de Autorização (403)&#10;- `&quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;`&#10;- `&quot;Token JWT não encontrado&quot;`&#10;- `&quot;Acesso negado: role não autorizada&quot;`&#10;&#10;####  Erros de Recurso (404)&#10;- `&quot;Simulação não encontrada com ID: {id}&quot;`&#10;&#10;####  Erros Internos (500)&#10;- `&quot;Erro interno do servidor: {detalhes do erro}&quot;`&#10;&#10;---&#10;&#10;## Tipos de Produtos e Enums&#10;&#10;### TipoProduto&#10;- `CDB`: Certificado de Depósito Bancário&#10;- `LCI`: Letra de Crédito Imobiliário  &#10;- `LCA`: Letra de Crédito do Agronegócio&#10;- `TESOURO_DIRETO`: Títulos do Tesouro Nacional&#10;- `POUPANCA`: Caderneta de Poupança&#10;- `DEBENTURE`: Debêntures corporativas&#10;- `CRI`: Certificado de Recebíveis Imobiliários&#10;- `FUNDO`: Fundos de Investimento&#10;- `FII`: Fundos de Investimento Imobiliário&#10;- `ACAO`: Ações de empresas&#10;- `ETF`: Exchange Traded Funds&#10;&#10;### TipoRentabilidade&#10;- `PRE`: Taxa conhecida no momento da aplicação&#10;- `POS`: Taxa vinculada a um índice&#10;&#10;### Indice&#10;- `CDI`: Certificado de Depósito Interbancário&#10;- `SELIC`: Sistema Especial de Liquidação e Custódia&#10;- `IPCA`: Índice Nacional de Preços ao Consumidor Amplo&#10;- `TR`: Taxa Referencial&#10;- `NENHUM`: Produtos pré-fixados&#10;&#10;### NivelRisco&#10;- `BAIXO`: Produtos garantidos pelo FGC&#10;- `MEDIO`: Renda fixa sem garantia FGC&#10;- `ALTO`: Renda variável sem garantias&#10;&#10;---&#10;&#10;## Algoritmo de Simulação&#10;&#10;### Etapas do Processo&#10;&#10;1. **Validação de Entrada**&#10;   - Bean Validation nos campos&#10;   - Validação customizada @ValidPrazo&#10;   - Regras de negócio específicas&#10;&#10;2. **Busca de Produtos**&#10;   - Filtragem por critérios informados&#10;   - Priorização por produto_id se especificado&#10;   - Fallback para produtos compatíveis&#10;&#10;3. **Cálculos Financeiros**&#10;   - Aplicação de fórmulas de juros compostos&#10;   - Consideração de índices econômicos&#10;   - Projeção para o prazo especificado&#10;&#10;4. **Persistência**&#10;   - Salvamento da simulação no banco&#10;   - Geração de ID único&#10;   - Associação ao cliente&#10;&#10;5. **Resposta**&#10;   - Produto validado encontrado&#10;   - Resultado dos cálculos&#10;   - Metadados da simulação&#10;&#10;### Validações Especiais&#10;&#10;#### Consistência Rentabilidade vs. Índice&#10;```java&#10;// PRE_FIXADO deve ter índice NENHUM&#10;if (tipoRentabilidade == PRE &amp;&amp; indice != NENHUM) {&#10;    throw erro(&quot;Pré-fixado não deve ter índice&quot;);&#10;}&#10;&#10;// POS_FIXADO deve ter índice específico  &#10;if (tipoRentabilidade == POS &amp;&amp; indice == NENHUM) {&#10;    throw erro(&quot;Pós-fixado deve ter índice&quot;);&#10;}&#10;```&#10;&#10;#### Prazo Máximo&#10;```java&#10;if (prazoMeses &gt; 240) { // 20 anos&#10;    throw erro(&quot;Prazo muito longo&quot;);&#10;}&#10;```&#10;&#10;---&#10;&#10;## Informações Técnicas&#10;&#10;### Autenticação e Autorização&#10;&#10;**Validação de Propriedade:**&#10;- Utiliza `JwtAuthorizationHelper.validarAcessoAoCliente()`&#10;- **ADMIN**: Acesso irrestrito&#10;- **USER**: Apenas dados próprios (baseado em `userId` no JWT)&#10;&#10;**Endpoints com Validação de Acesso:**&#10;- `GET /historico/{clienteId}`: Valida acesso ao cliente&#10;- `GET /{id}`: Valida acesso via clienteId da simulação&#10;- `GET /estatisticas/{clienteId}`: Valida acesso ao cliente&#10;- `POST /`: Sem validação específica (qualquer user pode simular)&#10;&#10;### Dependências do Sistema&#10;&#10;- **SimulacaoInvestimentoService**: Lógica de negócio&#10;- **ProdutoRepository**: Busca de produtos disponíveis&#10;- **SimulacaoRepository**: Persistência de simulações&#10;- **ClienteService**: Validação de clientes (indireta)&#10;- **JwtAuthorizationHelper**: Controle de acesso&#10;- **SimulacaoInvestimentoMapper**: Conversão entidade → DTO&#10;&#10;### Performance&#10;&#10;- **Cálculos intensivos**: Simulações com múltiplos produtos&#10;- **Consultas ao banco**: Filtragem de produtos por critérios&#10;- **Persistência**: Cada simulação é salva&#10;- **Sem cache**: Recalcula sempre (dados atuais de mercado)&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Simulação básica:**&#10;```bash&#10;curl -X POST http://localhost:9090/simular-investimento \&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;valor&quot;: 10000.00,&#10;    &quot;prazoMeses&quot;: 12,&#10;    &quot;tipoProduto&quot;: &quot;CDB&quot;,&#10;    &quot;liquidez&quot;: 90,&#10;    &quot;fgc&quot;: true&#10;  }'&#10;```&#10;&#10;**Buscar histórico:**&#10;```bash&#10;curl -X GET http://localhost:9090/simular-investimento/historico/1 \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;**Buscar simulação específica:**&#10;```bash&#10;curl -X GET http://localhost:9090/simular-investimento/123 \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;**Obter estatísticas:**&#10;```bash&#10;curl -X GET http://localhost:9090/simular-investimento/estatisticas/1 \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;### Respostas Típicas&#10;&#10;**Simulação bem-sucedida:**&#10;```json&#10;{&#10;  &quot;produtoValidado&quot;: {&#10;    &quot;nome&quot;: &quot;CDB Premium 115% CDI&quot;,&#10;    &quot;rentabilidade&quot;: 15.0,&#10;    &quot;fgc&quot;: true&#10;  },&#10;  &quot;resultadoSimulacao&quot;: {&#10;    &quot;valorFinal&quot;: 11150.00,&#10;    &quot;rendimento&quot;: 1150.00,&#10;    &quot;rentabilidadeEfetiva&quot;: 11.5&#10;  },&#10;  &quot;simulacaoId&quot;: 124&#10;}&#10;```&#10;&#10;**Erro de validação:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'valor': Valor mínimo de investimento é R$ 1,00&quot;&#10;  ]&#10;}&#10;```&#10;&#10;&#10;&#10;---&#10;&#10;## Casos de Uso Típicos&#10;&#10;### 1. Simulação Exploratória&#10;**Cenário**: Cliente quer conhecer opções de investimento&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;valor&quot;: 5000.00,&#10;  &quot;prazoMeses&quot;: 12,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;→ Sistema retorna melhor produto com FGC&#10;&#10;### 2. Simulação Direcionada&#10;**Cenário**: Cliente quer simular produto específico&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;produto_id&quot;: 5,&#10;  &quot;valor&quot;: 10000.00,&#10;  &quot;prazoAnos&quot;: 2&#10;}&#10;```&#10;→ Simulação do produto ID 5&#10;&#10;### 3. Comparação de Cenários&#10;**Cenário**: Cliente testa diferentes prazos&#10;```&#10;POST com prazoMeses: 12 → Resultado A&#10;POST com prazoMeses: 24 → Resultado B  &#10;POST com prazoMeses: 36 → Resultado C&#10;```&#10;&#10;### 4. Análise Comportamental&#10;**Cenário**: Estudo do perfil do cliente&#10;```&#10;GET /historico/1 → Histórico completo&#10;GET /estatisticas/1 → Métricas consolidadas&#10;```&#10;&#10;---" />
              <option name="updatedContent" value="# Documentação da API - SimulacaoInvestimentoResource&#10;&#10;## Visão Geral&#10;&#10;O `SimulacaoInvestimentoResource` é responsável por realizar simulações de investimentos financeiros e gerenciar o histórico de simulações dos clientes. Permite calcular projeções de rentabilidade, consultar histórico de simulações e obter estatísticas comportamentais.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/simular-investimento`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;**Autenticação global:**&#10;- **Token JWT:** OBRIGATÓRIO para todos os endpoints&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. POST /simular-investimento&#10;**Realiza simulação de investimento**&#10;&#10;`http://localhost:9090/simular-investimento`&#10;&#10;#### Descrição&#10;Calcula a projeção de rentabilidade de um investimento baseado nos parâmetros fornecidos. O sistema busca produtos que atendam aos critérios especificados e retorna o resultado da simulação com o produto validado e valores calculados.&#10;&#10;#### Algoritmo de Simulação&#10;1. **Validação de entrada**: Campos obrigatórios e regras de negócio&#10;2. **Busca de produtos**: Filtragem baseada nos critérios informados&#10;3. **Cálculo financeiro**: Projeção de rentabilidade no prazo especificado&#10;4. **Persistência**: Salvamento da simulação para histórico&#10;5. **Resposta**: Produto validado e resultado calculado&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** Não há validação específica de propriedade&#10;&#10;#### Request&#10;&#10;**URL:** `POST /simular-investimento`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Body (JSON):**&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;produto_id&quot;: 5,&#10;  &quot;valor&quot;: 10000.00,&#10;  &quot;prazoMeses&quot;: 12,&#10;  &quot;tipoProduto&quot;: &quot;CDB&quot;,&#10;  &quot;produto&quot;: &quot;CDB Premium&quot;,&#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 90,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;&#10;**Campos do Request:**&#10;&#10;| Campo | Tipo | Obrigatório | Validação | Descrição |&#10;|-------|------|-------------|-----------|-----------|&#10;| `clienteId` | Long | **Sim** | `@NotNull` | ID do cliente |&#10;| `produto_id` | Long | Não | - | ID específico do produto (opcional) |&#10;| `valor` | BigDecimal | **Sim** | `@NotNull`, `@DecimalMin(&quot;1.00&quot;)`, `@DecimalMax(&quot;999999999.99&quot;)` | Valor do investimento (R$ 1,00 a R$ 999.999.999,99) |&#10;| `prazoMeses` | Integer | **Um obrigatório** | `@Min(1)`, `@Max(600)` | Prazo em meses (1 a 600) |&#10;| `prazoDias` | Integer | **Um obrigatório** | `@Min(1)`, `@Max(18250)` | Prazo em dias (1 a 18.250) |&#10;| `prazoAnos` | Integer | **Um obrigatório** | `@Min(1)`, `@Max(50)` | Prazo em anos (1 a 50) |&#10;| `tipoProduto` | enum | Não | - | Tipo do produto (CDB, LCI, LCA, etc.) |&#10;| `produto` | string | Não | - | Nome do produto para filtrar |&#10;| `tipo_rentabilidade` | enum | Não | - | PRE, POS |&#10;| `indice` | enum | Não | - | CDI, SELIC, IPCA, TR, NENHUM |&#10;| `liquidez` | Integer | Não | `@Min(-1)` | Liquidez desejada (-1 = sem liquidez, &gt;= 0 = dias) |&#10;| `fgc` | Boolean | Não | - | Protegido pelo FGC |&#10;&#10;**Regras de Validação Especiais:**&#10;&#10;1. **Prazo obrigatório**: Pelo menos um campo de prazo deve ser informado (`@ValidPrazo`)&#10;2. **Liquidez**: Deve ser -1 (sem liquidez) ou &gt;= 0 (dias de liquidez)&#10;3. **Prazo máximo**: Não pode exceder 20 anos (240 meses) para simulação precisa&#10;4. **Consistência rentabilidade/índice**:&#10;   - PRE → índice deve ser NENHUM&#10;   - POS → índice deve ser específico (CDI, SELIC, etc.)&#10;&#10;**Exemplo de Request:**&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;valor&quot;: 5000.00,&#10;  &quot;prazoMeses&quot;: 24,&#10;  &quot;tipoProduto&quot;: &quot;CDB&quot;, &#10;  &quot;tipo_rentabilidade&quot;: &quot;POS&quot;,&#10;  &quot;indice&quot;: &quot;CDI&quot;,&#10;  &quot;liquidez&quot;: 30,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;&#10;#### Responses&#10;&#10;##### ✅ 201 - Simulação criada com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;produtoValidado&quot;: {&#10;    &quot;id&quot;: 1,&#10;    &quot;nome&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;tipo&quot;: &quot;CDB&quot;,&#10;    &quot;tipo_rentabilidade&quot;: &quot;POS_FIXADO&quot;,&#10;    &quot;rentabilidade&quot;: 20.0,&#10;    &quot;periodo_rentabilidade&quot;: &quot;AO_ANO&quot;,&#10;    &quot;indice&quot;: &quot;CDI&quot;,&#10;    &quot;liquidez&quot;: 30,&#10;    &quot;minimo_dias_investimento&quot;: 30,&#10;    &quot;fgc&quot;: true,&#10;    &quot;risco&quot;: &quot;BAIXO&quot;&#10;  },&#10;  &quot;resultadoSimulacao&quot;: {&#10;    &quot;valorFinal&quot;: 5624.50,&#10;    &quot;rentabilidadeEfetiva&quot;: 12.49,&#10;    &quot;prazoMeses&quot;: 24,&#10;    &quot;prazoDias&quot;: 720,&#10;    &quot;prazoAnos&quot;: 2,&#10;    &quot;valorInvestido&quot;: 5000.00,&#10;    &quot;rendimento&quot;: 624.50,&#10;    &quot;valorSimulado&quot;: true,&#10;    &quot;cenarioSimulacao&quot;: &quot;Simulação baseada em CDI atual&quot;&#10;  },&#10;  &quot;dataSimulacao&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;simulacaoId&quot;: 123&#10;}&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `produtoValidado` | object | Produto encontrado que atende aos critérios |&#10;| `resultadoSimulacao` | object | Resultado dos cálculos financeiros |&#10;| `resultadoSimulacao.valorFinal` | BigDecimal | Valor total ao final do prazo |&#10;| `resultadoSimulacao.rentabilidadeEfetiva` | BigDecimal | Rentabilidade efetiva calculada (%) |&#10;| `resultadoSimulacao.rendimento` | BigDecimal | Valor do rendimento (valorFinal - valorInvestido) |&#10;| `resultadoSimulacao.valorSimulado` | Boolean | Indica se é uma simulação (true) |&#10;| `resultadoSimulacao.cenarioSimulacao` | string | Descrição do cenário utilizado |&#10;| `dataSimulacao` | datetime | Data/hora da simulação |&#10;| `clienteId` | Long | ID do cliente |&#10;| `simulacaoId` | Long | ID da simulação persistida |&#10;&#10;---&#10;&#10;### 2. GET /simular-investimento/historico/{clienteId}&#10;**Busca histórico de simulações de um cliente**&#10;&#10;`http://localhost:9090/simular-investimento/historico/{clienteId}`&#10;&#10;#### Descrição&#10;Retorna todas as simulações realizadas por um cliente específico, ordenadas por data. Permite acompanhar o comportamento e histórico de simulações para análise de perfil.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** USERs só podem acessar seus próprios dados, ADMINs têm acesso irrestrito&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simular-investimento/historico/{clienteId}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `clienteId` | Long | Sim | `@Positive` | ID único do cliente (deve ser positivo) |&#10;&#10;**Exemplo:** `GET /simular-investimento/historico/1`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Histórico obtido com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 123,&#10;    &quot;produto_id&quot;: 1,&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;valorInvestido&quot;: 5000.00,&#10;    &quot;valorFinal&quot;: 5624.50,&#10;    &quot;prazoMeses&quot;: 24,&#10;    &quot;prazoDias&quot;: 720,&#10;    &quot;prazoAnos&quot;: 2,&#10;    &quot;dataSimulacao&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;    &quot;rentabilidadeEfetiva&quot;: 12.49,&#10;    &quot;rendimento&quot;: 624.50,&#10;    &quot;valorSimulado&quot;: true,&#10;    &quot;cenarioSimulacao&quot;: &quot;Simulação baseada em CDI atual&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 122,&#10;    &quot;produto_id&quot;: 3,&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;produto&quot;: &quot;LCI Banco ABC 95% CDI&quot;,&#10;    &quot;valorInvestido&quot;: 10000.00,&#10;    &quot;valorFinal&quot;: 10950.00,&#10;    &quot;prazoMeses&quot;: 12,&#10;    &quot;prazoDias&quot;: 360,&#10;    &quot;prazoAnos&quot;: 1,&#10;    &quot;dataSimulacao&quot;: &quot;2025-11-10T10:15:00&quot;,&#10;    &quot;rentabilidadeEfetiva&quot;: 9.50,&#10;    &quot;rendimento&quot;: 950.00,&#10;    &quot;valorSimulado&quot;: true,&#10;    &quot;cenarioSimulacao&quot;: &quot;Simulação baseada em CDI atual&quot;&#10;  }&#10;]&#10;```&#10;&#10;---&#10;&#10;### 3. GET /simular-investimento/{id}&#10;**Busca simulação específica por ID**&#10;&#10;`http://localhost:9090/simular-investimento/{id}`&#10;&#10;#### Descrição&#10;Retorna os detalhes de uma simulação específica pelo seu ID. Inclui validação de acesso para garantir que o usuário só acesse simulações próprias (ou todas se for ADMIN).&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** Baseada no clienteId da simulação vs. userId do JWT&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simular-investimento/{id}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `id` | Long | Sim | `@Positive` | ID único da simulação |&#10;&#10;**Exemplo:** `GET /simular-investimento/123`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Simulação encontrada&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;id&quot;: 123,&#10;  &quot;produto_id&quot;: 1,&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;  &quot;valorInvestido&quot;: 5000.00,&#10;  &quot;valorFinal&quot;: 5624.50,&#10;  &quot;prazoMeses&quot;: 24,&#10;  &quot;prazoDias&quot;: 720,&#10;  &quot;prazoAnos&quot;: 2,&#10;  &quot;dataSimulacao&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;rentabilidadeEfetiva&quot;: 12.49,&#10;  &quot;rendimento&quot;: 624.50,&#10;  &quot;valorSimulado&quot;: true,&#10;  &quot;cenarioSimulacao&quot;: &quot;Simulação baseada em CDI atual&quot;&#10;}&#10;```&#10;&#10;---&#10;&#10;### 4. GET /simular-investimento/estatisticas/{clienteId}&#10;**Busca estatísticas de simulações do cliente**&#10;&#10;`http://localhost:9090/simular-investimento/estatisticas/{clienteId}`&#10;&#10;#### Descrição&#10;Retorna estatísticas consolidadas das simulações de um cliente, incluindo totais, médias e última simulação. Útil para análise comportamental e dashboards.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `USER`, `ADMIN`&#10;- **Validação de Acesso:** USERs só podem acessar suas próprias estatísticas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simular-investimento/estatisticas/{clienteId}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `clienteId` | Long | Sim | `@Positive` | ID único do cliente |&#10;&#10;**Exemplo:** `GET /simular-investimento/estatisticas/1`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Estatísticas obtidas com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;totalSimulacoes&quot;: 15,&#10;  &quot;totalInvestido&quot;: 125000.00,&#10;  &quot;mediaValorInvestido&quot;: 8333.33,&#10;  &quot;ultimaSimulacao&quot;: {&#10;    &quot;id&quot;: 123,&#10;    &quot;produto_id&quot;: 1,&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;valorInvestido&quot;: 5000.00,&#10;    &quot;valorFinal&quot;: 5624.50,&#10;    &quot;prazoMeses&quot;: 24,&#10;    &quot;prazoDias&quot;: 720,&#10;    &quot;prazoAnos&quot;: 2,&#10;    &quot;dataSimulacao&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;    &quot;rentabilidadeEfetiva&quot;: 12.49,&#10;    &quot;rendimento&quot;: 624.50,&#10;    &quot;valorSimulado&quot;: true,&#10;    &quot;cenarioSimulacao&quot;: &quot;Simulação baseada em CDI atual&quot;&#10;  }&#10;}&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `totalSimulacoes` | Long | Número total de simulações realizadas |&#10;| `totalInvestido` | BigDecimal | Soma de todos os valores simulados |&#10;| `mediaValorInvestido` | BigDecimal | Valor médio por simulação |&#10;| `ultimaSimulacao` | object | Dados da simulação mais recente (pode ser null) |&#10;&#10;---&#10;&#10;## Status Codes e Erros por Endpoint&#10;&#10;### POST /simular-investimento&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **201** | Created | Simulação criada com sucesso |&#10;| **400** | Bad Request | Validações falharam, regras de negócio violadas |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Role não autorizada |&#10;| **500** | Internal Server Error | Erro interno do sistema |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 400 - Bad Request (Validações)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/simular-investimento&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'clienteId': ID do cliente é obrigatório (valor fornecido: null)&quot;,&#10;    &quot;Campo 'valor': Valor mínimo de investimento é R$ 1,00 (valor fornecido: 0.50)&quot;,&#10;    &quot;Campo 'prazoMeses': Prazo em meses deve ser no mínimo 1 (valor fornecido: 0)&quot;&#10;  ]&#10;}&#10;```&#10;&#10;##### ❌ 400 - Bad Request (Regras de Negócio)&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro de validação: Pelo menos um prazo deve ser informado (prazoMeses, prazoDias ou prazoAnos)&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/simular-investimento&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro de validação: Produtos pré-fixados não devem ter índice específico. Use 'NENHUM' como índice.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/simular-investimento&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro de validação: Prazo muito longo para simulação precisa. Máximo recomendado: 20 anos (240 meses)&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/simular-investimento&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /simular-investimento/historico/{clienteId}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Histórico obtido com sucesso |&#10;| **400** | Bad Request | clienteId inválido (não positivo) |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | USER tentando acessar dados de outro cliente |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/simular-investimento/historico/2&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /simular-investimento/{id}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Simulação encontrada |&#10;| **400** | Bad Request | ID inválido (não positivo) |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Tentativa de acessar simulação de outro cliente |&#10;| **404** | Not Found | Simulação não encontrada |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 404 - Not Found&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Simulação não encontrada com ID: 999&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 404,&#10;  &quot;path&quot;: &quot;/simular-investimento/999&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/simular-investimento/123&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /simular-investimento/estatisticas/{clienteId}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Estatísticas obtidas |&#10;| **400** | Bad Request | clienteId inválido |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Acesso negado aos dados do cliente |&#10;| **500** | Internal Server Error | Erro interno |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/simular-investimento/estatisticas/2&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Consolidados&#10;&#10;| Status | Nome | Descrição | Endpoints Afetados |&#10;|--------|------|-----------|-------------------|&#10;| **200** | OK | Sucesso | GET (historico, por ID, estatísticas) |&#10;| **201** | Created | Simulação criada | POST |&#10;| **400** | Bad Request | Validações/regras violadas | Todos |&#10;| **401** | Unauthorized | Token inválido | Todos |&#10;| **403** | Forbidden | Sem permissão específica | Todos autenticados |&#10;| **404** | Not Found | Simulação não encontrada | GET /{id} |&#10;| **500** | Internal Server Error | Erro interno | Todos |&#10;&#10;### Categorias de Mensagens de Erro&#10;&#10;####  Erros de Validação (400)&#10;&#10;**Campos obrigatórios:**&#10;- `&quot;ID do cliente é obrigatório&quot;`&#10;- `&quot;Valor do investimento é obrigatório&quot;`&#10;&#10;**Validações de range:**&#10;- `&quot;Valor mínimo de investimento é R$ 1,00&quot;`&#10;- `&quot;Valor máximo de investimento é R$ 999.999.999,99&quot;`&#10;- `&quot;Prazo em meses deve ser no mínimo 1&quot;`&#10;- `&quot;Prazo em meses deve ser no máximo 600 (50 anos)&quot;`&#10;- `&quot;Liquidez deve ser -1 (sem liquidez) ou &gt;= 0&quot;`&#10;&#10;**Validações customizadas:**&#10;- `&quot;Pelo menos um prazo deve ser informado (prazoMeses, prazoDias ou prazoAnos)&quot;`&#10;&#10;**Regras de negócio:**&#10;- `&quot;Liquidez deve ser -1 (sem liquidos) ou o número de dias desejado.&quot;`&#10;- `&quot;Prazo muito longo para simulação precisa. Máximo recomendado: 20 anos (240 meses)&quot;`&#10;- `&quot;Produtos pré-fixados não devem ter índice específico. Use 'NENHUM' como índice.&quot;`&#10;- `&quot;Produtos pós-fixados devem ter um índice específico (CDI, SELIC, IPCA, etc.)&quot;`&#10;&#10;####  Erros de Autenticação (401)&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#10;&#10;####  Erros de Autorização (403)&#10;- `&quot;Acesso negado: usuário só pode acessar seus próprios dados&quot;`&#10;- `&quot;Token JWT não encontrado&quot;`&#10;- `&quot;Acesso negado: role não autorizada&quot;`&#10;&#10;####  Erros de Recurso (404)&#10;- `&quot;Simulação não encontrada com ID: {id}&quot;`&#10;&#10;####  Erros Internos (500)&#10;- `&quot;Erro interno do servidor: {detalhes do erro}&quot;`&#10;&#10;---&#10;&#10;## Tipos de Produtos e Enums&#10;&#10;### TipoProduto&#10;- `CDB`: Certificado de Depósito Bancário&#10;- `LCI`: Letra de Crédito Imobiliário  &#10;- `LCA`: Letra de Crédito do Agronegócio&#10;- `TESOURO_DIRETO`: Títulos do Tesouro Nacional&#10;- `POUPANCA`: Caderneta de Poupança&#10;- `DEBENTURE`: Debêntures corporativas&#10;- `CRI`: Certificado de Recebíveis Imobiliários&#10;- `FUNDO`: Fundos de Investimento&#10;- `FII`: Fundos de Investimento Imobiliário&#10;- `ACAO`: Ações de empresas&#10;- `ETF`: Exchange Traded Funds&#10;&#10;### TipoRentabilidade&#10;- `PRE`: Taxa conhecida no momento da aplicação&#10;- `POS`: Taxa vinculada a um índice&#10;&#10;### Indice&#10;- `CDI`: Certificado de Depósito Interbancário&#10;- `SELIC`: Sistema Especial de Liquidação e Custódia&#10;- `IPCA`: Índice Nacional de Preços ao Consumidor Amplo&#10;- `TR`: Taxa Referencial&#10;- `NENHUM`: Produtos pré-fixados&#10;&#10;### NivelRisco&#10;- `BAIXO`: Produtos garantidos pelo FGC&#10;- `MEDIO`: Renda fixa sem garantia FGC&#10;- `ALTO`: Renda variável sem garantias&#10;&#10;---&#10;&#10;## Algoritmo de Simulação&#10;&#10;### Etapas do Processo&#10;&#10;1. **Validação de Entrada**&#10;   - Bean Validation nos campos&#10;   - Validação customizada @ValidPrazo&#10;   - Regras de negócio específicas&#10;&#10;2. **Busca de Produtos**&#10;   - Filtragem por critérios informados&#10;   - Priorização por produto_id se especificado&#10;   - Fallback para produtos compatíveis&#10;&#10;3. **Cálculos Financeiros**&#10;   - Aplicação de fórmulas de juros compostos&#10;   - Consideração de índices econômicos&#10;   - Projeção para o prazo especificado&#10;&#10;4. **Persistência**&#10;   - Salvamento da simulação no banco&#10;   - Geração de ID único&#10;   - Associação ao cliente&#10;&#10;5. **Resposta**&#10;   - Produto validado encontrado&#10;   - Resultado dos cálculos&#10;   - Metadados da simulação&#10;&#10;### Validações Especiais&#10;&#10;#### Consistência Rentabilidade vs. Índice&#10;```java&#10;// PRE_FIXADO deve ter índice NENHUM&#10;if (tipoRentabilidade == PRE &amp;&amp; indice != NENHUM) {&#10;    throw erro(&quot;Pré-fixado não deve ter índice&quot;);&#10;}&#10;&#10;// POS_FIXADO deve ter índice específico  &#10;if (tipoRentabilidade == POS &amp;&amp; indice == NENHUM) {&#10;    throw erro(&quot;Pós-fixado deve ter índice&quot;);&#10;}&#10;```&#10;&#10;#### Prazo Máximo&#10;```java&#10;if (prazoMeses &gt; 240) { // 20 anos&#10;    throw erro(&quot;Prazo muito longo&quot;);&#10;}&#10;```&#10;&#10;---&#10;&#10;## Informações Técnicas&#10;&#10;### Autenticação e Autorização&#10;&#10;**Validação de Propriedade:**&#10;- Utiliza `JwtAuthorizationHelper.validarAcessoAoCliente()`&#10;- **ADMIN**: Acesso irrestrito&#10;- **USER**: Apenas dados próprios (baseado em `userId` no JWT)&#10;&#10;**Endpoints com Validação de Acesso:**&#10;- `GET /historico/{clienteId}`: Valida acesso ao cliente&#10;- `GET /{id}`: Valida acesso via clienteId da simulação&#10;- `GET /estatisticas/{clienteId}`: Valida acesso ao cliente&#10;- `POST /`: Sem validação específica (qualquer user pode simular)&#10;&#10;### Dependências do Sistema&#10;&#10;- **SimulacaoInvestimentoService**: Lógica de negócio&#10;- **ProdutoRepository**: Busca de produtos disponíveis&#10;- **SimulacaoRepository**: Persistência de simulações&#10;- **ClienteService**: Validação de clientes (indireta)&#10;- **JwtAuthorizationHelper**: Controle de acesso&#10;- **SimulacaoInvestimentoMapper**: Conversão entidade → DTO&#10;&#10;### Performance&#10;&#10;- **Cálculos intensivos**: Simulações com múltiplos produtos&#10;- **Consultas ao banco**: Filtragem de produtos por critérios&#10;- **Persistência**: Cada simulação é salva&#10;- **Sem cache**: Recalcula sempre (dados atuais de mercado)&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Simulação básica:**&#10;```bash&#10;curl -X POST http://localhost:9090/simular-investimento \&#10;  -H &quot;Authorization: Bearer {token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;valor&quot;: 10000.00,&#10;    &quot;prazoMeses&quot;: 12,&#10;    &quot;tipoProduto&quot;: &quot;CDB&quot;,&#10;    &quot;liquidez&quot;: 90,&#10;    &quot;fgc&quot;: true&#10;  }'&#10;```&#10;&#10;**Buscar histórico:**&#10;```bash&#10;curl -X GET http://localhost:9090/simular-investimento/historico/1 \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;**Buscar simulação específica:**&#10;```bash&#10;curl -X GET http://localhost:9090/simular-investimento/123 \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;**Obter estatísticas:**&#10;```bash&#10;curl -X GET http://localhost:9090/simular-investimento/estatisticas/1 \&#10;  -H &quot;Authorization: Bearer {token}&quot;&#10;```&#10;&#10;### Respostas Típicas&#10;&#10;**Simulação bem-sucedida:**&#10;```json&#10;{&#10;  &quot;produtoValidado&quot;: {&#10;    &quot;nome&quot;: &quot;CDB Premium 115% CDI&quot;,&#10;    &quot;rentabilidade&quot;: 15.0,&#10;    &quot;fgc&quot;: true&#10;  },&#10;  &quot;resultadoSimulacao&quot;: {&#10;    &quot;valorFinal&quot;: 11150.00,&#10;    &quot;rendimento&quot;: 1150.00,&#10;    &quot;rentabilidadeEfetiva&quot;: 11.5&#10;  },&#10;  &quot;simulacaoId&quot;: 124&#10;}&#10;```&#10;&#10;**Erro de validação:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Dados inválidos fornecidos&quot;,&#10;  &quot;errors&quot;: [&#10;    &quot;Campo 'valor': Valor mínimo de investimento é R$ 1,00&quot;&#10;  ]&#10;}&#10;```&#10;&#10;&#10;&#10;---&#10;&#10;## Casos de Uso Típicos&#10;&#10;### 1. Simulação Exploratória&#10;**Cenário**: Cliente quer conhecer opções de investimento&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;valor&quot;: 5000.00,&#10;  &quot;prazoMeses&quot;: 12,&#10;  &quot;fgc&quot;: true&#10;}&#10;```&#10;→ Sistema retorna melhor produto com FGC&#10;&#10;### 2. Simulação Direcionada&#10;**Cenário**: Cliente quer simular produto específico&#10;```json&#10;{&#10;  &quot;clienteId&quot;: 1,&#10;  &quot;produto_id&quot;: 5,&#10;  &quot;valor&quot;: 10000.00,&#10;  &quot;prazoAnos&quot;: 2&#10;}&#10;```&#10;→ Simulação do produto ID 5&#10;&#10;### 3. Comparação de Cenários&#10;**Cenário**: Cliente testa diferentes prazos&#10;```&#10;POST com prazoMeses: 12 → Resultado A&#10;POST com prazoMeses: 24 → Resultado B  &#10;POST com prazoMeses: 36 → Resultado C&#10;```&#10;&#10;### 4. Análise Comportamental&#10;**Cenário**: Estudo do perfil do cliente&#10;```&#10;GET /historico/1 → Histórico completo&#10;GET /estatisticas/1 → Métricas consolidadas&#10;```&#10;&#10;---" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/docs/DOCUMENTACAO_SIMULACAO_RESOURCE.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/docs/DOCUMENTACAO_SIMULACAO_RESOURCE.md" />
              <option name="originalContent" value="# Documentação da API - SimulacaoResource&#10;&#10;## Visão Geral&#10;&#10;O `SimulacaoResource` é responsável por fornecer funcionalidades de consulta e análise agregada das simulações de investimentos realizadas na plataforma. Permite visualizar todas as simulações e obter insights através de agrupamentos por produto e período temporal.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/simulacoes`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;**Autenticação global:**&#10;- **Token JWT:** OBRIGATÓRIO para todos os endpoints&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;&#10;**Características:**&#10;- **Acesso restrito**: Apenas usuários com role ADMIN&#10;- **Dados consolidados**: Informações agregadas de simulações&#10;- **Análise temporal**: Agrupamentos por dia, mês e ano&#10;- **Insights estatísticos**: Médias, quantidades e totais&#10;- **Ordenação inteligente**: Resultados ordenados por produto e período&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. GET /simulacoes&#10;**Lista todas as simulações realizadas**&#10;&#10;#### Descrição&#10;Retorna uma lista completa de todas as simulações de investimentos realizadas na plataforma, incluindo dados detalhados de cada simulação. Útil para análise completa do histórico de simulações de todos os clientes.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;- **Validação de Acesso:** Apenas administradores podem acessar dados consolidados&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simulacoes`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Parâmetros:** Nenhum&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 123,&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;valorInvestido&quot;: 10000.00,&#10;    &quot;valorFinal&quot;: 11250.00,&#10;    &quot;prazoMeses&quot;: 12,&#10;    &quot;prazoDias&quot;: 365,&#10;    &quot;prazoAnos&quot;: 1,&#10;    &quot;dataSimulacao&quot;: &quot;2025-11-15T14:30:00&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 124,&#10;    &quot;clienteId&quot;: 2,&#10;    &quot;produto&quot;: &quot;LCI Banco ABC 95% CDI&quot;,&#10;    &quot;valorInvestido&quot;: 5000.00,&#10;    &quot;valorFinal&quot;: 5475.00,&#10;    &quot;prazoMeses&quot;: 12,&#10;    &quot;prazoDias&quot;: 365,&#10;    &quot;prazoAnos&quot;: 1,&#10;    &quot;dataSimulacao&quot;: &quot;2025-11-15T15:45:00&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 125,&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;produto&quot;: &quot;CDB Premium 130% CDI&quot;,&#10;    &quot;valorInvestido&quot;: 25000.00,&#10;    &quot;valorFinal&quot;: 28750.00,&#10;    &quot;prazoMeses&quot;: 18,&#10;    &quot;prazoDias&quot;: 540,&#10;    &quot;prazoAnos&quot;: 1,&#10;    &quot;dataSimulacao&quot;: &quot;2025-11-14T09:20:00&quot;&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `id` | Long | ID único da simulação |&#10;| `clienteId` | Long | ID do cliente que realizou a simulação |&#10;| `produto` | String | Nome do produto simulado |&#10;| `valorInvestido` | BigDecimal | Valor inicial do investimento |&#10;| `valorFinal` | BigDecimal | Valor final projetado |&#10;| `prazoMeses` | Integer | Prazo da simulação em meses |&#10;| `prazoDias` | Integer | Prazo da simulação em dias |&#10;| `prazoAnos` | Integer | Prazo da simulação em anos |&#10;| `dataSimulacao` | LocalDateTime | Data e hora da realização da simulação |&#10;&#10;**Ordenação:** Natural do banco de dados (por ID crescente)&#10;&#10;---&#10;&#10;### 2. GET /simulacoes/por-produto-dia&#10;**Agrupamento de simulações por produto e data**&#10;&#10;#### Descrição&#10;Retorna um agrupamento das simulações organizadas por produto e data específica (sem considerar horário). Para cada combinação produto/data, calcula estatísticas agregadas como quantidade total, valor médio investido e valor médio final projetado.&#10;&#10;#### Algoritmo de Agrupamento&#10;1. **Filtragem**: Remove simulações com dados nulos (produto ou data)&#10;2. **Agrupamento**: Organiza por nome do produto → data (LocalDate)&#10;3. **Cálculos estatísticos**:&#10;   - Soma dos valores investidos e finais&#10;   - Média aritmética com precisão de 2 casas decimais&#10;   - Arredondamento HALF_UP&#10;4. **Ordenação**: Primeiro por produto (alfabética), depois por data (cronológica)&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simulacoes/por-produto-dia`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Parâmetros:** Nenhum&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;data&quot;: &quot;2025-11-15&quot;,&#10;    &quot;quantidadeSimulacoes&quot;: 3,&#10;    &quot;mediaValorInvestido&quot;: 15000.00,&#10;    &quot;mediaValorFinal&quot;: 16875.00&#10;  },&#10;  {&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;, &#10;    &quot;data&quot;: &quot;2025-11-14&quot;,&#10;    &quot;quantidadeSimulacoes&quot;: 1,&#10;    &quot;mediaValorInvestido&quot;: 25000.00,&#10;    &quot;mediaValorFinal&quot;: 28750.00&#10;  },&#10;  {&#10;    &quot;produto&quot;: &quot;LCI Banco ABC 95% CDI&quot;,&#10;    &quot;data&quot;: &quot;2025-11-15&quot;,&#10;    &quot;quantidadeSimulacoes&quot;: 2,&#10;    &quot;mediaValorInvestido&quot;: 7500.00,&#10;    &quot;mediaValorFinal&quot;: 8212.50&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `produto` | String | Nome do produto agrupado |&#10;| `data` | LocalDate | Data das simulações (formato: YYYY-MM-DD) |&#10;| `quantidadeSimulacoes` | Long | Número total de simulações no período |&#10;| `mediaValorInvestido` | BigDecimal | Valor médio investido no período |&#10;| `mediaValorFinal` | BigDecimal | Valor médio final projetado |&#10;&#10;**Ordenação:** Por produto (alfabética) → por data (cronológica crescente)&#10;&#10;---&#10;&#10;### 3. GET /simulacoes/por-produto-mes&#10;**Agrupamento de simulações por produto e mês**&#10;&#10;#### Descrição&#10;Retorna um agrupamento das simulações organizadas por produto e mês/ano (YearMonth). Consolida dados mensais para análise de tendências e comportamentos sazonais de simulações por produto.&#10;&#10;#### Algoritmo de Agrupamento&#10;1. **Filtragem**: Remove simulações com dados nulos&#10;2. **Agrupamento**: Organiza por produto → YearMonth (ano-mês)&#10;3. **Cálculos estatísticos**: Mesma lógica do agrupamento diário&#10;4. **Ordenação**: Produto alfabética → ano-mês cronológico&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simulacoes/por-produto-mes`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Parâmetros:** Nenhum&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;mes&quot;: &quot;2025-11&quot;,&#10;    &quot;quantidadeSimulacoes&quot;: 15,&#10;    &quot;mediaValorInvestido&quot;: 18500.00,&#10;    &quot;mediaValorFinal&quot;: 20812.50&#10;  },&#10;  {&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;mes&quot;: &quot;2025-10&quot;, &#10;    &quot;quantidadeSimulacoes&quot;: 8,&#10;    &quot;mediaValorInvestido&quot;: 12000.00,&#10;    &quot;mediaValorFinal&quot;: 13500.00&#10;  },&#10;  {&#10;    &quot;produto&quot;: &quot;LCI Banco ABC 95% CDI&quot;,&#10;    &quot;mes&quot;: &quot;2025-11&quot;,&#10;    &quot;quantidadeSimulacoes&quot;: 12,&#10;    &quot;mediaValorInvestido&quot;: 9750.00,&#10;    &quot;mediaValorFinal&quot;: 10687.50&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `produto` | String | Nome do produto agrupado |&#10;| `mes` | YearMonth | Mês/ano das simulações (formato: YYYY-MM) |&#10;| `quantidadeSimulacoes` | Long | Número total de simulações no mês |&#10;| `mediaValorInvestido` | BigDecimal | Valor médio investido no mês |&#10;| `mediaValorFinal` | BigDecimal | Valor médio final projetado no mês |&#10;&#10;**Ordenação:** Por produto (alfabética) → por ano-mês (cronológica crescente)&#10;&#10;---&#10;&#10;### 4. GET /simulacoes/por-produto-ano&#10;**Agrupamento de simulações por produto e ano**&#10;&#10;#### Descrição&#10;Retorna um agrupamento das simulações organizadas por produto e ano. Fornece uma visão consolidada anual para análise de tendências de longo prazo e evolução dos produtos ao longo do tempo.&#10;&#10;#### Algoritmo de Agrupamento&#10;1. **Filtragem**: Remove simulações com dados nulos&#10;2. **Agrupamento**: Organiza por produto → Year (ano)&#10;3. **Cálculos estatísticos**: Mesma lógica dos demais agrupamentos&#10;4. **Ordenação**: Produto alfabética → ano cronológico&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simulacoes/por-produto-ano`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Parâmetros:** Nenhum&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;ano&quot;: 2025,&#10;    &quot;quantidadeSimulacoes&quot;: 145,&#10;    &quot;mediaValorInvestido&quot;: 16750.00,&#10;    &quot;mediaValorFinal&quot;: 18843.75&#10;  },&#10;  {&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;ano&quot;: 2024,&#10;    &quot;quantidadeSimulacoes&quot;: 89,&#10;    &quot;mediaValorInvestido&quot;: 14200.00,&#10;    &quot;mediaValorFinal&quot;: 15975.00&#10;  },&#10;  {&#10;    &quot;produto&quot;: &quot;LCI Banco ABC 95% CDI&quot;,&#10;    &quot;ano&quot;: 2025,&#10;    &quot;quantidadeSimulacoes&quot;: 78,&#10;    &quot;mediaValorInvestido&quot;: 11850.00,&#10;    &quot;mediaValorFinal&quot;: 13002.75&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `produto` | String | Nome do produto agrupado |&#10;| `ano` | Year | Ano das simulações (formato: YYYY) |&#10;| `quantidadeSimulacoes` | Long | Número total de simulações no ano |&#10;| `mediaValorInvestido` | BigDecimal | Valor médio investido no ano |&#10;| `mediaValorFinal` | BigDecimal | Valor médio final projetado no ano |&#10;&#10;**Ordenação:** Por produto (alfabética) → por ano (cronológica crescente)&#10;&#10;---&#10;&#10;## Status Codes e Erros por Endpoint&#10;&#10;### Todos os Endpoints (Padrão Geral)&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Consulta executada com sucesso |&#10;| **401** | Unauthorized | Token JWT ausente, inválido ou expirado |&#10;| **403** | Forbidden | Role diferente de ADMIN ou token sem permissões |&#10;| **500** | Internal Server Error | Erro interno do sistema ou banco de dados |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 401 - Unauthorized&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/simulacoes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Token JWT inválido ou expirado&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;, &#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/simulacoes/por-produto-dia&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: apenas usuários com role ADMIN podem acessar este recurso&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/simulacoes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Token JWT não encontrado&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/simulacoes/por-produto-mes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 500 - Internal Server Error&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Falha na conexão com o banco de dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/simulacoes/por-produto-ano&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Falha no processamento dos agrupamentos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/simulacoes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Consolidados&#10;&#10;| Status | Nome | Descrição | Todos os Endpoints |&#10;|--------|------|-----------|-------------------|&#10;| **200** | OK | Consulta bem-sucedida | ✅ |&#10;| **401** | Unauthorized | Token ausente/inválido | ✅ |&#10;| **403** | Forbidden | Role não autorizada (não-ADMIN) | ✅ |&#10;| **500** | Internal Server Error | Erro interno/banco | ✅ |&#10;&#10;### Categorias de Mensagens de Erro&#10;&#10;####  Erros de Autenticação (401)&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#10;- `&quot;Token JWT inválido ou expirado&quot;`&#10;- `&quot;Credenciais inválidas&quot;`&#10;&#10;####  Erros de Autorização (403)&#10;- `&quot;Acesso negado: apenas usuários com role ADMIN podem acessar este recurso&quot;`&#10;- `&quot;Token JWT não encontrado&quot;`&#10;- `&quot;Acesso negado: role não autorizada&quot;`&#10;&#10;####  Erros Internos (500)&#10;- `&quot;Erro interno do servidor: Falha na conexão com o banco de dados&quot;`&#10;- `&quot;Erro interno do servidor: Falha no processamento dos agrupamentos&quot;`&#10;- `&quot;Erro interno do servidor: Timeout na consulta ao banco&quot;`&#10;&#10;---&#10;&#10;## Características Técnicas&#10;&#10;### Algoritmos de Agrupamento&#10;&#10;#### Filtragem de Dados&#10;```java&#10;// Remove simulações com dados inconsistentes&#10;simulacoes.stream()&#10;    .filter(s -&gt; s != null &amp;&amp; &#10;                 s.getProduto() != null &amp;&amp; &#10;                 s.getDataSimulacao() != null)&#10;```&#10;&#10;#### Cálculos Estatísticos&#10;```java&#10;// Média com precisão decimal&#10;BigDecimal media = quantidadeSimulacoes &gt; 0 ? &#10;    soma.divide(BigDecimal.valueOf(quantidadeSimulacoes), 2, RoundingMode.HALF_UP) :&#10;    BigDecimal.ZERO;&#10;```&#10;&#10;#### Estratégia de Ordenação&#10;1. **Primeira ordenação**: Nome do produto (alfabética crescente)&#10;2. **Segunda ordenação**: Período temporal (cronológica crescente)&#10;3. **Tie-breaking**: Por ID da simulação quando necessário&#10;&#10;### Performance e Otimização&#10;&#10;#### Consultas ao Banco&#10;- **Estratégia**: Uma única consulta `listAll()` por endpoint&#10;- **Processamento**: Agrupamento em memória via Streams API&#10;- **Complexidade**: O(n log n) devido à ordenação&#10;&#10;#### Uso de Memória&#10;- **Armazenamento temporário**: Mapas hierárquicos para agrupamento&#10;- **Streams**: Processamento lazy quando possível&#10;- **Garbage Collection**: Estruturas temporárias descartadas automaticamente&#10;&#10;#### Recomendações de Performance&#10;1. **Paginação**: Considerar implementar para grandes volumes&#10;2. **Cache**: Implementar cache Redis para consultas frequentes&#10;3. **Índices**: Otimizar índices na tabela simulacao_investimento&#10;4. **Filtragem SQL**: Mover filtros para queries SQL quando possível&#10;&#10;### Dependências do Sistema&#10;&#10;- **SimulacaoInvestimento**: Model/Entity principal&#10;- **Panache ORM**: Framework de persistência&#10;- **JAX-RS**: REST API framework&#10;- **Java Streams API**: Processamento funcional&#10;- **BigDecimal**: Precisão monetária&#10;- **Java Time API**: Manipulação de datas (LocalDate, YearMonth, Year)&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Listar todas simulações:**&#10;```bash&#10;curl -X GET http://localhost:9090/simulacoes \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Agrupamento por produto e dia:**&#10;```bash&#10;curl -X GET http://localhost:9090/simulacoes/por-produto-dia \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot;&#10;```&#10;&#10;**Agrupamento por produto e mês:**&#10;```bash&#10;curl -X GET http://localhost:9090/simulacoes/por-produto-mes \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot;&#10;```&#10;&#10;**Agrupamento por produto e ano:**&#10;```bash&#10;curl -X GET http://localhost:9090/simulacoes/por-produto-ano \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot;&#10;```&#10;&#10;### Respostas Típicas&#10;&#10;**Lista de simulações (vazia):**&#10;```json&#10;[]&#10;```&#10;&#10;**Agrupamento sem dados:**&#10;```json&#10;[]&#10;```&#10;&#10;**Erro de autorização:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: apenas usuários com role ADMIN podem acessar este recurso&quot;,&#10;  &quot;status&quot;: 403&#10;}&#10;```&#10;&#10;&#10;&#10;---&#10;&#10;## Casos de Uso Típicos&#10;&#10;### 1. Dashboard Administrativo&#10;**Cenário**: Visão geral das simulações da plataforma&#10;```&#10;GET /simulacoes → Lista completa&#10;GET /simulacoes/por-produto-mes → Tendências mensais&#10;```&#10;&#10;### 2. Análise de Produtos&#10;**Cenário**: Identificar produtos mais simulados&#10;```&#10;GET /simulacoes/por-produto-dia → Detalhamento diário&#10;GET /simulacoes/por-produto-ano → Comparação anual&#10;```&#10;&#10;### 3. Relatórios Executivos&#10;**Cenário**: KPIs e métricas de negócio&#10;```&#10;GET /simulacoes/por-produto-mes → Volume mensal por produto&#10;GET /simulacoes/por-produto-ano → Crescimento anual&#10;```&#10;&#10;### 4. Auditoria e Compliance&#10;**Cenário**: Rastreabilidade completa&#10;```&#10;GET /simulacoes → Histórico completo para auditoria&#10;```&#10;&#10;---&#10;&#10;## Considerações de Segurança&#10;&#10;### Controle de Acesso Rigoroso&#10;1. **Role exclusiva**: Apenas ADMIN pode acessar&#10;2. **Dados sensíveis**: Informações financeiras de todos os clientes&#10;3. **Auditoria**: Logs de acesso necessários&#10;4. **Monitoramento**: Alertas para acessos suspeitos&#10;&#10;### Proteção de Dados&#10;1. **LGPD/GDPR**: Dados pessoais de investimento&#10;2. **Anonimização**: Considerar remover clienteId em alguns cenários&#10;3. **Retenção**: Políticas de armazenamento de longo prazo&#10;4. **Backup**: Estratégias de backup e recovery&#10;&#10;### Recomendações de Segurança&#10;1. **Rate Limiting**: Limitar consultas por administrador&#10;2. **Logs de Auditoria**: Registrar todos os acessos&#10;3. **Filtros por Período**: Evitar consultas de grandes volumes&#10;4. **IP Whitelist**: Restringir acesso por localização&#10;5. **Two-Factor Auth**: Autenticação dupla para ADMINs&#10;&#10;---&#10;&#10;## Análise de Dados e Insights&#10;&#10;### Métricas Disponíveis&#10;&#10;#### Por Simulação Individual&#10;- Valor investido e projeção final&#10;- Prazo de investimento (dias/meses/anos)&#10;- Produto escolhido&#10;- Cliente realizador&#10;- Timestamp da simulação&#10;&#10;#### Por Agrupamento (Dia/Mês/Ano)&#10;- Quantidade total de simulações&#10;- Valor médio investido&#10;- Valor médio final projetado&#10;- Distribuição por produto&#10;- Tendências temporais" />
              <option name="updatedContent" value="# Documentação da API - SimulacaoResource&#10;&#10;## Visão Geral&#10;&#10;O `SimulacaoResource` é responsável por fornecer funcionalidades de consulta e análise agregada das simulações de investimentos realizadas na plataforma. Permite visualizar todas as simulações e obter insights através de agrupamentos por produto e período temporal.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/simulacoes`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;**Autenticação global:**&#10;- **Token JWT:** OBRIGATÓRIO para todos os endpoints&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;&#10;**Características:**&#10;- **Acesso restrito**: Apenas usuários com role ADMIN&#10;- **Dados consolidados**: Informações agregadas de simulações&#10;- **Análise temporal**: Agrupamentos por dia, mês e ano&#10;- **Insights estatísticos**: Médias, quantidades e totais&#10;- **Ordenação inteligente**: Resultados ordenados por produto e período&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. GET /simulacoes&#10;**Lista todas as simulações realizadas**&#10;&#10;`http://localhost:9090/simulacoes`&#10;&#10;#### Descrição&#10;Retorna uma lista completa de todas as simulações de investimentos realizadas na plataforma, incluindo dados detalhados de cada simulação. Útil para análise completa do histórico de simulações de todos os clientes.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;- **Validação de Acesso:** Apenas administradores podem acessar dados consolidados&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simulacoes`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Parâmetros:** Nenhum&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 123,&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;valorInvestido&quot;: 10000.00,&#10;    &quot;valorFinal&quot;: 11250.00,&#10;    &quot;prazoMeses&quot;: 12,&#10;    &quot;prazoDias&quot;: 365,&#10;    &quot;prazoAnos&quot;: 1,&#10;    &quot;dataSimulacao&quot;: &quot;2025-11-15T14:30:00&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 124,&#10;    &quot;clienteId&quot;: 2,&#10;    &quot;produto&quot;: &quot;LCI Banco ABC 95% CDI&quot;,&#10;    &quot;valorInvestido&quot;: 5000.00,&#10;    &quot;valorFinal&quot;: 5475.00,&#10;    &quot;prazoMeses&quot;: 12,&#10;    &quot;prazoDias&quot;: 365,&#10;    &quot;prazoAnos&quot;: 1,&#10;    &quot;dataSimulacao&quot;: &quot;2025-11-15T15:45:00&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 125,&#10;    &quot;clienteId&quot;: 1,&#10;    &quot;produto&quot;: &quot;CDB Premium 130% CDI&quot;,&#10;    &quot;valorInvestido&quot;: 25000.00,&#10;    &quot;valorFinal&quot;: 28750.00,&#10;    &quot;prazoMeses&quot;: 18,&#10;    &quot;prazoDias&quot;: 540,&#10;    &quot;prazoAnos&quot;: 1,&#10;    &quot;dataSimulacao&quot;: &quot;2025-11-14T09:20:00&quot;&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `id` | Long | ID único da simulação |&#10;| `clienteId` | Long | ID do cliente que realizou a simulação |&#10;| `produto` | String | Nome do produto simulado |&#10;| `valorInvestido` | BigDecimal | Valor inicial do investimento |&#10;| `valorFinal` | BigDecimal | Valor final projetado |&#10;| `prazoMeses` | Integer | Prazo da simulação em meses |&#10;| `prazoDias` | Integer | Prazo da simulação em dias |&#10;| `prazoAnos` | Integer | Prazo da simulação em anos |&#10;| `dataSimulacao` | LocalDateTime | Data e hora da realização da simulação |&#10;&#10;**Ordenação:** Natural do banco de dados (por ID crescente)&#10;&#10;---&#10;&#10;### 2. GET /simulacoes/por-produto-dia&#10;**Agrupamento de simulações por produto e data**&#10;&#10;`http://localhost:9090/simulacoes/por-produto-dia`&#10;&#10;#### Descrição&#10;Retorna um agrupamento das simulações organizadas por produto e data específica (sem considerar horário). Para cada combinação produto/data, calcula estatísticas agregadas como quantidade total, valor médio investido e valor médio final projetado.&#10;&#10;#### Algoritmo de Agrupamento&#10;1. **Filtragem**: Remove simulações com dados nulos (produto ou data)&#10;2. **Agrupamento**: Organiza por nome do produto → data (LocalDate)&#10;3. **Cálculos estatísticos**:&#10;   - Soma dos valores investidos e finais&#10;   - Média aritmética com precisão de 2 casas decimais&#10;   - Arredondamento HALF_UP&#10;4. **Ordenação**: Primeiro por produto (alfabética), depois por data (cronológica)&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simulacoes/por-produto-dia`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Parâmetros:** Nenhum&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;data&quot;: &quot;2025-11-15&quot;,&#10;    &quot;quantidadeSimulacoes&quot;: 3,&#10;    &quot;mediaValorInvestido&quot;: 15000.00,&#10;    &quot;mediaValorFinal&quot;: 16875.00&#10;  },&#10;  {&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;, &#10;    &quot;data&quot;: &quot;2025-11-14&quot;,&#10;    &quot;quantidadeSimulacoes&quot;: 1,&#10;    &quot;mediaValorInvestido&quot;: 25000.00,&#10;    &quot;mediaValorFinal&quot;: 28750.00&#10;  },&#10;  {&#10;    &quot;produto&quot;: &quot;LCI Banco ABC 95% CDI&quot;,&#10;    &quot;data&quot;: &quot;2025-11-15&quot;,&#10;    &quot;quantidadeSimulacoes&quot;: 2,&#10;    &quot;mediaValorInvestido&quot;: 7500.00,&#10;    &quot;mediaValorFinal&quot;: 8212.50&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `produto` | String | Nome do produto agrupado |&#10;| `data` | LocalDate | Data das simulações (formato: YYYY-MM-DD) |&#10;| `quantidadeSimulacoes` | Long | Número total de simulações no período |&#10;| `mediaValorInvestido` | BigDecimal | Valor médio investido no período |&#10;| `mediaValorFinal` | BigDecimal | Valor médio final projetado |&#10;&#10;**Ordenação:** Por produto (alfabética) → por data (cronológica crescente)&#10;&#10;---&#10;&#10;### 3. GET /simulacoes/por-produto-mes&#10;**Agrupamento de simulações por produto e mês**&#10;&#10;`http://localhost:9090/simulacoes/por-produto-mes`&#10;&#10;#### Descrição&#10;Retorna um agrupamento das simulações organizadas por produto e mês/ano (YearMonth). Consolida dados mensais para análise de tendências e comportamentos sazonais de simulações por produto.&#10;&#10;#### Algoritmo de Agrupamento&#10;1. **Filtragem**: Remove simulações com dados nulos&#10;2. **Agrupamento**: Organiza por produto → YearMonth (ano-mês)&#10;3. **Cálculos estatísticos**: Mesma lógica do agrupamento diário&#10;4. **Ordenação**: Produto alfabética → ano-mês cronológico&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simulacoes/por-produto-mes`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Parâmetros:** Nenhum&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;mes&quot;: &quot;2025-11&quot;,&#10;    &quot;quantidadeSimulacoes&quot;: 15,&#10;    &quot;mediaValorInvestido&quot;: 18500.00,&#10;    &quot;mediaValorFinal&quot;: 20812.50&#10;  },&#10;  {&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;mes&quot;: &quot;2025-10&quot;, &#10;    &quot;quantidadeSimulacoes&quot;: 8,&#10;    &quot;mediaValorInvestido&quot;: 12000.00,&#10;    &quot;mediaValorFinal&quot;: 13500.00&#10;  },&#10;  {&#10;    &quot;produto&quot;: &quot;LCI Banco ABC 95% CDI&quot;,&#10;    &quot;mes&quot;: &quot;2025-11&quot;,&#10;    &quot;quantidadeSimulacoes&quot;: 12,&#10;    &quot;mediaValorInvestido&quot;: 9750.00,&#10;    &quot;mediaValorFinal&quot;: 10687.50&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `produto` | String | Nome do produto agrupado |&#10;| `mes` | YearMonth | Mês/ano das simulações (formato: YYYY-MM) |&#10;| `quantidadeSimulacoes` | Long | Número total de simulações no mês |&#10;| `mediaValorInvestido` | BigDecimal | Valor médio investido no mês |&#10;| `mediaValorFinal` | BigDecimal | Valor médio final projetado no mês |&#10;&#10;**Ordenação:** Por produto (alfabética) → por ano-mês (cronológica crescente)&#10;&#10;---&#10;&#10;### 4. GET /simulacoes/por-produto-ano&#10;**Agrupamento de simulações por produto e ano**&#10;&#10;`http://localhost:9090/simulacoes/por-produto-ano`&#10;&#10;#### Descrição&#10;Retorna um agrupamento das simulações organizadas por produto e ano. Fornece uma visão consolidada anual para análise de tendências de longo prazo e evolução dos produtos ao longo do tempo.&#10;&#10;#### Algoritmo de Agrupamento&#10;1. **Filtragem**: Remove simulações com dados nulos&#10;2. **Agrupamento**: Organiza por produto → Year (ano)&#10;3. **Cálculos estatísticos**: Mesma lógica dos demais agrupamentos&#10;4. **Ordenação**: Produto alfabética → ano cronológico&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` **EXCLUSIVAMENTE**&#10;&#10;#### Request&#10;&#10;**URL:** `GET /simulacoes/por-produto-ano`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Parâmetros:** Nenhum&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;ano&quot;: 2025,&#10;    &quot;quantidadeSimulacoes&quot;: 145,&#10;    &quot;mediaValorInvestido&quot;: 16750.00,&#10;    &quot;mediaValorFinal&quot;: 18843.75&#10;  },&#10;  {&#10;    &quot;produto&quot;: &quot;CDB Banco XYZ 120% CDI&quot;,&#10;    &quot;ano&quot;: 2024,&#10;    &quot;quantidadeSimulacoes&quot;: 89,&#10;    &quot;mediaValorInvestido&quot;: 14200.00,&#10;    &quot;mediaValorFinal&quot;: 15975.00&#10;  },&#10;  {&#10;    &quot;produto&quot;: &quot;LCI Banco ABC 95% CDI&quot;,&#10;    &quot;ano&quot;: 2025,&#10;    &quot;quantidadeSimulacoes&quot;: 78,&#10;    &quot;mediaValorInvestido&quot;: 11850.00,&#10;    &quot;mediaValorFinal&quot;: 13002.75&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `produto` | String | Nome do produto agrupado |&#10;| `ano` | Year | Ano das simulações (formato: YYYY) |&#10;| `quantidadeSimulacoes` | Long | Número total de simulações no ano |&#10;| `mediaValorInvestido` | BigDecimal | Valor médio investido no ano |&#10;| `mediaValorFinal` | BigDecimal | Valor médio final projetado no ano |&#10;&#10;**Ordenação:** Por produto (alfabética) → por ano (cronológica crescente)&#10;&#10;---&#10;&#10;## Status Codes e Erros por Endpoint&#10;&#10;### Todos os Endpoints (Padrão Geral)&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Consulta executada com sucesso |&#10;| **401** | Unauthorized | Token JWT ausente, inválido ou expirado |&#10;| **403** | Forbidden | Role diferente de ADMIN ou token sem permissões |&#10;| **500** | Internal Server Error | Erro interno do sistema ou banco de dados |&#10;&#10;#### Mensagens de Erro Possíveis&#10;&#10;##### ❌ 401 - Unauthorized&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/simulacoes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Token JWT inválido ou expirado&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;, &#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/simulacoes/por-produto-dia&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 403 - Forbidden&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: apenas usuários com role ADMIN podem acessar este recurso&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/simulacoes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Token JWT não encontrado&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/simulacoes/por-produto-mes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;##### ❌ 500 - Internal Server Error&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Falha na conexão com o banco de dados&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/simulacoes/por-produto-ano&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Erro interno do servidor: Falha no processamento dos agrupamentos&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/simulacoes&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Consolidados&#10;&#10;| Status | Nome | Descrição | Todos os Endpoints |&#10;|--------|------|-----------|-------------------|&#10;| **200** | OK | Consulta bem-sucedida | ✅ |&#10;| **401** | Unauthorized | Token ausente/inválido | ✅ |&#10;| **403** | Forbidden | Role não autorizada (não-ADMIN) | ✅ |&#10;| **500** | Internal Server Error | Erro interno/banco | ✅ |&#10;&#10;### Categorias de Mensagens de Erro&#10;&#10;####  Erros de Autenticação (401)&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#10;- `&quot;Token JWT inválido ou expirado&quot;`&#10;- `&quot;Credenciais inválidas&quot;`&#10;&#10;####  Erros de Autorização (403)&#10;- `&quot;Acesso negado: apenas usuários com role ADMIN podem acessar este recurso&quot;`&#10;- `&quot;Token JWT não encontrado&quot;`&#10;- `&quot;Acesso negado: role não autorizada&quot;`&#10;&#10;####  Erros Internos (500)&#10;- `&quot;Erro interno do servidor: Falha na conexão com o banco de dados&quot;`&#10;- `&quot;Erro interno do servidor: Falha no processamento dos agrupamentos&quot;`&#10;- `&quot;Erro interno do servidor: Timeout na consulta ao banco&quot;`&#10;&#10;---&#10;&#10;## Características Técnicas&#10;&#10;### Algoritmos de Agrupamento&#10;&#10;#### Filtragem de Dados&#10;```java&#10;// Remove simulações com dados inconsistentes&#10;simulacoes.stream()&#10;    .filter(s -&gt; s != null &amp;&amp; &#10;                 s.getProduto() != null &amp;&amp; &#10;                 s.getDataSimulacao() != null)&#10;```&#10;&#10;#### Cálculos Estatísticos&#10;```java&#10;// Média com precisão decimal&#10;BigDecimal media = quantidadeSimulacoes &gt; 0 ? &#10;    soma.divide(BigDecimal.valueOf(quantidadeSimulacoes), 2, RoundingMode.HALF_UP) :&#10;    BigDecimal.ZERO;&#10;```&#10;&#10;#### Estratégia de Ordenação&#10;1. **Primeira ordenação**: Nome do produto (alfabética crescente)&#10;2. **Segunda ordenação**: Período temporal (cronológica crescente)&#10;3. **Tie-breaking**: Por ID da simulação quando necessário&#10;&#10;### Performance e Otimização&#10;&#10;#### Consultas ao Banco&#10;- **Estratégia**: Uma única consulta `listAll()` por endpoint&#10;- **Processamento**: Agrupamento em memória via Streams API&#10;- **Complexidade**: O(n log n) devido à ordenação&#10;&#10;#### Uso de Memória&#10;- **Armazenamento temporário**: Mapas hierárquicos para agrupamento&#10;- **Streams**: Processamento lazy quando possível&#10;- **Garbage Collection**: Estruturas temporárias descartadas automaticamente&#10;&#10;#### Recomendações de Performance&#10;1. **Paginação**: Considerar implementar para grandes volumes&#10;2. **Cache**: Implementar cache Redis para consultas frequentes&#10;3. **Índices**: Otimizar índices na tabela simulacao_investimento&#10;4. **Filtragem SQL**: Mover filtros para queries SQL quando possível&#10;&#10;### Dependências do Sistema&#10;&#10;- **SimulacaoInvestimento**: Model/Entity principal&#10;- **Panache ORM**: Framework de persistência&#10;- **JAX-RS**: REST API framework&#10;- **Java Streams API**: Processamento funcional&#10;- **BigDecimal**: Precisão monetária&#10;- **Java Time API**: Manipulação de datas (LocalDate, YearMonth, Year)&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Listar todas simulações:**&#10;```bash&#10;curl -X GET http://localhost:9090/simulacoes \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Agrupamento por produto e dia:**&#10;```bash&#10;curl -X GET http://localhost:9090/simulacoes/por-produto-dia \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot;&#10;```&#10;&#10;**Agrupamento por produto e mês:**&#10;```bash&#10;curl -X GET http://localhost:9090/simulacoes/por-produto-mes \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot;&#10;```&#10;&#10;**Agrupamento por produto e ano:**&#10;```bash&#10;curl -X GET http://localhost:9090/simulacoes/por-produto-ano \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot;&#10;```&#10;&#10;### Respostas Típicas&#10;&#10;**Lista de simulações (vazia):**&#10;```json&#10;[]&#10;```&#10;&#10;**Agrupamento sem dados:**&#10;```json&#10;[]&#10;```&#10;&#10;**Erro de autorização:**&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado: apenas usuários com role ADMIN podem acessar este recurso&quot;,&#10;  &quot;status&quot;: 403&#10;}&#10;```&#10;&#10;&#10;&#10;---&#10;&#10;## Casos de Uso Típicos&#10;&#10;### 1. Dashboard Administrativo&#10;**Cenário**: Visão geral das simulações da plataforma&#10;```&#10;GET /simulacoes → Lista completa&#10;GET /simulacoes/por-produto-mes → Tendências mensais&#10;```&#10;&#10;### 2. Análise de Produtos&#10;**Cenário**: Identificar produtos mais simulados&#10;```&#10;GET /simulacoes/por-produto-dia → Detalhamento diário&#10;GET /simulacoes/por-produto-ano → Comparação anual&#10;```&#10;&#10;### 3. Relatórios Executivos&#10;**Cenário**: KPIs e métricas de negócio&#10;```&#10;GET /simulacoes/por-produto-mes → Volume mensal por produto&#10;GET /simulacoes/por-produto-ano → Crescimento anual&#10;```&#10;&#10;### 4. Auditoria e Compliance&#10;**Cenário**: Rastreabilidade completa&#10;```&#10;GET /simulacoes → Histórico completo para auditoria&#10;```&#10;&#10;---&#10;&#10;## Considerações de Segurança&#10;&#10;### Controle de Acesso Rigoroso&#10;1. **Role exclusiva**: Apenas ADMIN pode acessar&#10;2. **Dados sensíveis**: Informações financeiras de todos os clientes&#10;3. **Auditoria**: Logs de acesso necessários&#10;4. **Monitoramento**: Alertas para acessos suspeitos&#10;&#10;### Proteção de Dados&#10;1. **LGPD/GDPR**: Dados pessoais de investimento&#10;2. **Anonimização**: Considerar remover clienteId em alguns cenários&#10;3. **Retenção**: Políticas de armazenamento de longo prazo&#10;4. **Backup**: Estratégias de backup e recovery&#10;&#10;### Recomendações de Segurança&#10;1. **Rate Limiting**: Limitar consultas por administrador&#10;2. **Logs de Auditoria**: Registrar todos os acessos&#10;3. **Filtros por Período**: Evitar consultas de grandes volumes&#10;4. **IP Whitelist**: Restringir acesso por localização&#10;5. **Two-Factor Auth**: Autenticação dupla para ADMINs&#10;&#10;---&#10;&#10;## Análise de Dados e Insights&#10;&#10;### Métricas Disponíveis&#10;&#10;#### Por Simulação Individual&#10;- Valor investido e projeção final&#10;- Prazo de investimento (dias/meses/anos)&#10;- Produto escolhido&#10;- Cliente realizador&#10;- Timestamp da simulação&#10;&#10;#### Por Agrupamento (Dia/Mês/Ano)&#10;- Quantidade total de simulações&#10;- Valor médio investido&#10;- Valor médio final projetado&#10;- Distribuição por produto&#10;- Tendências temporais" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/docs/DOCUMENTACAO_TELEMETRIA.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/docs/DOCUMENTACAO_TELEMETRIA.md" />
              <option name="originalContent" value="# Documentação da API - TelemetriaResource&#10;&#10;## Visão Geral&#10;&#10;O `TelemetriaResource` é responsável por fornecer métricas e dados de monitoramento da API de Investimentos Caixa. Oferece endpoints para visualizar estatísticas de uso, performance dos serviços e gerenciar dados de telemetria. Todos os endpoints são restritos a administradores.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/telemetria`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;**Autenticação global:**&#10;- **Token JWT:** OBRIGATÓRIO para todos os endpoints&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. GET /telemetria&#10;**Obtém telemetria resumida do sistema**&#10;&#10;#### Descrição&#10;Retorna um resumo consolidado das métricas de uso da API, incluindo quantidade de chamadas e tempo médio de resposta por endpoint, além do período de coleta dos dados.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /telemetria`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Sem body**&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Telemetria obtida com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;servicos&quot;: [&#10;    {&#10;      &quot;nome&quot;: &quot;GET /clientes&quot;,&#10;      &quot;contador_execucao&quot;: 150,&#10;      &quot;tempo_medio_resposta&quot;: 125.5&#10;    },&#10;    {&#10;      &quot;nome&quot;: &quot;POST /clientes&quot;, &#10;      &quot;contador_execucao&quot;: 45,&#10;      &quot;tempo_medio_resposta&quot;: 89.2&#10;    }&#10;  ],&#10;  &quot;periodo&quot;: {&#10;    &quot;inicio&quot;: &quot;2025-11-01 08:00:00&quot;,&#10;    &quot;fim&quot;: &quot;2025-11-15 17:30:00&quot;&#10;  }&#10;}&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `servicos` | array | Lista de serviços com suas métricas |&#10;| `servicos[].nome` | string | Nome do endpoint |&#10;| `servicos[].contador_execucao` | long | Número total de chamadas |&#10;| `servicos[].tempo_medio_resposta` | double | Tempo médio de resposta em milissegundos |&#10;| `periodo` | object | Período de coleta dos dados (pode ser null) |&#10;| `periodo.inicio` | string | Data/hora de início da coleta |&#10;| `periodo.fim` | string | Data/hora do fim da coleta |&#10;&#10;---&#10;&#10;### 2. GET /telemetria/detalhado&#10;**Obtém telemetria detalhada do sistema**&#10;&#10;#### Descrição&#10;Retorna todas as métricas detalhadas do banco de dados, incluindo informações completas de cada endpoint monitorado com dados de criação e atualização.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /telemetria/detalhado`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Sem body**&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Telemetria detalhada obtida com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 1,&#10;    &quot;endpoint&quot;: &quot;GET /clientes&quot;,&#10;    &quot;contadorExecucoes&quot;: 150,&#10;    &quot;tempoMedioResposta&quot;: 125.5,&#10;    &quot;tempoTotalExecucao&quot;: 18825.0,&#10;    &quot;dataCriacao&quot;: &quot;2025-11-01T08:00:00&quot;,&#10;    &quot;ultimaAtualizacao&quot;: &quot;2025-11-15T17:30:00&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 2,&#10;    &quot;endpoint&quot;: &quot;POST /clientes&quot;,&#10;    &quot;contadorExecucoes&quot;: 45,&#10;    &quot;tempoMedioResposta&quot;: 89.2,&#10;    &quot;tempoTotalExecucao&quot;: 4014.0,&#10;    &quot;dataCriacao&quot;: &quot;2025-11-01T09:15:00&quot;, &#10;    &quot;ultimaAtualizacao&quot;: &quot;2025-11-15T16:45:00&quot;&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `id` | Long | ID único da métrica |&#10;| `endpoint` | string | Nome do endpoint monitorado |&#10;| `contadorExecucoes` | Long | Número total de execuções |&#10;| `tempoMedioResposta` | Double | Tempo médio de resposta (ms) |&#10;| `tempoTotalExecucao` | Double | Tempo total acumulado (ms) |&#10;| `dataCriacao` | datetime | Data de criação da métrica |&#10;| `ultimaAtualizacao` | datetime | Última atualização da métrica |&#10;&#10;---&#10;&#10;### 3. GET /telemetria/mais-acessados/{limite}&#10;**Obtém endpoints mais acessados**&#10;&#10;#### Descrição&#10;Retorna uma lista dos endpoints mais acessados, ordenados por quantidade de chamadas em ordem decrescente, limitada pelo parâmetro especificado.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /telemetria/mais-acessados/{limite}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `limite` | int | Sim | Número inteiro positivo | Quantidade máxima de registros a retornar |&#10;&#10;**Exemplo:** `GET /telemetria/mais-acessados/5`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Endpoints mais acessados obtidos com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 3,&#10;    &quot;endpoint&quot;: &quot;GET /produtos&quot;,&#10;    &quot;contadorExecucoes&quot;: 250,&#10;    &quot;tempoMedioResposta&quot;: 95.8,&#10;    &quot;tempoTotalExecucao&quot;: 23950.0,&#10;    &quot;dataCriacao&quot;: &quot;2025-11-01T08:30:00&quot;,&#10;    &quot;ultimaAtualizacao&quot;: &quot;2025-11-15T17:00:00&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 1,&#10;    &quot;endpoint&quot;: &quot;GET /clientes&quot;,&#10;    &quot;contadorExecucoes&quot;: 150,&#10;    &quot;tempoMedioResposta&quot;: 125.5,&#10;    &quot;tempoTotalExecucao&quot;: 18825.0,&#10;    &quot;dataCriacao&quot;: &quot;2025-11-01T08:00:00&quot;,&#10;    &quot;ultimaAtualizacao&quot;: &quot;2025-11-15T17:30:00&quot;&#10;  }&#10;]&#10;```&#10;&#10;---&#10;&#10;### 4. DELETE /telemetria/limpar&#10;**Limpa todas as métricas de telemetria**&#10;&#10;#### Descrição&#10;Remove todas as métricas de telemetria do sistema, resetando os contadores e dados históricos. Operação irreversível.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `DELETE /telemetria/limpar`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Sem body**&#10;&#10;#### Responses&#10;&#10;##### ✅ 204 - Métricas limpas com sucesso&#10;&#10;**Sem body na response**&#10;&#10;---&#10;&#10;## Status Codes e Erros por Endpoint&#10;&#10;### GET /telemetria&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Telemetria obtida com sucesso |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Usuário não é ADMIN |&#10;| **500** | Internal Server Error | Erro no serviço/banco |&#10;&#10;#### Mensagens de Erro Possíveis&#10;```json&#10;// 401 - Token ausente/inválido&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/telemetria&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 403 - Não é ADMIN&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/telemetria&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 500 - Erro interno&#10;{&#10;  &quot;message&quot;: &quot;Erro ao obter telemetria: Connection timeout to database&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/telemetria&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /telemetria/detalhado&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Telemetria detalhada obtida |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Usuário não é ADMIN |&#10;| **500** | Internal Server Error | Erro no banco/repository |&#10;&#10;#### Mensagens de Erro Possíveis&#10;```json&#10;// 401 - Token ausente/inválido&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/telemetria/detalhado&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 403 - Não é ADMIN&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/telemetria/detalhado&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 500 - Erro no banco&#10;{&#10;  &quot;message&quot;: &quot;Erro ao obter telemetria detalhada: Database connection failed&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/telemetria/detalhado&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /telemetria/mais-acessados/{limite}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Lista de mais acessados obtida |&#10;| **400** | Bad Request | Parâmetro limite inválido |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Usuário não é ADMIN |&#10;| **500** | Internal Server Error | Erro na consulta |&#10;&#10;#### Mensagens de Erro Possíveis&#10;```json&#10;// 400 - Parâmetro inválido&#10;{&#10;  &quot;message&quot;: &quot;Dados da requisição inválidos: formato JSON incorreto&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/telemetria/mais-acessados/abc&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 401 - Token ausente/inválido&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/telemetria/mais-acessados/5&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 403 - Não é ADMIN&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/telemetria/mais-acessados/5&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 500 - Erro na query&#10;{&#10;  &quot;message&quot;: &quot;Erro ao obter endpoints mais acessados: Query execution failed&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/telemetria/mais-acessados/5&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### DELETE /telemetria/limpar&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **204** | No Content | Métricas limpas com sucesso |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Usuário não é ADMIN |&#10;| **500** | Internal Server Error | Erro na operação de limpeza |&#10;&#10;#### Mensagens de Erro Possíveis&#10;```json&#10;// 401 - Token ausente/inválido&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/telemetria/limpar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 403 - Não é ADMIN&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/telemetria/limpar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 500 - Erro na operação&#10;{&#10;  &quot;message&quot;: &quot;Erro ao limpar métricas: Transaction rollback failed&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/telemetria/limpar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Consolidados&#10;&#10;| Status | Nome | Ocorrência | Endpoints Afetados |&#10;|--------|------|------------|-------------------|&#10;| **200** | OK | Sucesso | GET /telemetria, GET /telemetria/detalhado, GET /telemetria/mais-acessados/{limite} |&#10;| **204** | No Content | Operação concluída sem conteúdo | DELETE /telemetria/limpar |&#10;| **400** | Bad Request | Parâmetros inválidos | GET /telemetria/mais-acessados/{limite} |&#10;| **401** | Unauthorized | Token ausente/inválido | Todos os endpoints |&#10;| **403** | Forbidden | Usuário não é ADMIN | Todos os endpoints |&#10;| **500** | Internal Server Error | Erros internos | Todos os endpoints |&#10;&#10;### Categorias de Mensagens de Erro&#10;&#10;####  Erros de Autenticação (401)&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#10;&#10;####  Erros de Autorização (403)&#10;- `&quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;`&#10;&#10;####  Erros de Validação (400)&#10;- `&quot;Dados da requisição inválidos: formato JSON incorreto&quot;` (parâmetro limite inválido)&#10;&#10;####  Erros Internos (500)&#10;- `&quot;Erro ao obter telemetria: {detalhes do erro}&quot;`&#10;- `&quot;Erro ao obter telemetria detalhada: {detalhes do erro}&quot;`&#10;- `&quot;Erro ao obter endpoints mais acessados: {detalhes do erro}&quot;`&#10;- `&quot;Erro ao limpar métricas: {detalhes do erro}&quot;`&#10;&#10;### Estrutura Padrão de Erros&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Mensagem descritiva do erro&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/telemetria/endpoint&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Informações Técnicas&#10;&#10;### Coleta de Métricas&#10;&#10;O sistema coleta automaticamente:&#10;- **Contador de execuções**: Número total de chamadas por endpoint&#10;- **Tempo de resposta**: Tempo médio e total de execução&#10;- **Timestamps**: Data de criação e última atualização&#10;- **Performance**: Métricas de performance em tempo real&#10;&#10;### Autorização&#10;&#10;Todos os endpoints requerem:&#10;- Token JWT válido no header `Authorization: Bearer {token}`&#10;- Role `ADMIN` no token&#10;- Token não expirado&#10;&#10;### Dados Persistidos&#10;&#10;As métricas são armazenadas na tabela `telemetria_metrica`:&#10;- `endpoint`: Nome do endpoint monitorado&#10;- `contador_execucoes`: Total de chamadas&#10;- `tempo_medio_resposta`: Tempo médio (ms)&#10;- `tempo_total_execucao`: Tempo total acumulado (ms)&#10;- `data_criacao`: Timestamp de criação&#10;- `ultima_atualizacao`: Timestamp da última atualização&#10;&#10;### Operação de Limpeza&#10;&#10;O endpoint DELETE `/telemetria/limpar`:&#10;- Remove **todos** os dados de telemetria&#10;- Operação **irreversível**&#10;- Reseta contadores para zero&#10;- Remove histórico de performance&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Obter telemetria resumida:**&#10;```bash&#10;curl -X GET http://localhost:9090/telemetria \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Obter telemetria detalhada:**&#10;```bash&#10;curl -X GET http://localhost:9090/telemetria/detalhado \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Obter top 10 mais acessados:**&#10;```bash&#10;curl -X GET http://localhost:9090/telemetria/mais-acessados/10 \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Limpar métricas:**&#10;```bash&#10;curl -X DELETE http://localhost:9090/telemetria/limpar \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;&#10;&#10;---" />
              <option name="updatedContent" value="# Documentação da API - TelemetriaResource&#10;&#10;## Visão Geral&#10;&#10;O `TelemetriaResource` é responsável por fornecer métricas e dados de monitoramento da API de Investimentos Caixa. Oferece endpoints para visualizar estatísticas de uso, performance dos serviços e gerenciar dados de telemetria. Todos os endpoints são restritos a administradores.&#10;&#10;**Servidor:** `http://localhost:9090`&#10;&#10;**Base Path:** `/telemetria`&#10;&#10;**Formatos suportados:**&#10;- Content-Type: `application/json`&#10;- Accept: `application/json`&#10;&#10;**Autenticação global:**&#10;- **Token JWT:** OBRIGATÓRIO para todos os endpoints&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;---&#10;&#10;## Endpoints&#10;&#10;### 1. GET /telemetria&#10;**Obtém telemetria resumida do sistema**&#10;&#10;`http://localhost:9090/telemetria`&#10;&#10;#### Descrição&#10;Retorna um resumo consolidado das métricas de uso da API, incluindo quantidade de chamadas e tempo médio de resposta por endpoint, além do período de coleta dos dados.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /telemetria`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Sem body**&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Telemetria obtida com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;{&#10;  &quot;servicos&quot;: [&#10;    {&#10;      &quot;nome&quot;: &quot;GET /clientes&quot;,&#10;      &quot;contador_execucao&quot;: 150,&#10;      &quot;tempo_medio_resposta&quot;: 125.5&#10;    },&#10;    {&#10;      &quot;nome&quot;: &quot;POST /clientes&quot;, &#10;      &quot;contador_execucao&quot;: 45,&#10;      &quot;tempo_medio_resposta&quot;: 89.2&#10;    }&#10;  ],&#10;  &quot;periodo&quot;: {&#10;    &quot;inicio&quot;: &quot;2025-11-01 08:00:00&quot;,&#10;    &quot;fim&quot;: &quot;2025-11-15 17:30:00&quot;&#10;  }&#10;}&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `servicos` | array | Lista de serviços com suas métricas |&#10;| `servicos[].nome` | string | Nome do endpoint |&#10;| `servicos[].contador_execucao` | long | Número total de chamadas |&#10;| `servicos[].tempo_medio_resposta` | double | Tempo médio de resposta em milissegundos |&#10;| `periodo` | object | Período de coleta dos dados (pode ser null) |&#10;| `periodo.inicio` | string | Data/hora de início da coleta |&#10;| `periodo.fim` | string | Data/hora do fim da coleta |&#10;&#10;---&#10;&#10;### 2. GET /telemetria/detalhado&#10;**Obtém telemetria detalhada do sistema**&#10;&#10;`http://localhost:9090/telemetria/detalhado`&#10;&#10;#### Descrição&#10;Retorna todas as métricas detalhadas do banco de dados, incluindo informações completas de cada endpoint monitorado com dados de criação e atualização.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /telemetria/detalhado`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Sem body**&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Telemetria detalhada obtida com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 1,&#10;    &quot;endpoint&quot;: &quot;GET /clientes&quot;,&#10;    &quot;contadorExecucoes&quot;: 150,&#10;    &quot;tempoMedioResposta&quot;: 125.5,&#10;    &quot;tempoTotalExecucao&quot;: 18825.0,&#10;    &quot;dataCriacao&quot;: &quot;2025-11-01T08:00:00&quot;,&#10;    &quot;ultimaAtualizacao&quot;: &quot;2025-11-15T17:30:00&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 2,&#10;    &quot;endpoint&quot;: &quot;POST /clientes&quot;,&#10;    &quot;contadorExecucoes&quot;: 45,&#10;    &quot;tempoMedioResposta&quot;: 89.2,&#10;    &quot;tempoTotalExecucao&quot;: 4014.0,&#10;    &quot;dataCriacao&quot;: &quot;2025-11-01T09:15:00&quot;, &#10;    &quot;ultimaAtualizacao&quot;: &quot;2025-11-15T16:45:00&quot;&#10;  }&#10;]&#10;```&#10;&#10;**Campos da Response:**&#10;&#10;| Campo | Tipo | Descrição |&#10;|-------|------|-----------|&#10;| `id` | Long | ID único da métrica |&#10;| `endpoint` | string | Nome do endpoint monitorado |&#10;| `contadorExecucoes` | Long | Número total de execuções |&#10;| `tempoMedioResposta` | Double | Tempo médio de resposta (ms) |&#10;| `tempoTotalExecucao` | Double | Tempo total acumulado (ms) |&#10;| `dataCriacao` | datetime | Data de criação da métrica |&#10;| `ultimaAtualizacao` | datetime | Última atualização da métrica |&#10;&#10;---&#10;&#10;### 3. GET /telemetria/mais-acessados/{limite}&#10;**Obtém endpoints mais acessados**&#10;&#10;`http://localhost:9090/telemetria/mais-acessados/{limite}`&#10;&#10;#### Descrição&#10;Retorna uma lista dos endpoints mais acessados, ordenados por quantidade de chamadas em ordem decrescente, limitada pelo parâmetro especificado.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `GET /telemetria/mais-acessados/{limite}`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Path Parameters:**&#10;&#10;| Parâmetro | Tipo | Obrigatório | Validação | Descrição |&#10;|-----------|------|-------------|-----------|-----------|&#10;| `limite` | int | Sim | Número inteiro positivo | Quantidade máxima de registros a retornar |&#10;&#10;**Exemplo:** `GET /telemetria/mais-acessados/5`&#10;&#10;#### Responses&#10;&#10;##### ✅ 200 - Endpoints mais acessados obtidos com sucesso&#10;&#10;**Response Body:**&#10;```json&#10;[&#10;  {&#10;    &quot;id&quot;: 3,&#10;    &quot;endpoint&quot;: &quot;GET /produtos&quot;,&#10;    &quot;contadorExecucoes&quot;: 250,&#10;    &quot;tempoMedioResposta&quot;: 95.8,&#10;    &quot;tempoTotalExecucao&quot;: 23950.0,&#10;    &quot;dataCriacao&quot;: &quot;2025-11-01T08:30:00&quot;,&#10;    &quot;ultimaAtualizacao&quot;: &quot;2025-11-15T17:00:00&quot;&#10;  },&#10;  {&#10;    &quot;id&quot;: 1,&#10;    &quot;endpoint&quot;: &quot;GET /clientes&quot;,&#10;    &quot;contadorExecucoes&quot;: 150,&#10;    &quot;tempoMedioResposta&quot;: 125.5,&#10;    &quot;tempoTotalExecucao&quot;: 18825.0,&#10;    &quot;dataCriacao&quot;: &quot;2025-11-01T08:00:00&quot;,&#10;    &quot;ultimaAtualizacao&quot;: &quot;2025-11-15T17:30:00&quot;&#10;  }&#10;]&#10;```&#10;&#10;---&#10;&#10;### 4. DELETE /telemetria/limpar&#10;**Limpa todas as métricas de telemetria**&#10;&#10;`http://localhost:9090/telemetria/limpar`&#10;&#10;#### Descrição&#10;Remove todas as métricas de telemetria do sistema, resetando os contadores e dados históricos. Operação irreversível.&#10;&#10;#### Autenticação&#10;- **Token JWT:** OBRIGATÓRIO&#10;- **Roles permitidas:** `ADMIN` apenas&#10;&#10;#### Request&#10;&#10;**URL:** `DELETE /telemetria/limpar`&#10;&#10;**Headers obrigatórios:**&#10;```&#10;Authorization: Bearer {jwt_token}&#10;Content-Type: application/json&#10;```&#10;&#10;**Sem body**&#10;&#10;#### Responses&#10;&#10;##### ✅ 204 - Métricas limpas com sucesso&#10;&#10;**Sem body na response**&#10;&#10;---&#10;&#10;## Status Codes e Erros por Endpoint&#10;&#10;### GET /telemetria&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Telemetria obtida com sucesso |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Usuário não é ADMIN |&#10;| **500** | Internal Server Error | Erro no serviço/banco |&#10;&#10;#### Mensagens de Erro Possíveis&#10;```json&#10;// 401 - Token ausente/inválido&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/telemetria&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 403 - Não é ADMIN&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/telemetria&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 500 - Erro interno&#10;{&#10;  &quot;message&quot;: &quot;Erro ao obter telemetria: Connection timeout to database&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/telemetria&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /telemetria/detalhado&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Telemetria detalhada obtida |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Usuário não é ADMIN |&#10;| **500** | Internal Server Error | Erro no banco/repository |&#10;&#10;#### Mensagens de Erro Possíveis&#10;```json&#10;// 401 - Token ausente/inválido&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/telemetria/detalhado&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 403 - Não é ADMIN&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/telemetria/detalhado&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 500 - Erro no banco&#10;{&#10;  &quot;message&quot;: &quot;Erro ao obter telemetria detalhada: Database connection failed&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/telemetria/detalhado&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### GET /telemetria/mais-acessados/{limite}&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **200** | OK | Lista de mais acessados obtida |&#10;| **400** | Bad Request | Parâmetro limite inválido |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Usuário não é ADMIN |&#10;| **500** | Internal Server Error | Erro na consulta |&#10;&#10;#### Mensagens de Erro Possíveis&#10;```json&#10;// 400 - Parâmetro inválido&#10;{&#10;  &quot;message&quot;: &quot;Dados da requisição inválidos: formato JSON incorreto&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 400,&#10;  &quot;path&quot;: &quot;/telemetria/mais-acessados/abc&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 401 - Token ausente/inválido&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/telemetria/mais-acessados/5&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 403 - Não é ADMIN&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/telemetria/mais-acessados/5&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 500 - Erro na query&#10;{&#10;  &quot;message&quot;: &quot;Erro ao obter endpoints mais acessados: Query execution failed&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/telemetria/mais-acessados/5&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;### DELETE /telemetria/limpar&#10;&#10;#### Status Codes Possíveis&#10;| Status | Descrição | Quando Ocorre |&#10;|--------|-----------|---------------|&#10;| **204** | No Content | Métricas limpas com sucesso |&#10;| **401** | Unauthorized | Token ausente/inválido |&#10;| **403** | Forbidden | Usuário não é ADMIN |&#10;| **500** | Internal Server Error | Erro na operação de limpeza |&#10;&#10;#### Mensagens de Erro Possíveis&#10;```json&#10;// 401 - Token ausente/inválido&#10;{&#10;  &quot;message&quot;: &quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 401,&#10;  &quot;path&quot;: &quot;/telemetria/limpar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 403 - Não é ADMIN&#10;{&#10;  &quot;message&quot;: &quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 403,&#10;  &quot;path&quot;: &quot;/telemetria/limpar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;&#10;// 500 - Erro na operação&#10;{&#10;  &quot;message&quot;: &quot;Erro ao limpar métricas: Transaction rollback failed&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/telemetria/limpar&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Referência Completa de Status Codes e Mensagens de Erro&#10;&#10;### Status Codes Consolidados&#10;&#10;| Status | Nome | Ocorrência | Endpoints Afetados |&#10;|--------|------|------------|-------------------|&#10;| **200** | OK | Sucesso | GET /telemetria, GET /telemetria/detalhado, GET /telemetria/mais-acessados/{limite} |&#10;| **204** | No Content | Operação concluída sem conteúdo | DELETE /telemetria/limpar |&#10;| **400** | Bad Request | Parâmetros inválidos | GET /telemetria/mais-acessados/{limite} |&#10;| **401** | Unauthorized | Token ausente/inválido | Todos os endpoints |&#10;| **403** | Forbidden | Usuário não é ADMIN | Todos os endpoints |&#10;| **500** | Internal Server Error | Erros internos | Todos os endpoints |&#10;&#10;### Categorias de Mensagens de Erro&#10;&#10;####  Erros de Autenticação (401)&#10;- `&quot;Acesso não autorizado. É necessário fazer login para acessar este recurso.&quot;`&#10;&#10;####  Erros de Autorização (403)&#10;- `&quot;Acesso negado. Você não possui permissão para acessar este recurso.&quot;`&#10;&#10;####  Erros de Validação (400)&#10;- `&quot;Dados da requisição inválidos: formato JSON incorreto&quot;` (parâmetro limite inválido)&#10;&#10;####  Erros Internos (500)&#10;- `&quot;Erro ao obter telemetria: {detalhes do erro}&quot;`&#10;- `&quot;Erro ao obter telemetria detalhada: {detalhes do erro}&quot;`&#10;- `&quot;Erro ao obter endpoints mais acessados: {detalhes do erro}&quot;`&#10;- `&quot;Erro ao limpar métricas: {detalhes do erro}&quot;`&#10;&#10;### Estrutura Padrão de Erros&#10;&#10;```json&#10;{&#10;  &quot;message&quot;: &quot;Mensagem descritiva do erro&quot;,&#10;  &quot;timestamp&quot;: &quot;2025-11-15T14:30:00&quot;,&#10;  &quot;status&quot;: 500,&#10;  &quot;path&quot;: &quot;/telemetria/endpoint&quot;,&#10;  &quot;errors&quot;: null&#10;}&#10;```&#10;&#10;---&#10;&#10;## Informações Técnicas&#10;&#10;### Coleta de Métricas&#10;&#10;O sistema coleta automaticamente:&#10;- **Contador de execuções**: Número total de chamadas por endpoint&#10;- **Tempo de resposta**: Tempo médio e total de execução&#10;- **Timestamps**: Data de criação e última atualização&#10;- **Performance**: Métricas de performance em tempo real&#10;&#10;### Autorização&#10;&#10;Todos os endpoints requerem:&#10;- Token JWT válido no header `Authorization: Bearer {token}`&#10;- Role `ADMIN` no token&#10;- Token não expirado&#10;&#10;### Dados Persistidos&#10;&#10;As métricas são armazenadas na tabela `telemetria_metrica`:&#10;- `endpoint`: Nome do endpoint monitorado&#10;- `contador_execucoes`: Total de chamadas&#10;- `tempo_medio_resposta`: Tempo médio (ms)&#10;- `tempo_total_execucao`: Tempo total acumulado (ms)&#10;- `data_criacao`: Timestamp de criação&#10;- `ultima_atualizacao`: Timestamp da última atualização&#10;&#10;### Operação de Limpeza&#10;&#10;O endpoint DELETE `/telemetria/limpar`:&#10;- Remove **todos** os dados de telemetria&#10;- Operação **irreversível**&#10;- Reseta contadores para zero&#10;- Remove histórico de performance&#10;&#10;---&#10;&#10;## Exemplos de Uso&#10;&#10;### cURL&#10;&#10;**Obter telemetria resumida:**&#10;```bash&#10;curl -X GET http://localhost:9090/telemetria \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Obter telemetria detalhada:**&#10;```bash&#10;curl -X GET http://localhost:9090/telemetria/detalhado \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Obter top 10 mais acessados:**&#10;```bash&#10;curl -X GET http://localhost:9090/telemetria/mais-acessados/10 \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;**Limpar métricas:**&#10;```bash&#10;curl -X DELETE http://localhost:9090/telemetria/limpar \&#10;  -H &quot;Authorization: Bearer {admin_token}&quot; \&#10;  -H &quot;Content-Type: application/json&quot;&#10;```&#10;&#10;&#10;&#10;---" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>